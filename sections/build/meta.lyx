#LyX file created by tex2lyx 2.0.4
\lyxformat 413
\begin_document
\begin_header
\textclass book
\use_default_options false
\language english
\language_package default
\inputencoding auto
\fontencoding T1
\font_roman charter
\font_sans helvet
\font_typewriter courier
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\paperfontsize default
\spacing single
\use_hyperref 1
\pdf_bookmarks 1
\pdf_bookmarksnumbered 0
\pdf_bookmarksopen 0
\pdf_bookmarksopenlevel 1
\pdf_breaklinks 1
\pdf_pdfborder 0
\pdf_colorlinks 1
\pdf_backref section
\pdf_pdfusetitle 1
\pdf_quoted_options "pdftex,setpagesize=true,pdfhighlight=/P,linktocpage=true,plainpages=false,linkcolor=blue,%
anchorcolor=yellow,%
citecolor=green,%
menucolor=cyan,%
pagecolor=red,%
urlcolor=magenta"
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 0
\use_mathdots 0
\cite_engine natbib_authoryear
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle fancyplain
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

% Meta-alignment of Biological Sequences
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Chapter


\begin_inset Argument
status collapsed


\begin_layout Standard

Regresión Lineal
\end_layout

\end_inset


\series bold
R
\series default
egresión Lineal
\end_layout

\begin_layout Standard


\begin_inset CommandInset label
LatexCommand label
name "sec:meta"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen*
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Resumen
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\align center


\begin_inset Tabular 
<lyxtabular version="3" rows="3" columns="1">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{blue}{verylightgrey}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][4cm][c]{0.8
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
sffamily
\end_layout

\begin_layout Standard

%abstract
\end_layout

\begin_layout Standard

This chapter contains the description of an efficient algorithm to align higher
\end_layout

\begin_layout Standard

order elements mapped over biological sequences. The relationship between
\end_layout

\begin_layout Standard

sequence alignments and meta-alignment is also reviewed. Such an approach
\end_layout

\begin_layout Standard

is trained on a set of well annotated promoters. The ability of the meta-alignment
\end_layout

\begin_layout Standard

to identify functional elements conserved at high level, such as regulatory elements
\end_layout

\begin_layout Standard

in co-regulated genes, in absence of sequence conservation is shown in several situations.
\end_layout

\begin_layout Standard

In addition, the meta-alignment is used to evaluate the specificity of the weight matrices
\end_layout

\begin_layout Standard

in a genome wide approach.
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

[2ex] 
\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "110line%"
special "none"
height "4cm"
height_special "none"
status open


\begin_layout Plain Layout

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
minitoc
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Biological maps: promoters
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
lettrine
\end_layout

\end_inset

[lines=4,loversize=-0.1,lraise=0.1,lhang=.2]
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

S
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

equence comparisons 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence!seqcmp@sequence comparison
\end_layout

\end_inset

 are among the most useful computational techniques
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 in molecular biology. Sequences of characters in the four-letter nucleotide alphabet and in the twenty-letter amino acid alphabet are extremely good symbolic representations of the underlying DNA and protein molecules, and encode substantial information on their structure, function and history.
\end_layout

\begin_layout Standard

Primary sequence comparisons, however, have limitations. Although similar sequences do tend to play similar functions, the opposite is not necessarily true. Often similar functions are encoded in higher order sequence elements --such, for instance, structural motifs in amino acid sequences-- and the relation between these and the underlying primary sequence may not be univocal. As a result, similar functions are frequently encoded by diverse sequences.
\end_layout

\begin_layout Standard

As reviewed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

, a biological map 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

maps
\end_layout

\end_inset

 is a description of functional objects (e.g. genes or regulatory sites) that are identified in a sequence at a given position. The annotation of the human genome in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hgenome"

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

genome!humgen@human genome
\end_layout

\end_inset

 is a clear example of genomic mapping 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

genomic mapping
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "venter:2001a"

\end_inset

. Comparison operations between maps are then necessary to elucidate functional relationships that are undetectable at the sequence level.
\end_layout

\begin_layout Standard

Promoter regions controlling eukaryotic gene expression are a case in point. As reviewed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

, the information for the control of the initiation of the gene transcription is mostly contained in the gene promoter, a region upstream of the gene transcription start site (TSS). Transcription factors (TFs) interact in these regions with sequence specific elements or motifs (the TF binding sites, TFBSs). TFBSs are typically 5-15 nucleotides long and one promoter region usually contains many of them to harbor different TFs 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "wray:2003a"

\end_inset

. The interplay between these factors is not well understood, but the motifs appear to be arranged in specific configurations that confer on each gene an individualized spatial and temporal transcription program 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "wray:2003a"

\end_inset

. It is assumed, in consequence, that genes exhibiting similar expression patterns would also share similar configurations of TFs in their promoter.
\end_layout

\begin_layout Standard

However, TFBSs associated to the same TF are known to tolerate sequence substitutions without losing functionality, and are often not conserved. Consequently, promoter regions of genes with similar expression patterns may not show sequence similarity, even though they may be regulated by similar configurations of TFs. For instance, only about 30 to 40% of the promoter regions are conserved between human and chicken orthologous genes 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "hillier:2004a"

\end_inset

, and the conservation of human-mouse orthologous promoter regions is only slightly higher than that observed in intergenic regions 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterston:2002a"

\end_inset

. Indeed, despite the recent progress due to the development of techniques based in the so-called phylogenetic footprinting, lack of nucleotide sequence conservation between functionally related promoter regions may partially explain the still limited success of current available computational methods for promoter characterization (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

 for a review of these methods).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 1: the human genome is a map
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.9
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/hgenome
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:hgenome
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The human genome map
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The human genome map.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

This poster was produced with the program 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
prog{
\end_layout

\end_inset

gff2ps
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "abril:2000a"

\end_inset

. Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "venter:2001a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In the approach described in this chapter 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

, we attempt to overcome this limitation by abstracting the nucleotide sequence, and representing a promoter region by a sequence in a new alphabet in which the different symbols denote different TFs. Using an external mapping function (for instance, a look-up table or a collection of position weight matrices, PWMs) that associates each TF to the nucleotide sequence motifs the factor is known to bind, we can translate the nucleotide sequence of the promoter into a sequence in this new alphabet. These sequences can be aligned. If the scoring of the alignment takes into account not only the presence/absence of a given symbol, but its relative position on the primary nucleotide sequence, the optimal alignment between the promoter regions of two genes with similar expression patterns may reflect the underlying common configuration of TFBSs. We refer to these alignments either as meta-alignments, 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

meta-alignments
\end_layout

\end_inset

 as they are performed between sequences in a meta-alphabet, or map alignments, since they are obtained after mapping the nucleotide sequence in a higher order alphabet.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Transcription Factor maps
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:tfmaps"

\end_inset


\end_layout

\begin_layout Standard

Analogously to the restriction enzyme maps initially formalized by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 that are described in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

, we translate in our approach 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

 the nucleotide sequence of a promoter region 
\begin_inset Formula $S = s_1 s_2 \ldots s_k$
\end_inset

 into a sequence of 4-tuples 
\begin_inset Formula $A = a_1 \ldots a_n$
\end_inset

 where each 
\begin_inset Formula $a_i = <a_i^f,a_i^{p_1},a_i^{p_2},a_i^s>$
\end_inset

 denotes the match with score 
\begin_inset Formula $a_i^s$
\end_inset

 of a binding site for the TF 
\begin_inset Formula $a_i^f$
\end_inset

 occurring between the position 
\begin_inset Formula $a_i^{p_1}$
\end_inset

 and the position 
\begin_inset Formula $a_i^{p_2}$
\end_inset

 over the sequence 
\begin_inset Formula $S$
\end_inset

.
\end_layout

\begin_layout Standard

We obtain the translation from 
\begin_inset Formula $S$
\end_inset

 to 
\begin_inset Formula $A$
\end_inset

 by running on 
\begin_inset Formula $S$
\end_inset

 a collection of PWMs representing binding motifs for TFs (such as, for instance, the collection in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "matys:2003a"

\end_inset

). For each match over a given threshold, we register in 
\begin_inset Formula $A$
\end_inset

 the positions (
\begin_inset Formula $a_i^{p_1},a_i^{p_2}$
\end_inset

), the score (
\begin_inset Formula $a_i^s$
\end_inset

), and the label (
\begin_inset Formula $a_i^f$
\end_inset

) of the TF associated to the PWM. The translation preserves the order of 
\begin_inset Formula $S$
\end_inset

 in 
\begin_inset Formula $A$
\end_inset

, that is if 
\begin_inset Formula $i < j$
\end_inset

 in 
\begin_inset Formula $A$
\end_inset

 then 
\begin_inset Formula $a_i^{p_1} \leq a_j^{p_1}$
\end_inset

 (the 
\begin_inset Formula $\leq$
\end_inset

 is because matches to different TFs may occur at the same position). We will refer to the resulting sequence 
\begin_inset Formula $A$
\end_inset

 as a Transcription Factor Map (TF-map) 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

maps!tf@TF-maps
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-maps
\end_layout

\end_inset

 or simply a map (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dummy"

\end_inset

). Note that other mapping functions, instead of collections of PWMs, can also be used to translate 
\begin_inset Formula $S$
\end_inset

 into 
\begin_inset Formula $A$
\end_inset

.
\end_layout

\begin_layout Standard

In the implementation here, matches to PWMs are considered strandless, that is, they are annotated at a given location, irrespective of the orientation in which they occur. While biological evidence suggests that some TFBSs are functional only when present in a given strand, in other cases TF activity appears to be independent of the orientation of the binding site 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "strachan:1999a"

\end_inset

. Since in general, we do not have information of the strand in which a binding site may be functional, we have not considered strand in our analysis.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

TF-map pairwise alignment
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:TF-map alignment"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-maps!alntf@alignments
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!tfma@TF-map alignments
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!meta@meta-alignments
\end_layout

\end_inset

 The same types of sequence alignments that were reviewed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

 are also possible with maps: pairwise or multiple, global or local alignments. In this chapter, we described the algorithms of global and local pairwise TF-map alignment. The approach for multiple map alignment is detailed in the next chapter.
\end_layout

\begin_layout Standard


\begin_inset Newpage clearpage
\end_inset

Formally, the pairwise alignment of the TF-maps 
\begin_inset Formula $A = a_1 \ldots a_m$
\end_inset

 and 
\begin_inset Formula $B = b_1 \ldots b_n$
\end_inset

 is a correspondence 
\begin_inset Formula $T$
\end_inset

, maybe empty, between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 such that 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

: 
\end_layout

\begin_layout Enumerate


\begin_inset Formula $(a_i,b_j) \in T$
\end_inset

 if and only if 
\begin_inset Formula $a_i^f = b_j^f$
\end_inset

 (that is, two elements are aligned if and only if they correspond to the same TF).
\end_layout

\begin_layout Enumerate

if 
\begin_inset Formula $(a_i,b_j) \in T$
\end_inset

 then there are no other elements 
\begin_inset Formula $b_l~(l \neq j)$
\end_inset

 in 
\begin_inset Formula $B$
\end_inset

 such that 
\begin_inset Formula $(a_i,b_l) \in T$
\end_inset

, nor elements 
\begin_inset Formula $a_k~(k \neq i)$
\end_inset

 in 
\begin_inset Formula $A$
\end_inset

 such that 
\begin_inset Formula $(a_k,b_j) \in T$
\end_inset

 (that is, each element in 
\begin_inset Formula $A$
\end_inset

 is aligned at most to one element in 
\begin_inset Formula $B$
\end_inset

, and vice versa).
\end_layout

\begin_layout Enumerate

if 
\begin_inset Formula $(a_i,b_j) \in T$
\end_inset

 and 
\begin_inset Formula $(a_k,b_l) \in T$
\end_inset

 and 
\begin_inset Formula $i<k$
\end_inset

 then 
\begin_inset Formula $j<l$
\end_inset

 (that is, the alignment maintains the colinearity between the sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

).
\end_layout

\begin_layout Enumerate

if 
\begin_inset Formula $(a_i,b_j) \in T$
\end_inset

 and 
\begin_inset Formula $(a_k,b_l) \in T$
\end_inset

 with 
\begin_inset Formula $i<k$
\end_inset

 and 
\begin_inset Formula $j<l$
\end_inset

 then 
\begin_inset Formula $a_i^{p_2} < a_k^{p_1}$
\end_inset

 and 
\begin_inset Formula $b_j^{p_2} < b_l^{p_1}$
\end_inset

 (that is, no overlap in the primary sequences is permitted between the sites corresponding to the aligned elements). 
\end_layout

\begin_layout Standard

Usually there are many possible alignments between two given 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 maps (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dummy"

\end_inset

 for an example). Given an alignment 
\begin_inset Formula $T$
\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

T = 
\backslash
{ (a_{I_1},b_{J_1}), (a_{I_2},b_{J_2}), 
\backslash
cdots, (a_{I_t},b_{J_t}) 
\backslash
}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula $T_k = (a_{I_k},b_{J_k})$
\end_inset

 is the match between the 4-tuple in position 
\begin_inset Formula ${I_k}$
\end_inset

 from A and the 4-tuple in position 
\begin_inset Formula ${J_k}$
\end_inset

 from B, we compute the score of the alignment 
\begin_inset Formula $s(T)$
\end_inset

 in the following way:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

s(T) = & 
\backslash
alpha 
\backslash
sum_{k=1}^t a_{I_k}^s + b_{J_k}^s
\backslash

\backslash

\end_layout

\begin_layout Standard

 & - 
\backslash
lambda (m + n -2 t)
\backslash

\backslash

\end_layout

\begin_layout Standard

%
\backslash
sum_{k=2}^t (I_k - I_{k-1} - 1) + (J_k - J_{k-1} - 1) 
\backslash

\backslash

\end_layout

\begin_layout Standard

 & - 
\backslash
mu 
\backslash
sum_{k=2}^t |(a_{I_k}^{p_1} - a_{I_{k-1}}^{p_1}) - (b_{J_k}^{p_1} - b_{J_{k-1}}^{p_1})|
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula $\alpha, \lambda, \mu > 0$
\end_inset

. That is, the score of the alignment increases with the score of the aligned elements (
\begin_inset Formula $\alpha$
\end_inset

), and decreases with the number of unaligned elements (
\begin_inset Formula $\lambda$
\end_inset

), and with the difference in the distance between adjacent aligned elements (
\begin_inset Formula $\mu$
\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 2: TF-mapping and dummy TF-map alignment
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.85
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/dummy
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:dummy
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-maps: construction and alignment
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-maps: construction and alignment.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(A) The sequence of a promoter is searched for occurrences of known binding motifs for transcription factors (TFs). Matches are annotated with the position of the match in the primary sequence, and the label of the TF. Because TFs can bind to motifs showing no sequence conservation, labels of the same TF at different positions may correspond to different underlying nucleotide sequences. We refer here to these sequences of pairs (
\begin_inset Quotes eld
\end_inset

label
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

position
\begin_inset Quotes erd
\end_inset

), transcription factor maps (or TF-maps). TF-maps are actually more complicated. First, we do not only register the position of each match, but also its length. Second, while in the example here, sequence motifs are associated to TFs by means of a (binary) look-up table, in our work we have instead used collections of position weight matrices. Matches to transcription factor binding sites (TFBSs) are thus scored, and this score is also registered. (B) TF-map of the promoter region of two hypothetically co-regulated genes 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

. Each letter corresponds to a different TF. We assume that 200 nucleotides upstream of the annotated transcription start site (TSS) have been considered, with position 1 corresponding to position -200 from the TSS. (C) Global pairwise alignment of the two co-regulated genes 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

. Only positions with identical labels can be aligned. Essentially, the alignment finds the longest common substring constrained to maximizing the sum of the scores (not shown here) of the aligned positions, and minimizing the differences in the distances on the primary sequence between adjacent aligned positions.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Finding the optimal alignment
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The optimal alignment between two given maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is the one scoring the maximum among all possible alignments. To obtain such an alignment efficiently, we have implemented an algorithm reminiscent of that proposed by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 to align and compare restriction enzyme maps. This algorithm was developed to find the distance between two homologous restriction maps in terms of minimum weighted sum of genetic events necessary to convert one restriction map into another, where the genetic events are the appearance/disappearance of restriction sites and changes in the number of bases between restriction sites (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

 for further details).
\end_layout

\begin_layout Standard

Here to align TF-maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, we adapted the recursion in 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 to optimize similarity instead 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. In addition, we included a term (
\begin_inset Formula $\alpha$
\end_inset

) into the scoring function to weight the scores of the TFBSs. We also explicitly prohibited overlap between the sites.
\end_layout

\begin_layout Standard

Thus, the maximum similarity 
\begin_inset Formula $S_{ij}$
\end_inset

 between TF-maps 
\begin_inset Formula $A = a_1 \ldots a_i$
\end_inset

 and 
\begin_inset Formula $B = b_1 \ldots b_j$
\end_inset

 where the site 
\begin_inset Formula $a_i^f$
\end_inset

 is equal to the site 
\begin_inset Formula $b_j^f$
\end_inset

, can be computed as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{llll}
\end_layout

\begin_layout Standard

S_{ij} 
\backslash
equiv & S(a_i,b_j) = & 
\backslash
alpha (a_i^s + b_j^s) +& 
\backslash

\backslash

\end_layout

\begin_layout Standard

              & &  max_{i',j'} & 
\backslash
{S_{i'j'}
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$0 < i' < i$}} & - 
\backslash
lambda (i - i' - 1 + j - j'- 1)
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$0 < j' < j$}} & - 
\backslash
mu (|(a_i^{p_1} - a_{i'}^{p_1}) - (b_j^{p_1} - b_{j'}^{p_1})|)
\backslash
}.
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$a_{i'}^{p_2} < a_i^{p_1}$}} & 
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$b_{j'}^{p_2} < b_j^{p_1}$}} &
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
label{eqnaive}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Sequence alignments and meta-alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!seqaln@sequence alignments
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!seqtf@sequences and TF-maps
\end_layout

\end_inset

 There is an intimate relationship between the Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eqnaive"

\end_inset

 and the Needleman and Wunsch recurrence as revisited by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

 in which the conventional pairwise sequence alignment is based (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

, Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "nwrevisited"

\end_inset

).
\end_layout

\begin_layout Standard

In fact, the sequence alignment class of algorithms are a particular case of the more general class of map alignment algorithms. Let us analyze the form in which the conventional sequence alignment calculates any value in the similarity matrix 
\begin_inset Formula $S$
\end_inset

, trying to detect for each element in such a recurrence its counterpart in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eqnaive"

\end_inset

:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The matches and the substitutions between two symbols 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 are assigned the value of the corresponding scoring function 
\begin_inset Formula $s(x,y)$
\end_inset

 in a sequence alignment. The matches between two elements in a meta-alignment are also scored using a similar function (the 
\begin_inset Formula $\alpha$
\end_inset

 parameter in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eqnaive"

\end_inset

). Let us consider 
\begin_inset Formula $\alpha=(\alpha_1,\alpha_2 \ldots \alpha_k)$
\end_inset

 the family of scoring functions for evaluate any type of identity and substitution between two symbols 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

. If the mapping quality score of each element is omitted, the scoring functions 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $\alpha$
\end_inset

 are equivalent. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The number of gaps in a sequence alignment is punished by the scoring function 
\begin_inset Formula $s(x,-)=s(-,x)$
\end_inset

. There is not an explicit penalty for introducing a single gap into a meta-alignment. However, the 
\begin_inset Formula $\lambda$
\end_inset

 parameter punishes the number of elements in two maps that are not included in the optimal met-alignment. Because such unaligned elements are implicitly aligned to gaps in the other map, the 
\begin_inset Formula $\lambda$
\end_inset

 parameter is the equivalent of the scoring function 
\begin_inset Formula $s(x,-)$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The 
\begin_inset Formula $\mu$
\end_inset

 parameter must be silenced due to the lack of mapping information in conventional sequences. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

A trivial mapping function to translate a sequence of nucleotides into a map that can be meta-aligned consists on using the position of the elements in the sequence also as the position in the map. The length of every feature is in this case one position. The score of each feature is neglected as nucleotides do not have this value. With these considerations in mind, the sequence of nucleotides 
\begin_inset Formula $S=ATTACTG$
\end_inset

 can be transformed into the map 
\begin_inset Formula $M$
\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard

$$%
\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{lccccccc}
\end_layout

\begin_layout Standard

S: & A & T & T & A & C & T & G
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard

M: & (A,1,1,
\backslash
cdot) & (T,2,2,
\backslash
cdot) & (T,3,3,
\backslash
cdot) & (A,4,4,
\backslash
cdot) & (C,5,5,
\backslash
cdot) & (T,6,6,
\backslash
cdot) & (G,7,7,
\backslash
cdot).
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard

$$%
\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The meta-alignment class of algorithms can deal, therefore, with any sequence alignment problem. However, the opposite is not true, as meta-alignments involve management of higher-order level features that are not supported in the classical sequence comparisons.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Naive implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!naive@naive algorithm
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!tfnaive@TF-map alignment
\end_layout

\end_inset

 A naive implementation of the recursion above (Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eqnaive"

\end_inset

) involves the recursive filling of the cells 
\begin_inset Formula $S_{ij}$
\end_inset

 in the matrix 
\begin_inset Formula $S$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1984c"

\end_inset

. In the pseudocode shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:naivealg"

\end_inset

, the elements of the maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are represented as structures 
\begin_inset Formula $a_i$
\end_inset

 and 
\begin_inset Formula $b_j$
\end_inset

, with the functions 
\emph on
factor
\emph default
, 
\emph on
score
\emph default
, 
\emph on
pos1
\emph default
 and 
\emph on
pos2
\emph default
 returning the values of the corresponding fields. The variable 
\emph on
currentSim
\emph default
 stores the optimal score so far computed. The resulting meta-alignment can be easily retrieved using a supplementary structure 
\emph on
path(i,j)
\emph default
 which points to the previous cell in the optimal path leading to cell 
\begin_inset Formula $S_{ij}$
\end_inset

. In addition, for each cell 
\begin_inset Formula $S_{ij}$
\end_inset

, the function 
\emph on
ComputeInitialSimilarity
\emph default
 calculates the initial score of a hypothetical alignment that includes only 
\begin_inset Formula $a_i$
\end_inset

 and 
\begin_inset Formula $b_j$
\end_inset

.
\end_layout

\begin_layout Standard

Note that to compute the optimal score at 
\begin_inset Formula $S_{ij}$
\end_inset

 with this algorithm, all the cells 
\begin_inset Formula $S_{kl}$
\end_inset

 (
\begin_inset Formula $k<i$
\end_inset

, 
\begin_inset Formula $l<j$
\end_inset

) need to be explored (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:naivealg"

\end_inset

). Therefore, if the lengths of the TF-maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 respectively, the cost of computing 
\begin_inset Formula $S(A,B)=S(a_m,b_n)$
\end_inset

 is 
\begin_inset Formula $O(mn \cdot mn) = O(m^2n^2)$
\end_inset

. Under the assumption that 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 are similar lengths, the final cost function is 
\begin_inset Formula $O(n^4)$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 3: Naive algorithm
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard

 
\backslash
REQUIRE $A,B$: list of $<$factor,pos1,pos2,score$>$
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Calculating the element $i,j$ in $S$}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|-1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=0$ to $|B|-1$}
\end_layout

\begin_layout Standard


\backslash
IF{factor$(a_i)$ = factor$(b_j)$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,j) 
\backslash
leftarrow$ ComputeInitialSimilarity();
\end_layout

\begin_layout Standard


\backslash
STATE $x 
\backslash
leftarrow 
\backslash
alpha$ (score$(a_i)$ + score$(b_j)$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Searching the best previous match in $S$}
\end_layout

\begin_layout Standard


\backslash
FOR{$i'=0$ to $i-1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j'=0$ to $j-1$}
\end_layout

\begin_layout Standard


\backslash
IF{pos2($a_{i'}$) $<$ pos1($a_i$) and pos2($b_{j'}$) $<$ pos1($b_j$)}
\end_layout

\begin_layout Standard


\backslash
STATE $y 
\backslash
leftarrow 
\backslash
lambda ((i-i'-1) + (j-j'-1))$;
\end_layout

\begin_layout Standard


\backslash
STATE $z 
\backslash
leftarrow 
\backslash
mu (|($pos1$(a_i)$ - pos1$(a_{i'})$) - (pos1$(b_j)$ - pos1$(b_{j'}))|)$;
\end_layout

\begin_layout Standard


\backslash
STATE currentSim $
\backslash
leftarrow S(i',j') + x - y - z$;
\end_layout

\begin_layout Standard


\backslash
IF{currentSim $> S(i,j)$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,j) 
\backslash
leftarrow$ currentSim;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\backslash
incgraph{width=0.75
\backslash
linewidth}{ps/prev}%}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:naivealg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The Naive TF-map alignment algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The Naive TF-map alignment algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The whole matrix must be visited for each new match 
\begin_inset Formula $S_{ij}$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Enhanced implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!enh@enhanced algorithm
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!tfnaive@TF-map alignment
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

 described an improved algorithm for computing in 
\begin_inset Formula $O(mn(\log m + \log n))$
\end_inset

 time the minimum distance between two restriction maps of length 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 respectively under the original framework proposed by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984a"

\end_inset

. The algorithm, reviewed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

, is basically a sparse dynamic programming computation in which candidate lists are used to model the future contribution of all previously computed cells in distance matrix 
\begin_inset Formula $D$
\end_inset

 to those yet to be computed. The cells in the list that can not affect the values of any cell to be computed are eliminated from the list. The key concept of this algorithm is the mapping of the original matrix 
\begin_inset Formula $D$
\end_inset

 to another matrix in which each cell is indexed by the positions of the sites in the original sequences, and not by their positions in the maps. During the computation, this matrix is partitioned into intervals for which only a representative cell is used to compute the best alignment ending at each match in a given interval.
\end_layout

\begin_layout Standard

Here, we can not directly export this strategy, because, in contrast to the restriction enzyme maps which are points in the sequence, TFBSs are sequence intervals (having, thus, two dimensions). In addition, different TFBSs can start at the same point, but end at different positions. Since we explicitly prohibit overlapping between TFBSs in the alignments, the assignation of a cell representative within a given interval must not be irreversible.
\end_layout

\begin_layout Standard

However, we have still taken advantage of the extreme sparsity of the matrix 
\begin_inset Formula $S$
\end_inset

 when aligning TF-maps 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. Note that, in general, the probability of matching two elements from two sequences of characters that follow a uniform random distribution is inversely proportional to the size of the character alphabet. For instance the probability of matching two nucleotides when comparing two random DNA sequences in the four letter alphabet is about 0.25. In an alphabet of about 100 characters --the order of magnitude of the alphabets of symbols denoting TFs that we are considering here-- such a probability would be about 0.01. When aligning sequences in alphabets of such sizes, the matrix 
\begin_inset Formula $S$
\end_inset

 above, that only takes values for match positions between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, becomes therefore extremely sparse. Indeed, Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:sparsem"

\end_inset

 displays the occupancy of the matrix 
\begin_inset Formula $S$
\end_inset

 corresponding to the alignments of the TF-maps obtained on the human and mouse promoters of the 
\emph on
skeletal muscle 
\begin_inset Formula $\alpha$
\end_inset

-actin
\emph default
 gene (ACTA1, GenBank entries AF182035 and M12347). We have used three different collections of PWMs for TFBSs (see next section) to obtain the TF-maps of both promoter sequences. In all cases, despite the differences in the lengths of the obtained maps, the occupancy of the matrix 
\begin_inset Formula $S$
\end_inset

 is well under 5%.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 5: Sparse matrices
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.25
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/sparsem1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.25
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/sparsem2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.25
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/sparsem3
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:sparsem
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Sparse matrices
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Graphical representation of the sparse dynamic programming matrix 
\begin_inset Formula $S$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Matrices produced by the transcription factor map alignment between the human and mouse promoters of the 
\emph on
skeletal alpha-actin
\emph default
 gene (ACTA1, GenBank entries AF182035 and M12347), using different collections of position weight matrices for transcription factor binding sites (TFBSs). The axes of the matrix list the transcription factor labels of the predicted TFBSs in the human and mouse promoters. Despite the differences in the total number of predicted TFBSs depending on the collection, the occupancy of the matrix remains consistently low.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In the algorithm presented in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:enhancedalg"

\end_inset

, we substitute the two internal nested loops by a list 
\begin_inset Formula $L$
\end_inset

 to register the coordinates of the match cells in the sparse matrix 
\begin_inset Formula $S$
\end_inset

. Each node of 
\begin_inset Formula $L$
\end_inset

 is represented as structures 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 with the functions 
\emph on
abscissa
\emph default
 and 
\emph on
ordinate
\emph default
 returning the corresponding coordinates. Thus, to compute the optimal score at the cell 
\begin_inset Formula $S_{ij}$
\end_inset

, only the non-empty cells in 
\begin_inset Formula $S$
\end_inset

 need to be accessed. In addition, we maintain the list sorted by optimal score, so that the cell scoring the maximum value is at the beginning of the list. Scanning the list from the beginning to the end implies that, in most cases, only a few nodes will need to be accessed before a a critical node is reached beyond which the optimal score can not be improved.
\end_layout

\begin_layout Standard

While investigating the exact complexity of this algorithm is difficult --depending mostly on the size of the input maps and the sparsity of the resulting matrix 
\begin_inset Formula $S$
\end_inset

--, the expected time cost analysis can be performed. The 
\begin_inset Formula $O(n^4)$
\end_inset

 cost of the naive algorithm can be explained in terms of (a) a first quadratic term derived from the obligatory comparison between all of the TFBSs of both maps to detect the match cells and (b) a second quadratic term necessary to search for each match the best adjacent previous pair in the optimal TF-map alignment.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 6: Enhanced algorithm
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: list of $<$factor,pos1,pos2,score$>$, $L$: list of $<$abscissa,ordinate$>$, $L = 
\backslash
emptyset$
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Calculating the element $i,j$ in $S$}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|-1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=0$ to $|B|-1$}
\end_layout

\begin_layout Standard


\backslash
IF{factor$(a_i)$ = factor$(b_j)$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,j) 
\backslash
leftarrow$ ComputeInitialSimilarity();
\end_layout

\begin_layout Standard


\backslash
STATE $x 
\backslash
leftarrow 
\backslash
alpha$ (score$(a_i)$ + score$(b_j)$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Searching the best previous match in $L$}
\end_layout

\begin_layout Standard


\backslash
STATE $p 
\backslash
leftarrow$ first($L$);
\end_layout

\begin_layout Standard


\backslash
STATE $i' 
\backslash
leftarrow$ abscissa($p$);
\end_layout

\begin_layout Standard


\backslash
STATE $j' 
\backslash
leftarrow$ ordinate($p$);
\end_layout

\begin_layout Standard


\backslash
WHILE{end($L$) = FALSE and $S(i',j') + x > S(i,j)$}
\end_layout

\begin_layout Standard


\backslash
IF{pos2($a_{i'}$) $<$ pos1($a_i$) and pos2($b_{j'}$) $<$ pos1($b_j$)}
\end_layout

\begin_layout Standard


\backslash
STATE $y 
\backslash
leftarrow 
\backslash
lambda ((i-i'-1) + (j-j'-1))$;
\end_layout

\begin_layout Standard


\backslash
STATE $z 
\backslash
leftarrow 
\backslash
mu (|($pos1$(a_i)$ - pos1$(a_{i'})$) - (pos1$(b_j)$ - pos1$(b_{j'}))|)$;
\end_layout

\begin_layout Standard


\backslash
STATE currentSim $
\backslash
leftarrow S(i',j') + x - y - z$;
\end_layout

\begin_layout Standard


\backslash
IF{currentSim $> S(i,j)$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,j) 
\backslash
leftarrow$ currentSim;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $p 
\backslash
leftarrow$ next($L$);
\end_layout

\begin_layout Standard


\backslash
STATE $i' 
\backslash
leftarrow$ abscissa($p$);
\end_layout

\begin_layout Standard


\backslash
STATE $j' 
\backslash
leftarrow$ ordinate($p$);
\end_layout

\begin_layout Standard


\backslash
ENDWHILE
\end_layout

\begin_layout Standard


\backslash
STATE $n 
\backslash
leftarrow$ CreateNewNode($i,j$);
\end_layout

\begin_layout Standard


\backslash
STATE InsertNode($n,L$);
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:enhancedalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The Enhanced TF-map alignment algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The Enhanced TF-map alignment algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In this enhanced algorithm, the contribution (a) is inevitable so that the lower bound of the cost function is the number of matches between both TF-maps, that is 
\begin_inset Formula $O(n^2)$
\end_inset

. However, the substitution of the two inner loops for a list of cell matches sorted by optimal score does affect the contribution (b). Thus, such a term is now equivalent to the expected number of consulted elements of the ordered list 
\begin_inset Formula $L$
\end_inset

 to compute each 
\begin_inset Formula $S_{ij}$
\end_inset

 value. This expectation can be approximated to
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

O
\backslash
left(~
\backslash
sum_{
\backslash
alpha
\backslash
in {
\backslash
cal A}} (P(
\backslash
alpha)^2 n^2)~
\backslash
right)
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula ${\cal A}$
\end_inset

 is the set of symbols (in our case the alphabet of TFs) and 
\begin_inset Formula $P(\alpha)$
\end_inset

 is the probability to match the symbol 
\begin_inset Formula $\alpha$
\end_inset

 in a random trial (it is a particular case of the sequence comparison by hashing, see Theorem 8.1 in 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1995a"

\end_inset

). Therefore, under the previous hypothesis of a comparison between two TF-maps in an alphabet of 
\begin_inset Formula $100$
\end_inset

 characters that follows a uniform random random distribution (
\begin_inset Formula $P(\alpha) = 0.01$
\end_inset

, only 1% of the matrix is occupied), the expected value of the contribution (b) is 
\begin_inset Formula $O(0.01~n^2)$
\end_inset

.
\end_layout

\begin_layout Standard

The empirical results obtained during the program training (see next section) confirmed such analysis 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. In average, on the order of 200 million elements were consulted by the naive algorithm during the optimization. In contrast, the enhanced algorithm only needed to access nearly two million elements to compute the same set of alignments (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:access"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset Newpage clearpage
\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.75
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/access
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:access
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Number of accessions to the matrix 
\begin_inset Formula $S$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Number of accessions (in millions) to the matrix 
\begin_inset Formula $S$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

In red, the performance of the Naive algorithm; in orange, the performance of the Enhanced algorithm, with a normal list 
\begin_inset Formula $L$
\end_inset

; in green, the performance of the Enhanced algorithm, sorting the list 
\begin_inset Formula $L$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

TF-map alignment training
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:TF-map training"

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!trai@training
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

meta-alignments!mtrai@training
\end_layout

\end_inset

 The optimal alignment between two TF-maps is obviously dependant on the 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $\lambda$
\end_inset

, and 
\begin_inset Formula $\mu$
\end_inset

 parameters. In principle, we want the optimal alignment between the maps derived from promoter sequences of two co-expressed genes to include most of the mapped TFBSs known to be involved in the regulation of the genes (high sensitivity), and few of the mapped TFBSs not known to be involved in such regulation (high specificity). The implicit assumption here is that the TFBSs in the alignment are considered predictions of TFBSs on the underlying promoter sequences. It is also important to stress that two different TFBSs can be aligned if they correspond to the same TF.
\end_layout

\begin_layout Standard

The optimal parameter configuration, however, is likely to depend on the particular problem to be addressed: the genes to be compared (orthologous genes from different species or genes co-regulated after an expression microarray experiment, for instance), and the particular protocol to map the TFBSs into the original promoter sequences. Often the optimal configuration of parameters will be specific of the pair of gene promoters to be compared.
\end_layout

\begin_layout Standard

With these caveats in mind, since our focus here is on mammalian comparisons, we have estimated the parameters that are globally optimal when aligning a set of well annotated human-mouse orthologous promoter pairs 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. The underlying assumption is that these orthologous pairs are regulated in a similar way. We have estimated the optimal parameters separately in three different collections of PWMs for locating TFBSs, and in each case we have chosen the parameters such that the resulting global alignment achieved the maximum average sensitivity and specificity as defined below.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Datasets
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!traidata@training datasets
\end_layout

\end_inset

 From several landmark papers in the field 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "wasserman:1998a,krivan:2001a,blanchette:2002a,dermitzakis:2002a,lenhard:2003a"

\end_inset

, we have gathered and manually curated a collection of 278 TFBSs (139 + 139 orthologous sites) that had been experimentally tested in 40 orthologous human and rodent genes. The transcription start site (TSS) of each entry in the literature was compared to the RefSeq 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "pruitt:2005a"

\end_inset

 annotation of the corresponding genome to ensure that we were dealing with the actual proximal promoter. Because most (214 out of 278) of the annotated TFBSs are located in the 200 nucleotides immediately upstream of the TSS, we restricted to this region in our training and evaluation analysis, and considered only those cases for which the same pair of TFBSs had been annotated in this region for both species. This resulted in a collection of 202 sites (101 + 101) from 36 genes, to which we refer here as the 
\shape smallcaps
HR set
\shape default
.
\end_layout

\begin_layout Standard

We have estimated the optimal parameters in the 
\shape smallcaps
HR set
\shape default
 for the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 1.0, 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

JASPAR
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Promo
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 2.0 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

PROMO
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 6.3 collections. 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TRANSFAC
\end_layout

\end_inset

 In the three cases, the original frequency coefficients of the matrices have been converted into log-likelihood ratios using the random equiprobability distribution as a background model. The log operation can not be directly performed on matrix positions containing null values (that is, 0 occurrences). We have instead estimated the value of the log-likelihood function for the null positions in a given matrix row, taking into account the values computed in that row for one and two occurrences. Let 
\begin_inset Formula $y = f(x)$
\end_inset

 be the log-likelihood function approached as a line that goes from the point 
\begin_inset Formula $P=(x_1,y_1)$
\end_inset

 to the point 
\begin_inset Formula $Q=(x_2,y_2)$
\end_inset

. If we consider 
\begin_inset Formula $P=(x_1,1)$
\end_inset

 and 
\begin_inset Formula $Q=(x_2,2)$
\end_inset

 which correspond to the cases in which one and two occurrences are present, the values 
\begin_inset Formula $x_1$
\end_inset

 and 
\begin_inset Formula $x_2$
\end_inset

 can be easily computed. Thus, the equation of the line that goes from 
\begin_inset Formula $Q$
\end_inset

 to 
\begin_inset Formula $P$
\end_inset

 can be inferred for each row of the matrix. In particular, the value of this line in the point 
\begin_inset Formula $R=(x_0,0)$
\end_inset

 can be trivially calculated, being used as an estimation for the null values in that row of the matrix.
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $M$
\end_inset

 be a PWM constructed from 
\begin_inset Formula $33$
\end_inset

 TFBSs, where 
\begin_inset Formula $M_i$
\end_inset

 and 
\begin_inset Formula $M_i^*$
\end_inset

 denote the absolute and relative frequency of each nucleotide at the position 
\begin_inset Formula $i$
\end_inset

, respectively. The conversion from 
\begin_inset Formula $M_i$
\end_inset

 into a log-likelihood ratio matrix is explained in the following example (base-
\begin_inset Formula $e$
\end_inset

 logarithms):
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard

%
\backslash
begin{equation}
\end_layout

\begin_layout Standard

$$
\end_layout

\begin_layout Standard


\backslash
begin{array}{rrrrr}
\end_layout

\begin_layout Standard

    & A &  C & G & T
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard

M_i & 7 & 25 & 0 & 1
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard

M_i^* = 
\backslash
frac{M_i}{33} & 0.21 & 0.75 & 0 & 0.03
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard


\backslash
log{
\backslash
frac{M_i^*}{0.25}} & -0.164 & 1.109 & ? & -2.110
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard

Estimation & & & -2.803 & 
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard

$$
\end_layout

\begin_layout Standard

%
\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The resulting matrices were used to obtain the list of TFBSs matches along the 200 bases upstream of the TSS in each of the 36 pairs of promoter sequences from the 
\shape smallcaps
HR set
\shape default
. A prediction obtained with a given PWM was accepted if it had an score above the 50% (
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

), 70% (
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Promo
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

) and 55% (
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

) of the maximum possible score for such PWM. These values correspond in the three cases to the conventional 80% threshold when considering the original frequency matrices 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

.
\end_layout

\begin_layout Standard

Those annotated TFBSs not included in the predictions for both orthologous pairs (either because no matrix exists in the collection for such TFBSs, or because the match is below the threshold) were discarded. This reduced the effective number of training gene pairs (those with at least one real predicted TFBS for both orthologous pairs) from 36 to 29 for the three collections considered here 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

.
\end_layout

\begin_layout Standard

Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:accuracy"

\end_inset

 shows for each collection the total number of matrices, and TFs to which they correspond, the number of genes for which at least one annotated TFBS is predicted on each ortholog after the search, and the number of real and predicted TFBSs (the total and the average per gene pair). As it is possible to see, slightly more than three conserved TFBSs were annotated per orthologous gene pair 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Collecting regulatory data
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Information about the genomic coordinates and the sequence of experimentally identified transcription factor binding sites is found scattered under a variety of diverse formats. The availability of standard collections of such high-quality data is important to design, evaluate and improve novel computational approaches to identify binding motifs on promoter sequences from related genes.
\end_layout

\begin_layout Standard

Typically, computational methods to detect regulatory elements use their own training set of experimental annotated TFBSs. These annotations are usually collected from bibliography or from general repositories of gene regulation information, such as 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "sandelin:2004a"

\end_inset

 or 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "matys:2003a"

\end_inset

. However, each program establishes different criteria and formats to retrieve and display the data that forms the final training set, which makes the comparison between different methods very difficult. The construction of a good benchmark to evaluate the accuracy of several pattern discovery methods is therefore not a trivial procedure 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "tompa:2005a"

\end_inset

.
\end_layout

\begin_layout Standard

To build the TF-map alignment training dataset, we gathered from the literature a collection of experimentally validated binding sites that are conserved in at least two orthologous vertebrate promoters. The sites and the promoter sequences were manually curated to ensure data consistency. The data is publicly available at the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

ABS
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 database (see Web Glossary). 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

ABS
\end_layout

\end_inset


\end_layout

\begin_layout Standard

We annotated in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

ABS
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006a"

\end_inset

 up to 650 experimental binding sites from 68 transcription factors and 100 orthologous target genes in human, mouse, rat or chicken genome sequences. Computational predictions and promoter alignment information are also provided for each entry. In addition, we provided a web interface to interact and analyze the promoters and their binding sites (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:absweb"

\end_inset

). We also included a customizable generator of artificial datasets and an evaluation tool to aid during the training of motif-finding programs 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006a"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Accuracy measures
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

After the maps were obtained, we aligned them within each orthologous pair using the algorithm described in the previous section with different combinations of parameters. Each parameter was allowed to independently take values between 0.0 and 1.0, in incremental steps of 0.01. In total, thus, one million parameter configurations were evaluated for each collection of PWMs. For each configuration, the resulting optimal alignments on the pairs of orthologous promoters (that is, the predicted TFBSs) were compared to the annotated TFBSs in the promoters.
\end_layout

\begin_layout Standard

Two values were computed to measure the agreement between predicted and annotated TFBSs: sensitivity and specificity. Sensitivity is the number of correctly predicted TFBSs over the number of annotated TFBSs, and specificity is the number of correctly predicted TFBSs over the number of predicted TFBSs. We used here the term specificity as in the gene finding literature. However, the value that we compute here is more generally known as Positive Predictive Value. We considered an annotated TFBS to be correctly predicted when there was a predicted TFBS that overlapped it by at least 1 nucleotide in both human and mouse sequences, irrespectively of whether the TF label associated to the aligned TFBS matched that of the annotated TFBS. This is because TFBSs for different TFs often cluster at the same position when using PWMs (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pspla"

\end_inset

). If a similar cluster occurs in the two sequences to be aligned, our algorithm will inevitably choose to align the pair of TFBSs with the highest sum of match scores.
\end_layout

\begin_layout Standard

As an optimization measure we computed the average value of sensitivity and specificity. Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:accuracy"

\end_inset

 lists the optimal combination of parameters with regard to this measure for each of the three collections of PMWs used here. Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:accuracy"

\end_inset

 also lists sensitivity, specificity, their average, the average length of the optimal alignments (that is, the number of predicted TFBSs after the alignment), and the fraction of the promoter region covered by the predicted (aligned) TFBSs. In addition, for each optimal configuration we have also computed the same set of accuracy measures under the strict criterion of considering an annotated TFBS to be correctly predicted only when the TF label of the prediction matched that of the overlapped annotation. We also computed sensitivity and specificity at the nucleotide level. At this level, we compute the number of nucleotides in predicted TFBSs that are also in annotated TFBSs.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 1
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{landscape}
\end_layout

\end_inset

 
\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset Graphics 
	filename ../tables/maccuracy.pdf
	clip
	BoundingBox 30 479 566 817

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:accuracy
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment accuracy results on the 
\shape smallcaps
HR set
\shape default

\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment accuracy results on the 
\shape smallcaps
HR set
\shape default
.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\size tiny
Parameters were estimated independently using three different collections of position weight matrices (PWMs) for transcription factor binding sites (TFBSs) to obtain the TF-maps of the promoter sequences. The table has three parts. On 
\series bold
top
\family default
\series default
\shape default
, number of matrices in each of these collections, and the number of transcription factors (TFs) these matrices correspond to. In the 
\series bold
middle
\family default
\series default
\shape default
, statistics of the resulting TF-maps: number of promoter pairs (out of 36) for which matches to at least one common TFBS was found in both the human and mouse orthologs (and for which, therefore, there exist a non-void TF-map alignment), total and average number of real TFBSs per promoter sequence, total and average number of predicted TFBSs per promoter sequence, and sensitivity and specificity at the nucleotide and site levels (see main text for definitions). The average sensitivity and specificity at the site level is the optimization measure when estimating the parameters of the algorithm. Coverage is the fraction of the sequence of the promoters covered by matches to TFBSs. At the 
\series bold
bottom
\family default
\series default
\shape default
, results of the optimal TF-alignments: optimal parameters and average length (number of aligned elements in the optimal TF-map alignments), measures of sensitivity and specificity at the levels of nucleotide, site overlap, and site plus label match (see main text for definitions). Coverage is the fraction of the sequence of the promoters covered by matches to TFBSs.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{landscape}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

This number over the total number of nucleotides in annotated TFBSs is the sensitivity, and over the total number of nucleotides in predicted TFBSs is the specificity. Finally, as a summary of these two numbers we compute the correlation coefficient. All the accuracy measures were also computed on the initial PWM predictions, prior to the alignments.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 8: ABS
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.85
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/abs
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:absweb
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Examples of the ABS data retrieval system
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Examples of the ABS data retrieval system.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The annotation of a gene, the set of binding motifs from a given TF in human and mouse and the extraction of the promoter sequences containing such annotations 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header.}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Accuracy results
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!acc@accuracy
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

meta-alignments!macc@accuracy
\end_layout

\end_inset

 As it is possible to see, the main effect of the meta-alignment is the dramatic reduction in the number of predicted TFBSs that typically result after a PWM-based search (see also Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pspla"

\end_inset

). Taking, for instance, the popular 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 collection, the average number of TFBSs predicted per promoter in our dataset using this database is about 230. The TF-map alignment reduces this number approximately 15-fold, while the predicted TFBSs still covering essentially all annotated TFBSs 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. This gain in specificity is not simply due to the selection of an arbitrary set of non-overlapping TFBSs, since as a result of the map alignments the proportion of the promoter region covered by predicted TFBSs drops from 98% to 65% --a number which is more consistent with the estimated occupancy by TFs of the core promoter regions 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "wray:2003a"

\end_inset

.
\end_layout

\begin_layout Standard

In this regard, we have compared the map alignments here with direct sequence alignments in their ability to identify TFBSs in the promoter regions of co-regulated genes. We have used NCBI-BLASTN 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "altschul:1990a"

\end_inset

 to identify conserved blocks in the promoter region of the orthologous pairs in the 
\shape smallcaps
HR set
\shape default
. We have searched for local, instead of global alignments because we expect the TFBSs to distribute discretely along the promoter region --resulting in a patch of conserved and non-conserved fragments. In addition, local alignments are insensible to the relative rearrangements in the order of the TFBSs between the promoters sequences compared. This is an advantage over the map alignments, which require colinearity of the TFBSs in the sequences to be compared. Despite this, and the fact that promoter elements are usually embedded within well conserved sequences in human and mouse orthologous promoters, map alignments are comparable or outperform the BLASTN comparison when identifying TFBSs in them 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. The correlation coefficient between the sequences covered by the BLASTN alignments and the annotated TFBSs is 
\begin_inset Formula $0.15$
\end_inset

, while the same measure when considering the sequences covered by the map alignments is 
\begin_inset Formula $0.19$
\end_inset

 for 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

, 
\begin_inset Formula $0.10$
\end_inset

 for 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Promo
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset Formula $0.18$
\end_inset

 for 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

. Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:accuracy2"

\end_inset

 lists these values, as well as the the values of sensitivity and specificity. To obtain these values, BLASTN was run with default parameters, but decreasing the word size to 7 (the minimum accepted value in NCBI-BLASTN). This allows for the detection of shorter and weaker alignments. The performance of BLASTN degrades if we increase the word size. We obtained similar results using the WU-BLASTN version, which allows for shorter word sizes (data not shown).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 2
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "95line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.75}{
\end_layout

\end_inset


\begin_inset Graphics 
	filename ../tables/maccuracy2.pdf
	clip
	BoundingBox 89 775 505 816

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:accuracy2
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

BLASTN accuracy results on the 
\shape smallcaps
HR set
\shape default

\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Results when using BLASTN to detect conservation between orthologous pairs.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The values in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:accuracy"

\end_inset

 reflect differences between the three collections of matrices when used in the context of the map alignments. In this context, 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 appears to show the better balance between sensitivity and specificity. This can be partially explained because there is less matrix redundancy --which in turn implies less overprediction-- in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 than in the other collections. To further minimize overprediction, we have computed the information content of all 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 matrices and selected the most informative ones. Let 
\begin_inset Formula $P$
\end_inset

 be a PWM where 
\begin_inset Formula $P(x,i)$
\end_inset

 denotes the probability of observing the nucleotide 
\begin_inset Formula $x$
\end_inset

 in the position 
\begin_inset Formula $i$
\end_inset

 of a motif of length 
\begin_inset Formula $n$
\end_inset

. The amount of information 
\begin_inset Formula $R$
\end_inset

 of the matrix 
\begin_inset Formula $P$
\end_inset

 is defined as 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "schneider:1990a"

\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

R(P) = 
\backslash
sum_{i = 1 
\backslash
ldots n} 
\backslash
left( 2 + 
\backslash
sum_{x
\backslash
in A,C,G,T}{P(x,i) 
\backslash
log{P(x,i)}} 
\backslash
right).
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

When using the collection of the 50 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 matrices with the highest 
\begin_inset Formula $R$
\end_inset

 value (which we refer to as 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset Formula $_{TOP50}$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

) 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

JASPAR
\begin_inset Formula $_{TOP50}$
\end_inset


\end_layout

\end_inset

 to obtain the TF-maps, detection of TFBSs through map alignments improves over the entire set of 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 matrices: while there is some loss of sensitivity, there is a larger gain in specificity (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:accuracy"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 9: PS-PLA1
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.85
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/pspla
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:pspla
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment of the human and mouse PLA1A gene
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment of the human and mouse PLA1A gene.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Results of the TF-alignment of the human and mouse promoters of the 
\emph on
phospholipase A1 member A
\emph default
 gene (PLA1A, RefSeq entries NM_015900, NM_134102). Here, the 2000 nucleotides upstream of the annotated transcription start site (TSS) have been considered (with position 1 corresponding to -2000). The TF-maps on these sequences were obtained using 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 6.3 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "matys:2003a"

\end_inset

. These maps contained 676 predicted binding sites in human and 595 in mouse (threshold 85%), and they are represented graphically on the top right of the figure. Each box represents a different binding site and the color corresponds to the associated transcription factor (TF). The resulting TF-map alignment is also represented graphically at the bottom right. As it is possible to see, while the region proximal to the TSS is not more dense in predicted TFBSs than other regions, most of the aligned elements cluster near to the TSS. Indeed, more than half of the elements in the TF-map alignments are within 500 nucleotides of the TSS. The program GFF2PS 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "abril:2000a"

\end_inset

 has been used to obtain the graphical representation of input predictions and final alignment.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Finally, we have also performed a complementary test to measure the specificity of the TF-map alignments 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. As a negative control, we have shuffled the orthologous pairing in the 
\shape smallcaps
HR set
\shape default
 to construct a pool of unrelated human-mouse gene pairs. Then, the corresponding TF-map alignments between these non-orthologous paired promoters were obtained using the parameters previously optimized. For the three collections of matrices, the TF-map alignments between pairs of unrelated promoters were significantly shorter with an average score about 50% smaller than TF-map alignments between 
\begin_inset Quotes eld
\end_inset

bona fide
\begin_inset Quotes erd
\end_inset

 orthologous promoters. For instance, the average length of the TF-map alignments between orthologous promoters when using the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 collection was 12.7 TFBSs, with an average score of 55.2. In contrast, the length of the TF-map alignments between non-related promoters was 8.36 TFBSs, with an average score of 20.67. The sites in the alignments involving non-orthologous gene promoters may hypothetically correspond to general regulatory elements present in most core promoters. An alternative, more probable, hypothesis is that they reflect the poor specificity of most PWMs representing TFBSs. Indeed, when we perform the same test using the more informative 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 collection, no TF-map alignments can be obtained between any pair of the non-related promoters.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset

[TF-map alignments in orthologous genes]
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Using TF-map alignments to distinguish promoters from other genomic regions
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "sec:testregions"

\end_inset


\end_layout

\begin_layout Standard

Results in the previous section indicate that alignments of TF-maps can contribute --together with other tools, such as primary sequence alignments-- to the characterization of the promoter region of co-regulated genes. This contribution is mostly obtained through the substantial reduction of the overwhelming number of candidate TFBSs that PWMs and other pattern based searches typically produce. The co-regulated genes in the test case of the previous section, however, were orthologous human-mouse pairs. The promoter regions of such pairs show substantial sequence conservation 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterston:2002a"

\end_inset

. It can be argued that under such circumstances map alignments may not be much more informative than primary sequence alignments. Note that, in general, good alignments at the primary sequence level will inevitably result --given the low specificity of the PWM search-- in good map alignments, although such map alignments may bear little relationship to the underlying conserved configurations of TFBSs. To assess to what extent good TF-map alignments are simply a reflection of underlying sequence conservation, we have compared the meta-alignments obtained using 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

, in the 200 nucleotides of the promoter region of the 36 gene pairs from the 
\shape smallcaps
HR set
\shape default
, with the meta-alignments obtained in fragments of 200 nucleotides from intergenic (2000 nucleotides upstream of the TSS), 5'UTR (downstream of the TSS), coding (downstream of the translation start site and considering only coding DNA), intronic (downstream of the first intron junction), and downstream (downstream of the transcription termination site) sequences. The test is graphically represented In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:testregions"

\end_inset

.
\end_layout

\begin_layout Standard

We have computed the average score of the map alignments in each of the genomic regions and have identified, for each homologous pair, the genome regions in which the alignment produces the highest score 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. We have performed the same exercise using global pairwise sequence alignments, obtained with CLUSTALW 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "thompson:1994a"

\end_inset

. Results appear in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:testregions"

\end_inset

 (Top). As expected, nucleotide sequence alignments score the highest in the coding regions (in 26 out of 36 cases), followed by the alignments in the promoter (5 out of 36) and 5
\begin_inset Formula $^\prime$
\end_inset

 UTR regions (4 out of 36). The scores of the sequence alignments show that promoter regions are less conserved than coding regions, and have a level of conservation similar to that observed in 5'UTRs. Despite this, TF-map alignments score the highest in the promoter regions (in 25 out of 36), where the average score of map alignments is almost twice as high as that of the coding regions. Only in 6 out of 36 cases the TF-map alignment scores the highest in coding regions. Interestingly, while intron sequences in the orthologous human-mouse pairs are much less conserved than 5'UTRs, TF-map alignments have a similar score in both regions. In fact, in 3 cases, TF-map alignments have the highest score in first introns, while only in 1 case in 5'UTRs. This is consistent with the fact that first introns are known to often contain regulatory motifs.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 10: TestRegions
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.75
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/testregionsS
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:testregions
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment on several genomic samples
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment on several genomic samples of two species.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In order to measure the ability of TF-map alignments to detect conserved regulatory elements at larger evolutionary distances --at which the degree of sequence conservation may be negligible-- we have carried out the same analysis on a set of human-chicken orthologous pairs derived from the 
\shape smallcaps
HR set
\shape default
. Using the RefSeq gene set as mapped into the UCSC genome browser, we have identified the chicken ortholog for 25 genes in the 
\shape smallcaps
HR set
\shape default
. We refer to the resulting set of human-chicken gene pairs as the 
\shape smallcaps
HC set
\shape default
 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

. As before, we have compared promoter, intergenic, 5'UTR, coding, intronic and downstream sequences between the orthologous human-chicken genes using both TF-map alignments based on 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 and sequence alignments using CLUSTALW. Results appear in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:testregions"

\end_inset

 (Bottom). While, as expected, the scores of the alignments are, in both cases, clearly lower for human--chicken than for human--mouse comparisons, the same relative trends can be observed, with sequence alignments being most significant between coding regions, and TF-map alignments between promoter regions. However, while coding sequences are still distinctively conserved between human and chicken, similarity in promoter sequences degrades substantially. Indeed, in contrast with human-rodent comparisons, 5'UTRs are, for instance clearly more conserved than the promoters between human and chicken orthologous genes. Despite this lack of sequence similarity in the human-chicken promoter pairs and the fact that we trained our algorithm specifically on human and rodent genes, the TF-maps remarkably still score the highest in these regions (in 9 out of 25). Interestingly, TF-map alignments are able to score comparatively high in downstream regions even though they do not appear to exhibit sequence conservation; regulatory motifs have been occasionally reported on these regions. Overall, these results indicate that alignments of TF-maps are able to detect conservation of regulatory signals, which can not be detected by sequence similarity alone 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanco:2006b"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 3
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset Graphics 
	filename ../tables/testregions.pdf
	clip
	BoundingBox 161 608 434 816

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:testregions
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment results on several genomic samples.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment results on several orthologous genomic samples
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(Top) Sequence and TF-map alignments of different genomic regions between the human and mouse orthologous pairs in the 
\shape smallcaps
HR set
\shape default
. (Bottom) Sequence and TF-map alignments of different genomic regions between the human and chicken orthologous pairs in the 
\shape smallcaps
HC set
\shape default
. TOP1 is the number of pairs in which the highest scoring alignment is found in a given genomic region.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Promoter identification with TF-map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!prom@promoter identification
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

promoter!idtf@identification
\end_layout

\end_inset

 Promoter identification is still a difficult problem (reviewed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

). TF-map alignments may be helpful in this problem. Using a set of 
\begin_inset Formula $278$
\end_inset

 orthologous human-chicken gene pairs of another study 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "abril:2005a"

\end_inset

, we have performed the following experiment.
\end_layout

\begin_layout Standard

We have extracted the human promoter of these genes (
\begin_inset Formula $500$
\end_inset

 nucleotides) from the UCSC human genome distribution according to the RefSeq coordinates. For the chicken genes, we have extracted the mRNA from the chicken genome surrounded by 
\begin_inset Formula $5,000$
\end_inset

 nucleotides upstream of the TSS and 
\begin_inset Formula $5,000$
\end_inset

 downstream of the end of the transcript. Finally, we have extracted samples of 
\begin_inset Formula $500$
\end_inset

 nucleotides from these long sequences, without overlapping between each contiguous windows. For each gene, the upstream promoter region, orthologous to that of human, is therefore located in the window between the positions 
\begin_inset Formula $4,500$
\end_inset

 and 
\begin_inset Formula $5,000$
\end_inset

 nucleotides (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:testpromoterpgws"

\end_inset

).
\end_layout

\begin_layout Standard

Next, we have used the 
\begin_inset Formula $50$
\end_inset

 more informative matrices from 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "matys:2003a"

\end_inset

 as a mapping function to obtain the map of each sample in the chicken sequences. We have also used 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 for mapping the predicted TFBSs on the human promoters. The experiment consisted in performing the pairwise TF-map alignment between the human promoter and all of the samples in its chicken ortholog. Then, for each window we have counted in how many cases out of the 
\begin_inset Formula $278$
\end_inset

 genes the TF-map alignment between the human promoter and that window sample scores the highest, among all of the windows. As shown in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:testpromoter"

\end_inset

, the chicken gene fragment in which more genes hit the best was the 
\begin_inset Formula $4,500-5,000$
\end_inset

 sample (31%), which corresponds with the upstream promoter region according to the RefSeq annotations. In addition, 14% and 21% of the 278 gene pairs obtained the highest TF-map alignment score on the windows located at 
\begin_inset Formula $4,000-4,500$
\end_inset

 and 
\begin_inset Formula $5,000-5,500$
\end_inset

, respectively. This bias is not observed in the rest of the windows. These percentages agree well with the errors in the precise TSS annotation 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "suzuki:2004a"

\end_inset

.
\end_layout

\begin_layout Standard

We also counted for each window in how many cases the meta-alignment between this sample and the human orthologous promoter scores among the TOP-10 best alignments. Despite the results are less significant, it is interesting to notice that in more than 200 gene pairs (76%), the TF-map alignment between the human promoter and the chicken sample in the window 
\begin_inset Formula $4,500-5,000$
\end_inset

 was among the TOP-10. We repeated the test with the full collection of 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 6.3 (
\begin_inset Formula $442$
\end_inset

 matrices). The results, shown in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:testpromoter"

\end_inset

, are slightly worse. This fact is probably related to the poor specificity of many matrices that are included in the full collection.
\end_layout

\begin_layout Standard

Again, we performed the same experiment with the program BLASTN, using the score of the best HSP on each alignment to rank the window comparisons. Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:testpromoter"

\end_inset

 lists the results. The sequence alignments can detect correctly the actual promoter pair in less than 16% of the 
\begin_inset Formula $278$
\end_inset

 genes (31% among the best 10 alignments).
\end_layout

\begin_layout Standard

Future experiments should be conducted in a genome-wide mode to verify the accuracy of TF-map alignments in larger datasets. However, the meta-alignment, at least in this set of 
\begin_inset Formula $278$
\end_inset

 gene pairs, was clearly superior to sequence alignment to detect the correct promoter region. In principle, we could be able with the TF-map alignments to accurately detect the promoter region in one species, scanning this genome with the orthologous promoter in the other informant genome.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 11: testPromoterRegion
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.75
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/testpromoter
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:testpromoterpgws
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment in promoter detection
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment in promoter detection.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Parallel meta-alignment: PGWS
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

meta-alignments!pgws@parallel
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

PGWS
\end_layout

\end_inset

 Let 
\begin_inset Formula $M$
\end_inset

 be a long genomic region of 
\begin_inset Formula $m$
\end_inset

 nucleotides. Let 
\begin_inset Formula $P$
\end_inset

 be a short genomic sequence of 
\begin_inset Formula $p$
\end_inset

 nucleotides, with 
\begin_inset Formula $m >> p$
\end_inset

. The problem of mapping and aligning the sequence 
\begin_inset Formula $P$
\end_inset

 to a contiguous set of windows in 
\begin_inset Formula $M$
\end_inset

 must be carefully analyzed to obtain in a reasonable amount of time that window from 
\begin_inset Formula $M$
\end_inset

 whose TF-map alignment to 
\begin_inset Formula $P$
\end_inset

 reaches the highest value. If 
\begin_inset Formula $p=500$
\end_inset

 bps, 
\begin_inset Formula $m=20,000$
\end_inset

 bps and the windows are 
\begin_inset Formula $500$
\end_inset

 bps with an overlap between adjacent windows of 
\begin_inset Formula $100$
\end_inset

 bps then the number of windows (that matches the number of pairwise TF-map alignments to do) is 50. Obviously, if the test is repeated for hundreds of gene pairs, the computation of the best windows requires some improvement.
\end_layout

\begin_layout Standard

In fact, the calculation of the TF-map alignment between 
\begin_inset Formula $P$
\end_inset

 and a given window from 
\begin_inset Formula $M$
\end_inset

 is independent from the rest of alignments. Thus, the alignments can be easily dispatched to different processors to be performed in parallel. At the end of the process, the scores of the alignments are ranked and displayed. Notice we are only interested in the score of the alignments to construct a ranking so the TFBSs that actually constitute them are logically not necessary in this case. Thus, we register the value calculated on each dynamic programming similarity matrix, but the paths of the alignments are not constructed.
\end_layout

\begin_layout Standard

Following with the same example: if there are 
\begin_inset Formula $10$
\end_inset

 available processors, we can divide uniformly the list of windows (alignments) among them using any offset schema to ensure the load of each processor is similar. For instance, if we consider an offset of 
\begin_inset Formula $4,000$
\end_inset

 bps between two windows that are processed by the same unit, we will assign the series of alignments 
\begin_inset Formula $(M_{0-500},M_{4000-4500},M_{8000-8500},M_{12000-12500},M_{16000-16500}$
\end_inset

 to the processor 
\begin_inset Formula $P_1$
\end_inset

, the series 
\begin_inset Formula $(M_{400-900},M_{4400-4900},M_{8400-8900},M_{12400-12900},M_{16400-16900}$
\end_inset

 to the processor 
\begin_inset Formula $P_2$
\end_inset

 and so on. The chronograph of events associated to this parallel processing is:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.75
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/chronogram
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

In this case, we can divide the sequential time 
\begin_inset Formula $T(n)$
\end_inset

 by the number of processors so that the parallel time is 
\begin_inset Formula $\frac{T(n)}{10}$
\end_inset

. We can then compute 
\begin_inset Formula $50$
\end_inset

 TF-map alignments with 
\begin_inset Formula $10$
\end_inset

 computers using the same amount of time that is necessary for calculating 
\begin_inset Formula $5$
\end_inset

 alignments in a single processor machine. As the same comparisons must be done for hundreds of genes, the save of time using this parallel version is considerable.
\end_layout

\begin_layout Standard

The program 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
prog{
\end_layout

\end_inset

pgws
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 (Promoter Genome-Wide Search) is a generalization of the schema presented here, in which the input consists of a list of probes 
\begin_inset Formula $P=p_1,p_2 \ldots p_{|P|}$
\end_inset

 (gene promoters from species 
\begin_inset Formula $A$
\end_inset

) and a list of long genomic sequences 
\begin_inset Formula $M=m_1,m_2 \ldots m_{|M|}$
\end_inset

 (chromosomes from species 
\begin_inset Formula $B$
\end_inset

). In an efficient parallel environment, the program 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
prog{
\end_layout

\end_inset

pgws
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 may be used, for instance, to locate the ortholog promoter of a chicken gene in the human genome.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset

[TF-map alignments in co-regulated genes]
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Using TF-map alignments to characterize promoter regions of co-regulated genes
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:cisred"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!cisred@in CISRED
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

meta-alignments!mcisred@in CISRED
\end_layout

\end_inset

 We expect, therefore, the map alignments to be particularly useful to characterize promoter regions of co-regulated genes in absence of sequence conservation. In such cases, the map alignments can help to recover conserved configurations of TFBSs that primary sequence comparisons would not. It is important to stress in this regard, that the match state in the alignment of TF-maps is defined based on the transcription factor label, and not based on the label of the specific binding site. Since a given TF can be associated to different binding sites (for instance, the approximately 90 TFBSs in the 
\shape smallcaps
HR set
\shape default
 correspond only to about 30 TFs), an alignment of TF-maps can include the alignment of TFBSs that show no sequence conservation.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 4
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.8}{
\end_layout

\end_inset


\begin_inset Graphics 
	filename ../tables/testpromoter.pdf
	clip
	BoundingBox 75 681 519 817

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:testpromoter
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Promoter identification with human-chicken TF-map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Promoter identification with human-chicken TF-map alignments.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The percentages are relative to the proportion of the 
\begin_inset Formula $278$
\end_inset

 human-chicken promoter pairs that score the highest in each window (or within the TOP 10). The correct promoter window is 
\begin_inset Formula $4,500-5,000$
\end_inset

. The 
\begin_inset Formula $50$
\end_inset

T collection are the 
\begin_inset Formula $50$
\end_inset

 more informative matrices from 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Many examples could be found in which map alignments produce a better characterization of the promoter region of co-regulated genes than that obtained through primary sequence alignments. We would like, however, to move beyond such an anecdotal evidence, and have a more exhaustive evaluation of the power of TF-map alignments to characterize promoter regions of co-regulated genes in absence of sequence similarity. Towards such a goal we have used the set of co-regulated genes in the CISRED database 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "robertson:2006a"

\end_inset

. The CISRED 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

CISRED
\end_layout

\end_inset

 database is primarily a collection of conserved regulatory sequence elements identified by a genome-scale computational system that uses pattern discovery, similarity, clustering, co-occurrence and co-expression calculations. CISRED includes, as well, a database of high-confidence co-expressed gene pairs 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "griffith:2005a"

\end_inset

, obtained from cDNA microarray hybridization, SAGE and other experiments, as well as Gene Ontology (GO, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "tgoc:2000a"

\end_inset

) analysis. Version 1 of CISRED high confidence co-expression human set contains 60,912 co-expression gene pairs for 5562 genes. Because of the criteria to establish co-regulation within CISRED, we do not expect strong bias towards co-expression pairs sharing strong sequence similarity in their promoter regions.
\end_layout

\begin_layout Standard

We have, thus, performed the following experiment (graphically represented in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cisred"

\end_inset

): we have compared the promoter region of each gene 
\begin_inset Formula $x$
\end_inset

 in the CISRED set with the promoter regions of the genes co-regulated with 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $coreg(x)$
\end_inset

, and with the promoter region of the genes no co-regulated with 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

. Even though the promoter of the gene 
\begin_inset Formula $x$
\end_inset

 may not show stronger sequence similarity with the promoters of the genes in 
\begin_inset Formula $coreg(x)$
\end_inset

 than with the promoters of the genes in 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

, our assumption is that it will still share some common regulatory signal (maybe very weak) with the promoters of the (at least a fraction of) the genes in 
\begin_inset Formula $coreg(x)$
\end_inset

, whereas no common signal will be shared between the promoter of 
\begin_inset Formula $x$
\end_inset

 and the promoters of the genes in 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

. Our hypothesis is therefore that alignments of TF-maps will be superior in detecting such signals to alignments of the primary nucleotide sequence.
\end_layout

\begin_layout Standard

We have proceed in the following way: we have used ENSMART to extract 500 nucleotides upstream of each gene in CISRED according to genome coordinates in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
ensembl
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

. We have used 500 nucleotides upstream here, instead of 200 nucleotides as before, because of the intrinsic imprecision of 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
ensembl
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

 when annotating the coordinates of the TSS. We obtained such a sequence for 5333 out of 5562 CISRED genes and considered it the promoter region of the gene. For this set of 5333 genes, 56,632 co-expression gene pairs are described in CISRED. We have used next the collection of matrices in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 (see previous section) to obtain the TF-maps of each promoter region. Then for each gene 
\begin_inset Formula $x$
\end_inset

 we have obtained the optimal map alignment with each gene in 
\begin_inset Formula $coreg(x)$
\end_inset

 and in 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

. We have used the enhanced TF-map alignment algorithm with the optimal parameters estimated in the training procedure. Finally, we have determined whether the scores of the map alignments between the promoter of gene 
\begin_inset Formula $x$
\end_inset

 and the promoters of the genes in 
\begin_inset Formula $coreg(x)$
\end_inset

 were significantly higher than the scores of the map alignments between the promoter of gene 
\begin_inset Formula $x$
\end_inset

 and the promoters of the genes in 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

. Because the scores of the optimal TF-maps alignments follow, as optimal sequence 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!dis@score distribution
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

meta-alignments!mdis@score distribution
\end_layout

\end_inset

 alignments, a Gumbel or extreme-value distribution (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:gumbel"

\end_inset

), we calculated the Wilcoxon test to assess this hypothesis. We obtained 42,756 non-void 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments and 20,600,640 non-void 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments. 4,784 genes in CISRED had non-void alignments for both the 
\begin_inset Formula $coreg(x)$
\end_inset

 and the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 sets . The average score of the 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments was 6.02, and the average length 2.13 sites. For the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments, the values were 5.57 and 2.06, respectively. For 97 genes, the score of the 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments was significantly higher than that of the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments at a significance level of p=0.01. At a p-value of 0.001, the number was 23. Since CISRED is partially based on microarray experiments, one could argue that cross-hybridization with recently duplicated genes may artefactually bias these results. However, no duplicated copies of genes exist in the sets of co-regulated genes with the 97 positive cases above.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 12: the CISRED experiment
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.75
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/cisred
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:cisred
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Alignment experiment with the CISRED genes
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Alignment experiment with the CISRED genes.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

We performed the same experiment, using BLASTN 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "altschul:1990a"

\end_inset

 instead to compare the promoter region of each gene 
\begin_inset Formula $x$
\end_inset

 in the CISRED set with the promoters of the genes in 
\begin_inset Formula $coreg(x)$
\end_inset

 and 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

. BLASTN was used with the parameters word size 7 and expectation value 10 so that short stretches of conservation could also be retrieved. In each comparison, we identified the score of the best HSP. We obtained 981 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments and 445,371 non-void 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments. 653 genes in CISRED had BLASTN alignments in both the 
\begin_inset Formula $coreg(x)$
\end_inset

 and the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 sets. The average score of the 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments was 29.9, and the average length 51 nucleotides. For the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments, the values were 24.3 and 40.5, respectively. For 11 genes, the score of the 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments was significantly higher than that of the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments at a significance level of p=0.01; there was only one gene for which the score of the 
\begin_inset Formula $coreg(x)$
\end_inset

 alignments was significantly higher than that of the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments, at a significance level of p=0.001.
\end_layout

\begin_layout Standard

We have investigated whether differences in conservation of regulatory elements could be found between promoters associated to CpG islands (CpG+) and promoters not associated to them (CpG-). CpG- promoters have been linked to tissue-specific expression patterns 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "smale:2003a"

\end_inset

, and therefore they could be overrepresented in the set of co-expressed genes for which we have been able to identify conserved regulatory motifs. We computed for each gene the GC content and the CpG score as defined by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "yamashita:2005a"

\end_inset

. The presence of a CpG island on a window (-100:+100) centered around the TSS of a gene is accepted when its GC content is greater than 0.5 and when its CpG score is greater than 0.6 (CpG+); otherwise they are classified as CpG negative genes (CpG-). Genes lacking CpG islands around their TSS have been shown to have a more tissue-specific expression pattern 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "yamashita:2005a"

\end_inset

. Based on these considerations, 3844 out of the 5333 promoters (72%) were identified as CpG+ genes, while only 1489 (28%) were classified as CpG-. Among the 97 genes for which the score of the 
\begin_inset Formula $coreg(x)$
\end_inset

 TF-map alignments was significantly higher than that of the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 alignments at a significance level of p=0.01, 63 were CpG+ (65%). At a p-value of 0.001, the number of CpG+ genes was 13, out of a total of 23 (56%). It, thus, indeed appears that genes with CpG- promoters are slightly overrepresented in the set of co-regulated genes with conserved (specific) regulatory signals.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 13: gumbel distributions
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="2">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.35
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset

,height=8cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/gumbel1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.35
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset

,height=8cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/gumbel2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:gumbel
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Score distribution of the CISRED TF-map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Score distribution of the CISRED TF-map alignments.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(Left) Distribution of the 
\begin_inset Formula $coreg(x)$
\end_inset

 TF-map alignment scores. (Right) Distribution of the 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 TF-map alignment scores.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

As it is possible to see, despite the general poor ability of both the sequence alignments and the TF-maps to uncover relationships between the promoters of the co-regulated genes in CISRED, it is clear that TF-map alignments are able to detect more relationships than BLASTN alignments (97 vs. 11 at a p-value 
\begin_inset Formula $<$
\end_inset

 0.01, 23 vs. 1 at a p-value 
\begin_inset Formula $<$
\end_inset

 0.001). It can be argued that this is partially an artefact, resulting from BLASTN reporting only sequence alignments over a given threshold, while non void TF-map alignments are always produced, provided that the maps to align share at least one common element. In fact, given the number of genes for which valid alignments are obtained, at a p-value 
\begin_inset Formula $<$
\end_inset

 0.01 there are twice as many cases in which 
\begin_inset Formula $coreg(x)$
\end_inset

 scores are significantly higher than 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 as expected if there was actually no difference in the distributions of scores, both using TF-map and sequence alignments. At a p-value 
\begin_inset Formula $<$
\end_inset

 0.001, however, the number of cases in which 
\begin_inset Formula $coreg(x)$
\end_inset

 scores are significantly higher than 
\begin_inset Formula $\overline{coreg}(x)$
\end_inset

 coincides with the expected value using BLASTN, but it is five times the expected value, using TF-maps. We believe that this indicates that, even after taking into account the effect of the different number of total alignments reported, the TF-map alignment algorithm is superior to BLASTN in detecting relationships between the promoter regions of co-regulated genes. Indeed, among the 445,371 total BLASTN alignments obtained, there are 981 alignments between co-regulated genes, while the 445,371 top scoring TF-map alignments obtained include 1240 alignments between co-regulated genes. Interestingly, there are only 148 alignments in common between both approaches, indicating that they could be used to complement each other.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 5
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset Graphics 
	filename ../tables/ttr.pdf
	clip
	BoundingBox 181 566 414 817

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:ttr
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Reconstruction of the TTR gene promoter
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

TF-map alignment reconstruction of the TTR gene promoter.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Summary of the TF-map alignments obtained between the promoter of the 
\emph on
transthyretin
\emph default
 gene (TTR, 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
ensembl
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

 entry ENSG00000118271) and the promoters of the genes co-regulated with it according to the CISRED database. The table lists the predicted transcription factors on the promoter of 
\emph on
transthyretin
\emph default
, which appear at least in five TF-map alignments with co-regulated genes. The experimentally verified sites are highlighted.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

It could be argued that the superiority of the TF-map over sequence alignments has little to do with the alignments and more to do with the maps. In other words, we would have obtained similar results if we were to simply score the proportion of TF labels common to the compared promoter regions --without the need for an alignment. Therefore, we have computed such a score for each pair of genes in CISRED: if 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $q$
\end_inset

 are the sets of elements in the TF-maps of the promoters to be compared, we have computed 
\begin_inset Formula ${|p \cap q|^2} / {|p| \cdot |q|}$
\end_inset

, where 
\begin_inset Formula $|p|$
\end_inset

 is the size (cardinality) of the set 
\begin_inset Formula $p$
\end_inset

. Among the 445,371 top scoring comparisons, 1072 corresponded to co-regulated genes (with only 394 gene comparisons in common with the TF-map alignment approach), a value intermediate between that obtained with sequence and with TF-map alignments. This reflects that conservation of the relative position of the TFs along the primary sequence, and not only common presence, is indicative of gene co-regulation. Conservation of relative position can only be captured by TF-map alignments.
\end_layout

\begin_layout Standard

As an example, Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ttr"

\end_inset

 summarizes the TF-map alignments obtained when aligning the promoter region of the 
\emph on
transthyretin
\emph default
 gene (TTR, 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
ensembl
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

 entry ENSG00000118271) with that of its co-regulated genes in CISRED. TTR is a serum carrier protein expressed in liver and brain. The regulatory regions that control the TTR expression in liver have been experimentally determined 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "costa:1989a"

\end_inset

, and consist of a 100-nucleotide enhancer located at -2000 nucleotides upstream of the TSS and a proximal promoter region between -200 and -90 nucleotides upstream of the TSS (relative to the coordinates in the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
ensembl
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

 entry). This proximal region is constituted of 6 binding sites (coordinates relative to TSS of the 
\emph on
transthyretin
\emph default
 gene as in the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
ensembl
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

 database): HNF-1 (-137,-109), HNF-3 (-140,-128 and -106,-91), HNF-4 (-151,-140), C/EBP binding (-195,-177 and -135,-112). The TATA box is located at -30. CISRED lists 105 genes co-regulated with TTR. Interestingly, while BLASTN is unable to detect any sequence similarity between the promoter of TTR and that of its co-regulated genes, TF-map alignments are obtained in 83 cases, and scored significantly (p-value 
\begin_inset Formula $<$
\end_inset

 0.001). We have reconstructed the structure of the TTR promoter from the elements that appear in the TF-map alignments. A total of 35 TFBSs were initially mapped with 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 in the TTR promoter. For each predicted TF, Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ttr"

\end_inset

 lists the number of TF-map alignments between TTR, and its co-regulated genes in which the TF appears. Only elements appearing in at least five alignments are reported. No matrices for the detection of C/EBP and HNF-4 were included in the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 collection that was used to perform the test. However, the meta-alignments were overrepresented in the other experimentally annotated sites, HNF-1, HNF-3 and TATA, exactly in the region were promoter activity has been reported (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ttrannot"

\end_inset

). The binding of HNF-3 to positions -140,-128 is not directly reported. The TF-map alignments, however, are highly enriched in the HFH-3 factor (HNF3/fork head homolog) at this region. In fact, both share a similar consensus binding sequence in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "matys:2003a"

\end_inset

: TRTTTRTTT for HFH-3 and TRTTTRYTT for HNF-3.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 14: TTR promoter
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.75
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/ttr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:ttrannot
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Experimental annotation of the TTR gene
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Experimental annotation of the TTR gene promoter.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Binding sites for activators that control transcription of the mouse 
\emph on
transthyretin
\emph default
 (TTR) promoter in hepatocytes are shown. Adapted from 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "lodish:2000a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Fast computing of all the CISRED TF-map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

For the results of this section, it was necessary to perform 
\begin_inset Formula $5,333 \times 5,333 = 28,440,889$
\end_inset

 pairwise TF-map alignments. These combinations can be represented into a similarity matrix that is addressed by the 
\begin_inset Formula $5333 \times 5333$
\end_inset

 CISRED gene promoter comparison indexes. As the similarity between two maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is equal to the similarity between 
\begin_inset Formula $B$
\end_inset

 and 
\begin_inset Formula $A$
\end_inset

, we only needed to compute 
\begin_inset Formula $\frac{5333 \times 5333}{2}$
\end_inset

 alignments (the other half of the matrix is symmetrical). The alignment between a gene and itself is also discarded. However, such a number of alignments is still too high to perform this test several times to evaluate different conditions in a reasonable amount of time.
\end_layout

\begin_layout Standard

Following the same strategy of the program 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
prog{
\end_layout

\end_inset

pgws
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 shown in the section before, we have divided the work load into different processors. Thus, we have assigned a part of the similarity matrix to each node taking. Let 
\begin_inset Formula $G=(g_1,g_2 \ldots g_{5333})$
\end_inset

 be the CISRED collection of gene promoters. A possible planning of tasks based on dividing such a matrix by rows into several parts may be: the alignments between the genes 
\begin_inset Formula $g_1 \ldots g_{1000}$
\end_inset

 and all of the genes for a first processor; the alignments between the genes 
\begin_inset Formula $g_{1000} \ldots g_{3000}$
\end_inset

 and all of the genes for a second processor; the alignments between the genes 
\begin_inset Formula $g_{3000} \ldots g_{5333}$
\end_inset

 and all of the genes for a third processor.
\end_layout

\begin_layout Standard

The number of assigned rows is different for each processor as the number of alignments that must be computed for a row is different depending on the part of the matrix is located. For a given row 
\begin_inset Formula $g_i$
\end_inset

 in the matrix, only the alignments between such a gene and the genes 
\begin_inset Formula $g_{i+1} \ldots g_{5333}$
\end_inset

 must be performed.
\end_layout

\begin_layout Standard

After this process, each alignment between two gene promoters 
\begin_inset Formula $g_i$
\end_inset

 and 
\begin_inset Formula $g_j$
\end_inset

 is classified into 
\begin_inset Formula $coreg(g_i)$
\end_inset

 or 
\begin_inset Formula $\overline{coreg}(g_i)$
\end_inset

 whether the pair 
\begin_inset Formula $(g_i,g_j)$
\end_inset

 is co-regulated or not according to the CISRED collection.
\end_layout

\begin_layout Standard


\begin_inset Newpage clearpage
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset

[TF-map alignments and matrix specificity]
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

TF-map alignments and matrix specificity
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:matrices"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

position weight matrices!spe@specificity
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Throughout this chapter, we have used in many experiments smaller subsets of the full collections of matrices (e.g. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

). This fact was explained because of the poor specificity of many of these matrices in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 or 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

. Several theoretical and practical studies have concluded there is a great amount of redundancy in these collections 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "rahmann:2003a,schones:2005a"

\end_inset

. In this section, we have numerically explored the specificity of current matrices, using the TF-map alignment to obtain similar conclusions.
\end_layout

\begin_layout Standard

Position Weight Matrices (PWMs, see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

 and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pwmsnew"

\end_inset

 for a review) have been traditionally used to characterize families of TFBSs. New sequences can be analyzed with this model in order to locate putative occurrences of the represented regulatory element. However, the ambiguous nature and the short length of the binding sites usually induce an overwhelming amount of false positive predictions in the searching process.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 15: PWMs construction and use
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.65
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/pwmsnew
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:pwmsnew
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Construction and use of a PWM
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Construction and use of a PWM.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(1) Collect a family of experimentally verified binding sites. (2) Align the sites to find conservations (anchored alignment). (3) Build a weight matrix representation of the alignment: Determine the optimal length; Define a Threshold value; Using a background model, construct the likelihood ratio matrix. (4) Search new occurrences of this signal in other sequences.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

High conservation in certain positions of a PWM may be relevant for the activity of the site. Base frequencies may be proportional to the binding energy contribution of the bases. The information content of a PWM introduced in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

 can be used as a estimation of its specificity. However, this fact is not always true.
\end_layout

\begin_layout Standard

To determine the specificity of current weight matrix models in a genome-wide scale, we have used protein-coding sequences (CDS) as a negative control. No TFBSs are expected to be functional in the CDS regions. For the 21,538 genes in the UCSC hg17 human genome release, we have extracted 500 nucleotides upstream the TSS (PROMOTER samples) and 500 nucleotides downstream the Start Codon (CDS samples).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 16: PWMs QVAL
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

JASPAR
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

TRANSFAC
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.45
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/qmat1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.45
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/qmat2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:qmatrices
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset Formula $Q-$
\end_inset

value distribution in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset Formula $Q-$
\end_inset

value distribution in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

In red, the matrices that produced more predictions in the CDSs; in green, the matrices that produced more predictions in the promoters.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

For each matrix 
\begin_inset Formula $x$
\end_inset

 in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 1.0 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 6.3, we obtained the number of predicted TFBSs in both sets of human samples (Threshold = 0.80): 
\begin_inset Formula $f_{\textnormal{\scalebox{0.5}{PROM}}}(x)$
\end_inset

 and 
\begin_inset Formula $f_{\textnormal{\scalebox{0.5}{CDS}}}(x)$
\end_inset

. Next, we define the function 
\begin_inset Formula $Q$
\end_inset

 as the log-likelihood ratio between both numbers:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

Q(x) = log{~~ 
\backslash
frac{f_{
\backslash
textnormal{
\backslash
scalebox{0.5}{PROM}}}(x)}{f_{
\backslash
textnormal{
\backslash
scalebox{0.5}{CDS}}}(x)}}.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:qmatrices"

\end_inset

, the distribution of the PWMs in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 according to this measure is shown. Not surprisingly, 40% of the 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 matrices (37% in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

) produced even more predictions in the CDS sequences than in the actual promoter regions (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:qmatrices"

\end_inset

). For different values of 
\begin_inset Formula $Q$
\end_inset

, more strict sets of matrices can be obtained, as shown in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:qmatrices"

\end_inset

.
\end_layout

\begin_layout Standard

The test we performed on the 
\shape smallcaps
HR set
\shape default
 (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:testregions"

\end_inset

) showed that TF-map alignment could distinguish two orthologous promoters better than any other pair of orthologous genomic samples, even with lower sequence similarity (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:testregions"

\end_inset

 for further details). 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 was used as a mapping function, because the 
\begin_inset Formula $50$
\end_inset

 most informative matrices in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 were supposed to be the more specific. In fact, we can now quantify the optimal number of matrices (and which matrices) to achieve the maximum discrimination power, using the 
\begin_inset Formula $Q$
\end_inset

-value function.
\end_layout

\begin_layout Standard

As we are going to align human-mouse pairs, we have also computed the 
\begin_inset Formula $Q$
\end_inset

-value using the mouse genome (17,213 genes, mm5) for the complete collection of matrices in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

, following the procedure explained above for the human genes. For each 
\begin_inset Formula $Q$
\end_inset

-value, we have intersected the subset of matrices according to the human and the mouse genomes. Then, we have repeated the test detailed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:testregions"

\end_inset

 using these different sets of matrices. The test with the full collections was also performed to compare against the smaller subsets.
\end_layout

\begin_layout Standard

Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:qmatrices2"

\end_inset

 lists the number of times each genomic region (promoter, 5'UTR, CDS, intronic, intergenic, downstream) scores the highest in each gene of the 
\shape smallcaps
HR set
\shape default
 using each subcollection of matrices. It is remarkable that the 
\begin_inset Formula $Q \geq 0.5$
\end_inset

 in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

, with only 
\begin_inset Formula $16$
\end_inset

 matrices, identified correctly 
\begin_inset Formula $20$
\end_inset

 of the promoter pairs. Notice the poor performance when we used the full 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 collection. In fact, the results do not improve when we add or remove other matrices to the optimal subset of matrices. Similar results are obtained when we used 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

. The optimal collections are listed in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:qcollections"

\end_inset

. In both cases, the majority of the matrices are the most informative. Despite this, some significant matrices with a small information content are also included in both optimal sets (e.g. the SP1 matrix in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

). As in the previous test, we performed the global alignment to show the sequence similarity of each sample pair with the program 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
prog{
\end_layout

\end_inset

needle
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 of the EMBOSS software 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "olson:2002a"

\end_inset

.
\end_layout

\begin_layout Standard

Finally, it is important to mention that the subset of matrices that we arbitrarily selected in the original test (
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

, see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:testregions"

\end_inset

) obtained slightly better results than the optimal set estimated with the 
\begin_inset Formula $Q$
\end_inset

-value method. This subset, however, only have 16 matrices, while 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 is constituted of 
\begin_inset Formula $50$
\end_inset

 matrices.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 6
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.85}{
\end_layout

\end_inset


\begin_inset Graphics 
	filename ../tables/qvalue.pdf
	clip
	BoundingBox 74 775 522 816

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:qmatrices
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Formula $Q$
\end_inset

-value and PWM matrix specificity
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Formula $Q$
\end_inset

-value and PWM matrix specificity in 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Several conclusions can be extracted, therefore, from this simple test: 
\end_layout

\begin_layout Enumerate

Up to 40% of the matrices from popular matrices repositories are prone to predict the same number of TFBSs either in human promoters or in protein coding sequences. Therefore, analysis with these models must be very carefully evaluated. 
\end_layout

\begin_layout Enumerate

Although a high information content normally implies better specificity of the matrices, there are cases in which both characteristics are not related. 
\end_layout

\begin_layout Enumerate

The use of complete collections to analyze homologous promoters usually produces the recognition of artefactual sequence conservations as shown when the matrices are applied on protein coding regions or intron sequences. 
\end_layout

\begin_layout Enumerate

To locate the actual common regulatory elements in a set of co-expressed sequences, it is advisable to restrict the search using smaller collections of matrices. A simple procedure to detect those matrices that consistently appear more frequently in a set of co-regulated genes than in a negative control set can provide interesting results. 
\end_layout

\begin_layout Enumerate

Many of the numerous drawbacks of the weight matrices such as redundancy and low specificity are caused by the simplicity of the model. Therefore, the use of more complex models to incorporate additional information will obviously improve future predictions. However, we also suggest a more rational application of the current systems to enhance the advantages and to mask the inconveniences of these representations. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 7
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.75}{
\end_layout

\end_inset


\begin_inset Graphics 
	filename ../tables/qvalue2.pdf
	clip
	BoundingBox 115 574 480 817

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:qmatrices2
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Evolution of the matrix specificity
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Matrix specificity in several subsets of 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
sectiongreen{Meta-alignment in other scenarios}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%- IMPORTANTE: Este es un algoritmo generico que procesa cualquier tipo de informacion
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%- hacer pruebas sobre ejemplos de datos en otros ambitos: AFIS, comparar otro tipo de mapas,
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%comparacion de imagenes para extraer patrones????
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Local TF-map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

TF-map alignments!loctf@local
\end_layout

\end_inset

 Local alignments are very useful to identify short stretches of a sequence that are conserved in another one, despite the rest of both sequences is probably different. Local comparisons are also interesting mechanisms to locate the location (if any) of a short composite (cluster of TFBSs, a super-pattern of TFBSs) in a long TF-map (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ttrc"

\end_inset

).
\end_layout

\begin_layout Standard

Two alternative designs were presented in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

 (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:local"

\end_inset

) to implement a sequence local alignment according to the scoring function: similarity or distance. Based on them, we present here two different implementations to identify local meta-alignments between two TF-maps.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Local TF-map alignments using similarity
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In a short communication, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981c"

\end_inset

 published a slight modification of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm, as revisited by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

, to deal with local alignments. The main objective is to find the pair of segments, one from each of two long sequences, such that there is no other pair of segments with greater similarity (homology).
\end_layout

\begin_layout Standard

The basic rationale of this strategy is the following: let 
\begin_inset Formula $S(i,j)$
\end_inset

 a position in the dynamic programming matrix. The best local alignment ending at 
\begin_inset Formula $S(i,j)$
\end_inset

 is computed according to the three adjacent values in the matrix 
\begin_inset Formula $S$
\end_inset

 as long as the incorporation of one of these elements does not produce an alignment with negative homology. In that case, the score of the alignment ending at 
\begin_inset Formula $S(i,j)$
\end_inset

 is set to 
\begin_inset Formula $0$
\end_inset

. The traceback procedure then starts from the matrix cell having the maximum similarity, constructing the best local alignment until a cell that contains a 
\begin_inset Formula $0$
\end_inset

 is reached.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% TABLE 8
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "98line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.8}{
\end_layout

\end_inset


\begin_inset Graphics 
	filename ../tables/qcolls.pdf
	clip
	BoundingBox 82 578 518 817

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:qcollections
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 specific subsets
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 specific subsets.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

In red, the matrices that are not among the most informative ones.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The application of this approach to the meta-alignment is trivial. We can rewrite the Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eqnaive"

\end_inset

 introducing the 
\begin_inset Formula $0$
\end_inset

 in the appropriate place to produce the local alignment. Thus, the maximum local similarity 
\begin_inset Formula $S_{ij}$
\end_inset

 between TF-maps 
\begin_inset Formula $A = a_1 \ldots a_i$
\end_inset

 and 
\begin_inset Formula $B = b_1 \ldots b_j$
\end_inset

 where the site 
\begin_inset Formula $a_i^f$
\end_inset

 is equal to the site 
\begin_inset Formula $b_j^f$
\end_inset

, can be computed as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{lllll}
\end_layout

\begin_layout Standard

S_{ij} 
\backslash
equiv & S(a_i,b_j) = & max 
\backslash
{0,& 
\backslash
alpha (a_i^s + b_j^s) +& 
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & &  max_{i',j'} & 
\backslash
{S_{i'j'}
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$0 < i' < i$}} & - 
\backslash
lambda (i - i' - 1 + j - j'- 1)
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$0 < j' < j$}} & - 
\backslash
mu (|(a_i^{p_1} - a_{i'}^{p_1}) - (b_j^{p_1} - b_{j'}^{p_1})|)
\backslash
}
\backslash
}.
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$a_{i'}^{p_2} < a_i^{p_1}$}} & 
\backslash

\backslash

\end_layout

\begin_layout Standard

              & & & 
\backslash
scalebox{0.7}{
\backslash
mbox{$b_{j'}^{p_2} < b_j^{p_1}$}} &
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
label{eqlocal}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

If we save the 
\begin_inset Formula $N$
\end_inset

 positions in 
\begin_inset Formula $S$
\end_inset

 that have the best score, we can report the best 
\begin_inset Formula $N$
\end_inset

 local alignments or blocks between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

. The cost of the algorithm is the same as in the global TF-map alignment algorithm, as no additional operations are necessary.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Local TF-map alignments using distance
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Despite the solution to the problem of local meta-alignment using similarity is simple and clear, we also decided to investigate the form to produce local alignments under the original distance scheme framework 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1984c"

\end_inset

. We have taken advantage of this research to study in depth the distribution of the scores (distance) in the meta-alignments.
\end_layout

\begin_layout Standard

As reviewed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithms"

\end_inset

 (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "localdist"

\end_inset

) the solution developed by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981c"

\end_inset

 to produce local alignments using a similarity scoring function can not be directly applied in the case of the distance metric. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "goad:1982a"

\end_inset

 defined the mismatch density of the alignment between two segments as the ratio of the minimum distance 
\begin_inset Formula $D$
\end_inset

 between both sequences and the length 
\begin_inset Formula $L$
\end_inset

 of such an alignment. Thus, only those alignments with a mismatch density below a certain positive threshold 
\begin_inset Formula $T$
\end_inset

 should be reported.
\end_layout

\begin_layout Standard

Formally, we are interested in those paths in the dynamic programming distance matrix such that the mismatch density on them is minimal. The length of these alignments is a priori unknown and can be variable. The value of the threshold 
\begin_inset Formula $T$
\end_inset

 is different for each input, having a statistical and biological meaning at the same time.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 17: GFF2PS: localizar un patron en una entrada
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.7
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/ttrc
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:ttrc
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Using local meta-alignment in pattern identification
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Using local meta-alignment to identify known patterns in orthologous sequences.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(Top) TF-map obtained with 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset Formula $_{TOP50}$
\end_inset

 on the chicken promoter of the TTR gene, and a second map of three experimentally verified TFBSs in the human ortholog. (Bottom) The local alignment between both maps identifies the putative location of the human sites in chicken.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

This is the procedure we follow to obtain the local meta-alignment between two maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:locprot"

\end_inset

):
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Compute the global alignment of both maps (distance metrics), to fill the dynamic programming matrix 
\begin_inset Formula $D$
\end_inset

 in. Each position 
\begin_inset Formula $D(i,j)$
\end_inset

 contains the minimum distance in terms of a meta-alignment between the map 
\begin_inset Formula $A = a_1 \ldots a_i$
\end_inset

 and the map 
\begin_inset Formula $B = b_1 \ldots b_j$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Compute the matrix 
\begin_inset Formula $\Delta D$
\end_inset

 from 
\begin_inset Formula $D$
\end_inset

. For each two consecutive nodes in the matrix 
\begin_inset Formula $D(i,j)$
\end_inset

 and 
\begin_inset Formula $D(i',j')$
\end_inset

 that are part of a path, we compute the increase of the distance value produced by adding the second match after the first one:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
Delta D(i,j) = D(i,j) - D(i',j') ~
\backslash
mbox{where}~ i' < i, j' < j.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Define the threshold 
\begin_inset Formula $T$
\end_inset

 according to the 
\begin_inset Formula $\Delta D$
\end_inset

 values in the alignments of length 
\begin_inset Formula $L=2$
\end_inset

 TFBSs. We define this threshold taking into account that the distribution of the distance in such alignments follows the Gumbel or extreme-value distribution (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:glocal"

\end_inset

). The Gumbel function is defined as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

y = e^{-x-e^{-x}} ~
\backslash
mbox{where}~ P(x<0) = 0.368, P(x>0) = 0.632.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

We are interested in defining 
\begin_inset Formula $T$
\end_inset

 such that a small fraction of the smallest values is selected. The normalization of a Gumbel function is computed as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

z = 
\backslash
lambda (x - 
\backslash
mu) ~
\backslash
mbox{where}~ 
\backslash
lambda = 
\backslash
frac{1.285}{
\backslash
sigma}, 
\backslash
mu = 
\backslash
overline{x} - 0.45 
\backslash
sigma.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset Formula $\overline{x}$
\end_inset

 and 
\begin_inset Formula $\sigma$
\end_inset

 are the mean and the deviation of the distance values computed for the current set of paths, respectively. If we are considering the values 
\begin_inset Formula $P(z \leq Z) = 0.05$
\end_inset

, that is under 5% of the area covered by 
\begin_inset Formula $z$
\end_inset

, then:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{c}
\end_layout

\begin_layout Standard

z = 
\backslash
frac{1.285 
\backslash
cdot x - 1.285
\backslash
cdot 
\backslash
overline{x} -1.285 
\backslash
cdot 0.45 
\backslash
sigma}{
\backslash
sigma}
\backslash

\backslash

\end_layout

\begin_layout Standard

G(P) = -ln (ln (
\backslash
frac{1}{p}) ~
\backslash
mbox{where}~ p = 0.05, 
\backslash
mbox{(value of $z$)}.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

For each alignment input, we will have a different 
\begin_inset Formula $\overline{x}$
\end_inset

 and 
\begin_inset Formula $\sigma$
\end_inset

 values that, according to this equation, will provide a threshold 
\begin_inset Formula $T$
\end_inset

 to obtain only the 5% of the minimal distance alignments of length 
\begin_inset Formula $2$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Finally, trace back the paths ending at each match in the 
\begin_inset Formula $\Delta D$
\end_inset

 matrix. The rule to extend a local alignment takes into account a weighted version of the mismatch density value. A new match is added to the path if the accumulated distance is below 
\begin_inset Formula $T$
\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
frac{
\backslash
Delta D(i,j)}{l} < T
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula $l$
\end_inset

 is the length of the current local alignment path. Visited nodes are marked up to be skipped in future path extensions (avoid overlapping of the solutions). 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 18: Protocol for local alignment (D)
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

height=4cm,width=0.3
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/posterloc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

height=4cm,width=0.3
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/posterloc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

height=4cm,width=0.3
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/posterloc3
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:locprot
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Local meta-alignment using the distance metric
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Local meta-alignment using the distance metric
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(1) Global alignment of both maps. (2) Compute the 
\begin_inset Formula $\Delta D$
\end_inset

 matrix for 
\begin_inset Formula $L=2$
\end_inset

. (3) Extend the best local paths with the score below 
\begin_inset Formula $T$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectiongreen
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Discussion
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Much of the biology of the past decades has been based on the technological advances that have accelerated our ability to sequence DNA and proteins. It is certainly in the sequence of the genome where the biological traits of organisms are encoded. While we have a relatively good understanding of some of the basic mechanisms involved in the processing of the information encoded in the DNA sequence, it is in general very difficult to predict the biological traits --even at the molecular level-- from the nucleotide sequence alone. Gene promoters are a case in point: while the sequence of the promoter is likely to contain most of the information to control the expression of a gene, it is currently impossible to predict the expression pattern of a gene from the analysis of its promoter sequence alone.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 19: Gumbel distribution
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="2">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

height=8cm,width=0.45
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/gumbelloc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

height=8cm,width=0.45
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/gumbelloc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:glocal
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Gumbel distribution of local meta-alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Gumbel distribution of local meta-alignments.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(Left) The Gumbel generic function. (Right) TF-map alignment scores in a real pair of promoters.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

While inferring function directly from sequence is thus far from trivial, it is still true, that because sequence encodes function, similar sequences often encode similar functions. Sequence comparisons, therefore, are an extraordinary tool to infer functional relationships: through sequence comparisons the function of known sequences can be extrapolated to newly obtained ones, and the specific sequence motifs can be identified responsible for the common functionality of a set of sequences. But sequence comparisons have limitations: often similar functions are encoded by diverse sequences. Again, gene promoters are a case in point: many TFs bind to sequence motifs which do not show sequence conservation. Thus, while through phylogenetic footprinting, conserved regulatory motifs have been in occasions uncovered in the promoters of orthologous genes 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "blanchette:2002a,lenhard:2003a"

\end_inset

, searching for common patterns through the comparison of promoter sequences in sets of co-regulated genes --as, for instance, those resulting from microarray experiments-- is usually a frustrating exercise.
\end_layout

\begin_layout Standard

Here, we have attempted to address this limitation implicit in sequence comparisons, by annotating the primary sequence with predicted functional domains, comparing the resulting annotations instead of the underlying primary sequence. If functional domains are encoded by diverse sequences, the comparison and alignment of the annotation may be more revealing of the functional relationships between sequences and of the specific domains involved in the common functionality than the comparison and alignment of the primary sequence. In particular, we have attempted this strategy for the comparison and characterization of promoter regions from genes with similar expression patterns. We have annotated the sequence with predictions of TFBSs --using a variety of popular tools and databases-- and identified the predicted sites with the labels of the corresponding TFs. We have then compared and aligned the resulting sequence of labels. Because TFs can bind to sites that show no sequence conservation, their labels can be aligned which correspond to domains that, while exhibiting similar functions, may not show sequence conservation.
\end_layout

\begin_layout Standard

Precedents of this approach can be found in the literature. 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "quandt:1996a"

\end_inset

, for instance, distinguish explicitly between first-level analysis of promoters, in which the nucleotide sequence is directly interrogated for the presence of regulatory motifs, and second-level methods, in which basic higher order patterns can be defined from a number of correlated first-level units. This approach is further developed in 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "frech:1997a"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "klingenhoff:1999a"

\end_inset

, where more complex composite patterns are derived capturing the functional organization of individual regulatory elements, and are then used to identify and characterize related promoter regions in absence of sequence conservation. Here, we go one step further, and infer automatically the composite patterns by explicitly aligning the sequences of labels corresponding to TFs for which binding sites have been predicted in the compared promoters (the second-level annotation).
\end_layout

\begin_layout Standard

To align these sequences of labels--to which we refer as TF-maps-- we have stated the problem as a restriction enzyme map alignment, and adapted a dynamic programming algorithm developed by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

. This algorithm, as well as ours, belong to a larger class of map alignments algorithms (see also, 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "miller:1990a,miller:1991a,myers:1992a,huang:1992a"

\end_inset

). In typical alignments, the sequences are of labels denoting either nucleotides or amino acids. In map alignments, the sequences are of pairs (label,integer), where the label denotes a predicted domain or site (possibly exhibiting some behavior or functionality), and the integer the position on the primary sequence where the domain or the site has been predicted. In global pairwise sequence alignments, the goal is to obtain the alignment that maximizes the sum of the scores of the aligned positions --given the score of the individual alignments of all possible pairs of labels. In contrast, in map alignments, only positions with identical labels can be aligned and the goal is to obtain the largest common subsequence constrained to minimize the differences in distances on the primary sequence between consecutive aligned positions. Sequence and map alignments can be generalized to a broader class of alignments that includes both.
\end_layout

\begin_layout Standard

Map alignments have been mostly used to align restriction enzyme maps. In this case, the label denotes a restriction enzyme, and the integer the position on the primary sequence of the site recognized by the enzyme. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 first established the concept of map alignment and provided an algorithm for computing the optimal alignment of two maps. Later 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

 described an improved algorithm to efficiently find map alignments which relies on the extreme sparsity of the dynamic programming matrix in 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1984c"

\end_inset

 --the result of the match state being defined only between identical labels. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "miller:1990a,miller:1991a"

\end_inset

 introduced new algorithms that permitted the efficient search of a long map for the best matches to a shorter probe map. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "huang:1992a"

\end_inset

 generalized these algorithms to deal with different map errors.
\end_layout

\begin_layout Standard

In our case, the label denotes a TF, and the integer the initial position on the primary sequence where a binding motif for the TF has been predicted. There are, however, two important differences between restriction enzyme maps and TF-maps. First, while prediction of restriction sites is deterministic, producing a binary output (
\begin_inset Quotes eld
\end_inset

site
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

no site
\begin_inset Quotes erd
\end_inset

), prediction of TFBSs is often probabilistic and predicted sites may have an associated score. The score can usually be related to the strength of the binding of the TF to the site 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "stormo:2000a"

\end_inset

. Since, it makes sense, therefore, to prefer in TF-map alignments higher scoring sites, the score of the TFBSs needs to be taking into account when building optimal TF-map alignments. Second, enzyme restriction sites are single-nucleotide positions on the primary sequence. TFBSs, in contrast, are sequence intervals, and have thus, in addition to position, an associated length. Because we explicitly prohibit overlap between aligned elements, we can not directly extrapolate the algorithm of 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

. However, as in their approach, we have also taken advantage of the extreme sparsity of the dynamic programming matrix to implement an efficient algorithm that, in our experience, is comparable in efficiency. There is another important feature characteristic of our approach that, while it does not influence the algorithmic strategy, it is essential to its success. As we have already stressed, we do not label the site, but the function of the site. That is, we do not label the TFBSs, but the TFs that bind to the sites. This allows for significant functional alignments even in the absence of sequence conservation.
\end_layout

\begin_layout Standard

We have estimated the optimal parameters of the algorithm in a small, but well annotated, set of orthologous human-mouse genes. We used three popular collections of PWMs for TFBSs (
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 1.0 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "sandelin:2004a"

\end_inset

, 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Promo
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 2.0 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "farre:2003a"

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Transfac
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 6.3 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "matys:2003a"

\end_inset

) to obtain the TF-maps of the promoter sequences. Results on this data set indicate that, by dramatically reducing the overwhelming number of spurious predictions of TFBSs produced using these collections, TF-map alignments are able to successfully uncover the few conserved functionally active regulatory domains. Differences can be observed between the performance of the different collections of TFBSs; alignments obtained using 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
db{
\end_layout

\end_inset

Jaspar
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 --and, in particular, using a subset consisting of the 50 top most informative matrices-- appear to show the optimal balance between sensitivity and specificity. The data set that we have used, however, is too small to infer general trends on the comparative behavior of these collections.
\end_layout

\begin_layout Standard

Interestingly, despite the stronger sequence conservation between protein-coding regions, TF-map alignments score the highest between promoter regions in the training set of orthologous human-mouse genes. This indicates that TF-map alignments are able to pick up regulatory signals that sequence alignments can not. Results in an independent larger data set of co-regulated genes from the CISRED database are also in support of this conclusion: we have been able to obtain more significant alignments between the TF-maps than between the nucleotide sequences of the promoters of co-regulated genes. Results in CISRED are certainly not extraordinary. Both sequence and TF-map alignments perform very poorly when detecting relationships between co-regulated gens in CISRED. Only in 97 out of 5333 gene representatives in CISRED (1.8%), TF-map alignments scored significantly higher for co-regulated than for non co-regulated genes. Using BLASTN, this number was only 11 (0.2%). Finding relationships between the promoters of the genes co-regulated in CISRED is a task as challenging as one can imagine. The CISRED collection of high-confidence co-expressed genes is not derived from overall conservation, or from co-occurrence of motifs, in the sequence of the gene promoters. CISRED co-expression is derived instead from cDNA microarray, SAGE and other high-throughput gene expression monitoring techniques. CISRED co-expression clusters are thus a mixture of directly and indirectly co-regulated genes and one would then expect only a few genes within each cluster --maybe in a few subsets-- to share functionally equivalent motifs in their promoter sequences. The poor performance of TF-map alignments, however, could also be reflecting the incompleteness of the current collections of TFBSs, and how little we know of the molecular rules governing the expression of human genes.
\end_layout

\begin_layout Standard

On the other hand, while building global pairwise alignments maybe appropriate to compare promoter sequences of orthologous human-mouse genes, to compare sequences from multiple genes weakly co-regulated --such as those in CISRED-- multiple and/or local alignments may be more effective in capturing the functional motifs underlying co-expression. Indeed, from a multiple TF-map alignment of promoters of a set of co-regulated genes, a 
\begin_inset Quotes eld
\end_inset

transcriptional regulatory super-pattern
\begin_inset Quotes erd
\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

super-pattern
\end_layout

\end_inset

 can be derived capturing those elements conferring expression specificity. Using a local alignment search algorithm, the super-pattern can then be used to identify additional genes or transcripts belonging to the same expression class (see other approaches in 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "knight:1995a"

\end_inset

).
\end_layout

\begin_layout Standard

Even more appropriate to the analysis of sets of weakly co-expressed genes (that is, including genes both directly and indirectly co-regulated), such as those in the CISRED clusters, would be the extension of the unsupervised pattern recognition techniques usually applied to motif discovery in DNA sequences (in programs such as MEME 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "bailey:1994a"

\end_inset

, AlignAce 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "roth:1998a"

\end_inset

 and others (see 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "tompa:2005a"

\end_inset

, for a recent comparative evaluation) to motif discovery in TF-maps. This would allow for the identification within a co-expression cluster of different 
\begin_inset Quotes eld
\end_inset

transcriptional regulatory super-patterns
\begin_inset Quotes erd
\end_inset

. These super-patterns, in turn, and the subclusters they induce, could contribute to sort out direct vs. indirect co-regulation effects within the cluster. These and other extensions to the TF-map alignments (for instance, those allowing to deal with non-colinear arrangements of TFBSs that have been indeed observed in orthologous genes, see next chapter) are all feasible, and will certainly contribute to the discriminatory power of TF-map comparisons and alignments.
\end_layout

\begin_layout Standard

In summary, our results suggest that comparisons of annotations of higher order domains can, in occasions, be more meaningful to characterize the underlying functionality of sequences, than direct comparisons at the very primary sequence level. Here we have explored these strategies for the characterization of the promoter regions of co-regulated genes, and we have annotated the primary sequence of them with predictions of TFs. Moreover, we have also used the discriminative power of TF-maps for a better identification of orthologous promoter regions along large genomic sequences (e.g. chromosomes). In addition, we measured the specificity of PWMs in protein coding sequences and promoters.
\end_layout

\begin_layout Standard

However, we can imagine similar strategies to address many other problems in sequence analysis. One can imagine, for instance, annotating protein sequences with PFAM domains 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "bateman:2004a"

\end_inset

, and compare the resulting annotations to detect distant functional relationships between proteins and protein families. Or annotating genome sequences with the Gene Ontology (GO, 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "tgoc:2000a"

\end_inset

) labels of the genes encoded in these sequences, and aligning the GO labels to detect clusters of conserved functions across genomes. In fact, the annotation of the primary sequence with higher order domains to improve alignments has been often explored. For instance, to compare protein secondary structures, or to anchor whole genome alignments 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "batzoglou:2000a"

\end_inset

, or even alignments of promoter regions 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "berezikov:2004a"

\end_inset

. In all these cases, however, the ultimate goal is to obtain an optimal sequence alignment either between the original primary sequences, or between the 1-1 mappings of the primary sequence into a reduced alphabet (for instance, denoting secondary structure elements). We believe that, as the molecular functionality of the primary sequence becomes better understood, comparisons between higher order annotations, such as those performed here, in which the primary sequence is completely abstracted, may become increasingly relevant.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% References for this chapter
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% ENCERRAR ENTRE LLAVES PARA EVITAR PROBLEMAS
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
bibliographystyle{plainnat}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "sections/bibliography"

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_body
\end_document
