#LyX file created by tex2lyx 2.0.4
\lyxformat 413
\begin_document
\begin_header
\textclass book
\use_default_options false
\language english
\language_package default
\inputencoding auto
\fontencoding T1
\font_roman charter
\font_sans helvet
\font_typewriter courier
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\paperfontsize default
\spacing single
\use_hyperref 1
\pdf_bookmarks 1
\pdf_bookmarksnumbered 0
\pdf_bookmarksopen 0
\pdf_bookmarksopenlevel 1
\pdf_breaklinks 1
\pdf_pdfborder 0
\pdf_colorlinks 1
\pdf_backref section
\pdf_pdfusetitle 1
\pdf_quoted_options "pdftex,setpagesize=true,pdfhighlight=/P,linktocpage=true,plainpages=false,linkcolor=blue,%
anchorcolor=yellow,%
citecolor=green,%
menucolor=cyan,%
pagecolor=red,%
urlcolor=magenta"
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 0
\use_mathdots 0
\cite_engine natbib_authoryear
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle fancyplain
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

% The golden age of sequence analysis
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Chapter


\begin_inset Argument
status collapsed


\begin_layout Standard

The golden age of sequence analysis
\end_layout

\end_inset


\series bold
T
\series default
he golden age
\begin_inset Newline newline
\end_inset

of sequence analysis
\end_layout

\begin_layout Standard


\begin_inset CommandInset label
LatexCommand label
name "sec:algorithms"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange*
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Summary
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\align center


\begin_inset Tabular 
<lyxtabular version="3" rows="3" columns="1">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{blue}{verylightgrey}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][4cm][c]{0.8
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
sffamily
\end_layout

\begin_layout Standard

%abstract 
\end_layout

\begin_layout Standard

This chapter aims to be a historical survey of the sequence comparisons algorithms analyzing the most 
\end_layout

\begin_layout Standard

relevant solutions. The algorithms that represented innovative changes in the field are described in detail,
\end_layout

\begin_layout Standard

covering the concepts of global, local and multiple alignment of sequences. In addition, the theoretical 
\end_layout

\begin_layout Standard

framework of the map alignment problems necessary to understand the rest of work presented in this thesis 
\end_layout

\begin_layout Standard

is also formalized here.
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

[2ex] 
\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "110line%"
special "none"
height "4cm"
height_special "none"
status open


\begin_layout Plain Layout

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
minitoc
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Foundations of sequence comparison
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:history"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
lettrine
\end_layout

\end_inset

[lines=4,loversize=-0.1,lraise=0.1,lhang=.2]
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

T
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

he topic of biosequence comparison
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 has a rich history dating back over 40 years. It is certainly very difficult to trace a line in some moments to establish the order in which every new development was presented because of the enormous body of publications that have contributed substantially to improve this field. Several general reviews have been used to reconstruct the history of biological sequence comparisons 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "mount:2001a,myers:1991a,ouzounis:2003,sankoff:1983a,meidanis:1997a, waterman:1984a"

\end_inset

.
\end_layout

\begin_layout Standard

Molecular evolution began to be studied in the 1960s when a few protein sequences were available, being published into the protein sequence atlas 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "dayhoff:1965a"

\end_inset

. Soon, pioneering analysis appeared to infer the evolutionary relationships from these sequences, depicted as distances in phylogenetic trees 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "fitch:1967a"

\end_inset

.
\end_layout

\begin_layout Standard

Outside the molecular biology, other significant advances in mathematics and in the emerging discipline of computer science contributed decisively to the current state of the art. For instance, it is impossible to understand the history of modern sequence alignment without mentioning the birth of a new technique in the 1950s to solve multistage decision process problems called dynamic programming 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "bellman:1957a,dreyfus:2002a"

\end_inset

. A problem is solved by dynamic programming if the answer can be efficiently determined by computing a table of optimal answers to progressively larger subproblems. The principle of optimality requires that the optimal answer to a given subproblem is expressible in terms of optimal answers to smaller subproblems. During all this time, despite innumerable optimal and heuristic approaches have been proposed to obtain the best alignments between two sequences with the minimum cost, dynamic programming is still the most stable technique to solve the original problem and many of its variations.
\end_layout

\begin_layout Standard

Another key concept is the definition of several metrics of distance between sequences in the coding theory field. Since noise in a transmission channel introduces errors into the signal reception, several mechanisms were developed for detection and correction of such errors. The Hamming distance, defined as the number of positions in which two sequences differ, was oriented to detect only substitutions 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "hamming:1950a"

\end_inset

. Next, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "levhenshtein:1966a"

\end_inset

 presented the edit distance, which was the earliest known use of a distance function that is appropriate to detect insertions and deletions of symbols in the original message.
\end_layout

\begin_layout Standard

It is not clear when the basic dynamic programming algorithm for molecular sequence comparison first appeared. It was probably rediscovered many times in different contexts. The well-known paper by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "needleman:1970a"

\end_inset

 who presented an algorithm for maximizing the number of matches minus the number of insertions and deletions is generally considered to be the first important contribution. Although no complexity analysis was provided, the original 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm measured the homology between two sequences in a 
\begin_inset Formula $O(n^3)$
\end_inset

 time.
\end_layout

\begin_layout Standard

A more rigorous approach with solid mathematical foundations arised from the problem of computing the distance between two sequences 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "ulam:1972a,beyer:1985a"

\end_inset

. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "sellers:1974a"

\end_inset

 presented a dynamic algorithm based on the Levhenshtein metric distance. Though less flexible for future variations of the problem, this new approach fitted better with the perspective of evolutionary distance analysis developed earlier. Under the realistic assumption that both sequences have 
\begin_inset Formula $n$
\end_inset

 nucleotides, the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm have computation time proportional to 
\begin_inset Formula $O(n^2)$
\end_inset

. A comprehensive study of equivalence between similarity and distance was presented in 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

.
\end_layout

\begin_layout Standard

Within the field of computer science, sequence comparison appeared in simpler incarnations of the molecular biology problems, for comparing the contents of files or correcting the spelling of words. For example, the longest common subsequence problem (LCS) consists on finding an alignment that maximizes the number of identical aligned pairs between two sequences (see 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "apostolico:1987a"

\end_inset

 for a review). Interestingly for long sequences, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "hirschberg:1975a"

\end_inset

 applied the divide and conquer strategy to solve the LCS problem in 
\begin_inset Formula $O(2 n^2)$
\end_inset

 time with a linear space cost instead of the established quadratic cost. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1988a"

\end_inset

 generalized this technique to align two sequences using 
\begin_inset Formula $O(n)$
\end_inset

 space.
\end_layout

\begin_layout Standard

Nonetheless, the treatment of gaps was still biologically unrealistic as a deletion of 
\begin_inset Formula $n$
\end_inset

 symbols and 
\begin_inset Formula $n$
\end_inset

 deletions of one symbol were punished indistinctly. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1976a"

\end_inset

 accommodated the same algorithm to deal with multiple deletions and insertions, introducing the concept of general gap penalty functions. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "gotoh:1982a"

\end_inset

 reduced the asymptotic cost from 
\begin_inset Formula $O(n^3)$
\end_inset

 to 
\begin_inset Formula $O(n^2)$
\end_inset

, under the application of the affine gap penalty functions in which there was an initial penalty for opening a gap and an additional minor penalty for extending an existent one. Apart from general and affine gap functions, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984a"

\end_inset

 introduced the concept of concave gap function in which the cost of extending an existent gap grows with the logarithm of the length of the gap as a continuous curve. Later, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "eppstein:1988a"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "miller:1988a"

\end_inset

 independently arrived at 
\begin_inset Formula $O(n^2 \log{n})$
\end_inset

 solutions of the problem.
\end_layout

\begin_layout Standard

DNA and protein sequences are the result of an evolutionary process that tend to preserve those parts that are key to perform a function, permitting variation in the rest. Thus a global comparison can easily produce a very poor alignment of two sequences that have some parts in common while others are completely free of conservation. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981c"

\end_inset

 introduced the concept of local alignment with a simple variation in the basic global similarity algorithm without increasing its cost. Under the premise of a negative gap penalty, reported alignments are regions of high similarity with a positive score within. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "sellers:1984a"

\end_inset

 tried to export the same concept to the distance metric. Only, those paths in the matrix whose density of mismatches was below a certain threshold were reported.
\end_layout

\begin_layout Standard

Thousands of genomic and proteomic sequences, that is millions of nucleotides and amino acids, are rapidly being accumulated in the biological databases. However, searching a database with a query sequence for similarities to other sequences using the optimal algorithms enumerated above is clearly unfeasible when this simple operation involves thousands of comparisons between two sequences. To overcome this problem, a new family of heuristic procedures that produce nearly correct answers in a simple and cheaper fashion was designed. The most popular representatives of these are the program FASTA 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "pearson:1988a"

\end_inset

 and the program BLAST 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "altschul:1990a"

\end_inset

. The FASTA heuristic is based on identifying the identities between two sequences (diagonals in the matrix) and then applying some more expensive procedures only on those subalignments. BLAST processing relies on first, detecting ungapped segment pairs of high score and then, extending them from both ends until a threshold value is reached.
\end_layout

\begin_layout Standard

A collateral effect of producing hundreds of alignments was the concern about the quality of a given alignment between two sequences. The significance of a local alignment score can be tested by comparing with the distribution of scores expected by aligning two random sequences with the same length and composition 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "karlin:1990a"

\end_inset

. These random sequence alignment scores follow a distribution called the extreme value distribution (also known as the Gumbel distribution), which is similar to a normal distribution but with a positively skewed tail in the higher score 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "gumbel:1962a"

\end_inset

. Less interest has traditionally been focused on global comparisons because of a global alignment is always produced by definition even between random or unrelated sequences, growing the score proportionally to the length of them.
\end_layout

\begin_layout Standard

In attempt to distinguish more distant relationships, the implementation of comparisons for more than two sequences is the logical evolution to locate elements with function that are conserved for instance in several homologous sequences. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1976a"

\end_inset

 naturally extended the basic dynamic programming recurrence for 
\begin_inset Formula $k$
\end_inset

 sequences, with an exponential cost 
\begin_inset Formula $O(n^k)$
\end_inset

. As this approach is generally impractical, some heuristics appeared to solve the problem with a minor cost. The most popular of them is the hierarchical or clustering method called progressive alignment that first takes 
\begin_inset Formula $O(k^2 n^2)$
\end_inset

 to perform all pairwise alignments and second, produce a multiple alignment following a guide tree to merge these alignments 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "feng:1987a"

\end_inset

. The program CLUSTALW 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "thompson:1994a"

\end_inset

 combines this strategy with different weighting schemes according to the progression in the distances tree. Previously, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "carrillo:1988a"

\end_inset

 developed another method based on identifying the projections of the pairwise alignments that can form the multiple alignment. Moreover, hidden Markov models have been used to produce multiple alignments of a family of sequences to which more members can be dynamically be added (profile HMMs, see 
\begin_inset CommandInset citation
LatexCommand citealp
after ""
before ""
key "durbin:1998a"

\end_inset

).
\end_layout

\begin_layout Standard

Pattern discovery and local multiple sequence alignment have been very closely related problems 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "brazma:1998a"

\end_inset

. For instance, a conserved pattern or a block of ungapped common motifs in a set of sequences defines a local multiple alignment. In any case, the problem is even more difficult than pure global alignment and optimal approaches were discarded beforehand. Some heuristic approaches have been proposed to circumvent the complexity. Iterative methods do not necessarily find the best pattern, but may converge to a local maximum. Gibbs sampling 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "lawrence:1993a"

\end_inset

 and expectation maximization 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "bailey:1994a"

\end_inset

 are successful examples of these stochastic techniques.
\end_layout

\begin_layout Standard

Some pattern recognition problems are too complex or too ambiguous to be expressed as a simple pattern matching operations over a sequence. In these cases, a richer environment over the basic sequences is needed to describe the comparison of such elements 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "knight:1995a"

\end_inset

. For example, for most sequence comparison problems there is a corresponding map comparison algorithm. Map comparisons were introduced to model the alignment of restriction enzyme maps. These were used in the construction of physical maps prior to genome sequencing projects. The basic definition of the problem by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 contained an 
\begin_inset Formula $O(n^4)$
\end_inset

 time cost algorithm although it was noticed the dynamic programming matrix was very sparse. Later, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

 improved the time efficiency by using an analytical approach that reduced the cost to 
\begin_inset Formula $O(n^2 \log{n})$
\end_inset

. Additional refinements of the problem produced new algorithms to deal with map data errors 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "huang:1992a"

\end_inset

 or to align specifically short maps to longer ones 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "miller:1990a"

\end_inset

.
\end_layout

\begin_layout Standard

Not only analytical approaches have been employed for comparing sequences. Dot matrix comparisons, also known as dotplots, are visual comparisons that can be useful to conduct afterwards a deeper research with dynamic programming algorithms only on those conserved regions 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "gibbs:1970a"

\end_inset

. Sequence logos are graphs that illustrate the amount of information in each column of an alignment or motif 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "schneider:1990a"

\end_inset

.
\end_layout

\begin_layout Standard

Sequence comparison algorithms that were developed to solve biological problems have been recreated and applied in other scientific fields 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "sankoff:1983a"

\end_inset

. For instance, applications can be found in geology (stratigraphic sequences), in dendrochronology (time dating based on tree rings), or in bird song recognition (animal communication).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Alphabets, sequences and alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Biological significance of sequence comparison
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence!seqbs@evolution
\end_layout

\end_inset

 Gene evolution is thought to occur by gene duplication, creating two tandem copies of the gene in a given ancestor species. In rare cases, new mutations in one of the copies can provide an advantageous change in function. The two copies then evolve along separate pathways. At a certain evolutionary point, a speciation event gives rise to two separate branches (two new species) of the tandem gene preserving a similar sequence due to the single gene ancestor (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:phylogeny"

\end_inset

). The four copies of the original gene are said to be homologous: 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

gene!hom@homology
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

homology
\end_layout

\end_inset

 the two corresponding units of the tandem gene in each species are orthologous 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

gene!ort@orthology
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

orthology
\end_layout

\end_inset

 while the two units of each tandem gene in the same species are paralogous. 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

gene!paral@paralogy
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

paralogy
\end_layout

\end_inset

 Molecular evolution events include substitutions of one nucleotide or amino acid for another as well as insertions and deletions (indels) of others. More complex genetic rearrangements such inversions, transpositions, translocations or duplications can shuffle larger parts of the genes or of the proteins, producing chimeric products in which some regions are homologous and others are not 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "mount:2001a"

\end_inset

.
\end_layout

\begin_layout Standard

Sequence comparison 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence!seqcmp@sequence comparison
\end_layout

\end_inset

 consists of finding which parts of the sequences are alike and which parts differ. This operation is extremely useful for discovering functional, structural and evolutionary information in biological sequences. If two sequences from different organisms are similar, there may have been a common ancestor sequence that would make these sequences to be homologous. Phylogenetic analyses are usually conducted starting from multiple sequence comparisons, and then producing hierarchical trees that would explain the evolution of the species.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Alphabets and sequences
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:alphabets"

\end_inset


\end_layout

\begin_layout Standard

A finite alphabet 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alphabet
\end_layout

\end_inset

 is a set of symbols or characters. For instance, the four-letter DNA and RNA alphabets are defined as: 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

$
\backslash
Sigma_{DNA} = 
\backslash
{ 
\backslash
mbox{A}, 
\backslash
mbox{C}, 
\backslash
mbox{G}, 
\backslash
mbox{T}
\backslash
}$ and $
\backslash
Sigma_{RNA} = 
\backslash
{ 
\backslash
mbox{A}, 
\backslash
mbox{C}, 
\backslash
mbox{G}, 
\backslash
mbox{U}
\backslash
}.$
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

To support some degree of variation or ambiguity in a symbol, the IUPAC extended genetic alphabet 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alphabet!iupac@IUPAC alphabet
\end_layout

\end_inset

 of 15 elements allows for special symbols possessing multiple letters (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:code1"

\end_inset

). The single-letter amino acid alphabet contains 20 elements 
\begin_inset Foot
status collapsed


\begin_layout Standard

Nowadays, new amino acids are still being unveiled such as Selenocysteine.
\end_layout

\end_inset

 from which all proteins are built (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:code2"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset Formula $\Sigma^*$
\end_inset

 denotes the set of all finite sequences of characters from 
\begin_inset Formula $\Sigma$
\end_inset

 including the empty sequence 
\begin_inset Formula $\lambda$
\end_inset

. A generic sequence 
\begin_inset Formula $S$
\end_inset

 of length 
\begin_inset Formula $|S|=n$
\end_inset

 symbols over a finite alphabet 
\begin_inset Formula $\Sigma$
\end_inset

 is 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence
\end_layout

\end_inset

 defined as: 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

$S = s_1 s_2 
\backslash
ldots s_n$ where $
\backslash
forall i: 1 
\backslash
leq i 
\backslash
leq n: s_i 
\backslash
in 
\backslash
Sigma$.
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

A subsequence of 
\begin_inset Formula $S$
\end_inset

 between positions 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 of 
\begin_inset Formula $S$
\end_inset

 is the contiguous series of elements between 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

subsequence
\end_layout

\end_inset

 both positions
\begin_inset Foot
status collapsed


\begin_layout Standard

As defined in computer science, subsequences are subsets of characters of 
\begin_inset Formula $S$
\end_inset

 possibly not contiguous but arranged in their original relative order.
\end_layout

\end_inset

. If 
\begin_inset Formula $i = 1$
\end_inset

, the subsequence is called a prefix of 
\begin_inset Formula $S$
\end_inset

. If 
\begin_inset Formula $j = n$
\end_inset

, the subsequence is a suffix: 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

$S_{i,j} = s_i 
\backslash
ldots s_j$ where $1 
\backslash
leq i 
\backslash
leq j 
\backslash
leq n$ and $
\backslash
forall k: i 
\backslash
leq k 
\backslash
leq j: s_k 
\backslash
in S$.
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 1: Phylogenetic relationships
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.6
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/homology
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:phylogeny
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Gene evolution events
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Gene evolution events.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Sequence alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:alignments"

\end_inset


\end_layout

\begin_layout Standard

Given two sequences 
\begin_inset Formula $A = a_1 a_2 \ldots a_m$
\end_inset

 and 
\begin_inset Formula $B = b_1 b_2 \ldots b_n$
\end_inset

 in a finite alphabet 
\begin_inset Formula $\Sigma$
\end_inset

, a sequence alignment 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence!aln@alignment
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment
\end_layout

\end_inset

 of 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is a correspondence 
\begin_inset Formula $C$
\end_inset

 between the symbols from the two sequences
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
shortstack{$C(A,B) = 
\backslash
{ (a_{i_1},b_{j_1}),(a_{i_2},b_{j_2})
\backslash
ldots(a_{i_T},b_{j_T})
\backslash
}$ where
\backslash

\backslash

\end_layout

\begin_layout Standard

$1 
\backslash
leq i_1 
\backslash
leq i_2 
\backslash
leq 
\backslash
ldots i_T 
\backslash
leq m, 1 
\backslash
leq j_1 
\backslash
leq j_2 
\backslash
leq 
\backslash
ldots j_T 
\backslash
leq n$}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

such that: 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Each 
\begin_inset Formula $a_k$
\end_inset

 (or 
\begin_inset Formula $b_l$
\end_inset

) not appearing in the subsequence 
\begin_inset Formula $a_{i_1} \ldots a_{i_T}$
\end_inset

 (or 
\begin_inset Formula $b_{j_1} \ldots b_{j_T}$
\end_inset

) is considered to be an insertion in the other sequence (or a deletion in this one). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

If the pair 
\begin_inset Formula $(a_i,b_j) \in C \Rightarrow \forall k: b_k \in B \wedge k \neq j: (a_i,b_k) \notin C$
\end_inset

 (one symbol only matches another symbol at most). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

If the pairs 
\begin_inset Formula $(a_i,b_j),(a_k,b_l) \in C$
\end_inset

 and 
\begin_inset Formula $i<k \Rightarrow j<l$
\end_inset

 (no inversions are allowed). 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

For example, a possible alignment of the sequence 
\begin_inset Formula $A=AAGTTC$
\end_inset

 and the sequence 
\begin_inset Formula $B=AGCCC$
\end_inset

 is 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!exam@example
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccccccc}
\end_layout

\begin_layout Standard

$A = $ & A & A & G & T & T & C
\backslash

\backslash

\end_layout

\begin_layout Standard

& | &  & | &  &  & | 
\backslash

\backslash

\end_layout

\begin_layout Standard

$B = $ & A & -- & G & C & C & C.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!combis@changes
\end_layout

\end_inset

 This alignment represents a certain hypothesis about the evolution of the two sequences 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1990a"

\end_inset

: three of the nucleotides have not changed since the common ancestor of 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 (matches), there have been at least two substitutions (mismatches), and one nucleotide has been either inserted or deleted (a gap), which is denoted with the symbol 
\begin_inset Quotes eld
\end_inset

--
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!score@scoring function
\end_layout

\end_inset

 If we adopt a scoring function that assigns a given value to a match, a mismatch and a gap, every column of the alignment will receive a score and the total score of the alignment will be the sum of the values assigned to its columns. The best alignment will be the one that optimizes the total score. In the literature, two different types of measures have been devised to construct such a scoring function : similarity and distance (see 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981a"

\end_inset

 for a review).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Sequence similarity
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

similarity
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence!sim@similarity
\end_layout

\end_inset

 Similarity is a measure of how alike two sequences are. An alignment is scored by rewarding the identities and in less degree, the substitutions, and punishing the gaps.
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $(a_i,b_j)$
\end_inset

 be a match (or a mismatch) of type 
\begin_inset Formula $k$
\end_inset

 with a weight 
\begin_inset Formula $\alpha_k$
\end_inset

 and let 
\begin_inset Formula $w_l$
\end_inset

 be the weight associated to a gap of length 
\begin_inset Formula $l$
\end_inset

. Then, the similarity of an alignment 
\begin_inset Formula $C$
\end_inset

 of 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 with 
\begin_inset Formula $\lambda_x$
\end_inset

 matches of type 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $\Delta_y$
\end_inset

 gaps of length 
\begin_inset Formula $y$
\end_inset

 is
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

S(C) = 
\backslash
sum_x 
\backslash
lambda_x 
\backslash
alpha_x  - 
\backslash
sum_y 
\backslash
Delta_y w_y.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The best alignment is the one that maximizes the similarity between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

. The similarity can increase and decrease during the computation of an alignment score from 
\begin_inset Formula $-\infty$
\end_inset

 to 
\begin_inset Formula $\infty$
\end_inset

 (from dissimilarity to similarity, where 
\begin_inset Formula $0$
\end_inset

 means absence of any type of similarity).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Sequence distance
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

distance
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

sequence!dis@distance
\end_layout

\end_inset

 Distance (also called edit distance) is the minimal number of changes (indels and substitutions) needed to transform one sequence into another. An alignment is scored by charging a cost to each difference in the aligned sequences (
\begin_inset Formula $0$
\end_inset

 for exact matches).
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $(a_i,b_j)$
\end_inset

 be a match (or a mismatch) of type 
\begin_inset Formula $k$
\end_inset

 with a weight 
\begin_inset Formula $\beta_k$
\end_inset

 and let 
\begin_inset Formula $w_l$
\end_inset

 be the weight associated to a gap of length 
\begin_inset Formula $l$
\end_inset

. Then, the distance of an alignment 
\begin_inset Formula $C$
\end_inset

 of 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 with 
\begin_inset Formula $\lambda_x$
\end_inset

 matches of type 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $\Delta_y$
\end_inset

 gaps of length 
\begin_inset Formula $y$
\end_inset

 is
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

D(C) = 
\backslash
sum_x 
\backslash
lambda_x 
\backslash
beta_x + 
\backslash
sum_y 
\backslash
Delta_y w_y.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The best alignment is the one that minimizes the distance between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

. Distance metric provides a more biologically natural way to compare sequences, estimating the evolutionary time that has elapsed since the sequences diverged from a common ancestor. The distance value can only increase during the computation of an alignment score, starting with a value of 
\begin_inset Formula $0$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Table 1: IUPAC alphabet
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "70line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\begin_inset Graphics 
	filename ../tables/code1.pdf
	clip
	BoundingBox 155 621 498 815

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:code1
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The IUPAC extended genetic alphabet
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The IUPAC extended genetic alphabet.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

The number of alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The number of possible alignments between two sequences of 
\begin_inset Formula $n$
\end_inset

 symbols can be computed with the following function 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1984a,waterman:1995a"

\end_inset

: 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!nalns@number of
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

g(n) 
\backslash
sim 
\backslash
frac{2^{2n}}{4
\backslash
sqrt{n
\backslash
pi}}.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

For two sequences of 
\begin_inset Formula $1,000$
\end_inset

 nucleotides, 
\begin_inset Formula $g(n) > 10{^{600}}$
\end_inset

. As direct examination of all these alignments is in practice impossible, computational approaches are therefore essential to calculate the optimal alignment without exploring all of the combinations.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Table 2: AA alphabet
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float table
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset Box Frameless
position "c"
hor_pos "c"
has_inner_box 1
inner_pos "c"
use_parbox 0
use_makebox 0
width "40line%"
special "none"
height "1in"
height_special "totalheight"
status open


\begin_layout Plain Layout


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
parindent}{0pt}
\end_layout

\end_inset

 
\begin_inset Graphics 
	filename ../tables/code2.pdf
	clip
	BoundingBox 200 564 397 817

\end_inset

 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

tab:code2
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The amino acid alphabet
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The amino acid alphabet.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Classes of sequence alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:classes"

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!class@classes
\end_layout

\end_inset

 According to the type of comparison that must be performed between sequences, sequence alignments can classified as 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "mount:2001a"

\end_inset

:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{mitemize}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Global alignments: 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!glob@global
\end_layout

\end_inset

 the entire sequence length must be aligned to include the maximum number of matches. Sequences that are quite similar and approximately have the same length are good candidates for global alignment. 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccccccccccccccccccc}
\end_layout

\begin_layout Standard

L & G & P & S & S & K & Q & T & G & K & G & S & -- & S & R & I & W & D & N
\backslash

\backslash
 
\end_layout

\begin_layout Standard

| & & & & & | & & & | & | & | & & & & | & & & | & 
\backslash

\backslash

\end_layout

\begin_layout Standard

L & N & -- & I & T & K & S & A & G & K & G & A & I & M & R & L & G & D & A
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Local alignments: 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!loc@local
\end_layout

\end_inset

 only the stretches of the sequences with the highest density of matches are aligned. Sequences that differ in length or that only share certain regions are suitable candidates for local alignment.
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccccccccccccccccccc}
\end_layout

\begin_layout Standard

-- & -- & -- & -- & -- & -- & -- & T & G & K & G & -- & -- & -- & -- & -- & -- & -- & --
\backslash

\backslash
 
\end_layout

\begin_layout Standard

 & & & & & & & & | & | & | & & & & & & & & 
\backslash

\backslash

\end_layout

\begin_layout Standard

-- & -- & -- & -- & -- & -- & -- & A & G & K & G & -- & -- & -- & -- & -- & -- & -- & --
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{mitemize}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

When the number of sequences is two, such alignments receive the name of pairwise alignments 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!paraln@pairwise
\end_layout

\end_inset

 as the examples above. If the number of input sequences is higher, they are called multiple sequence alignments:
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!mul@multiple
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{mitemize}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Global multiple alignments: the whole set of sequences is aligned at their entire length. Simply known as multiple alignments, they are the starting point for evolutionary modeling. Each column of the alignment is examined and significant changes observed in this position collaborate in the construction of a phylogenetic tree. 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccccccccccccccccccc}
\end_layout

\begin_layout Standard

L & G & P & S & S & K & Q & T & G & K & G & S & -- & S & R & I & W & D & N
\backslash

\backslash
 
\end_layout

\begin_layout Standard

| & & & & & & & & | & | &  & & & &  & & & | & 
\backslash

\backslash

\end_layout

\begin_layout Standard

L & N & -- & I & T & K & S & A & G & K & G & A & I & M & R & L & G & D & A
\backslash

\backslash

\end_layout

\begin_layout Standard

| &  & & & & & & & | & | &  & & & & & & & | & 
\backslash

\backslash

\end_layout

\begin_layout Standard

L & N & -- & K & Q & Q & S & A & G & K & C & A & I & M & -- & L & G & D & A
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Local multiple alignments: they are equivalent to searching a pattern conserved in a set of sequences. Rather than be defined as a form of alignment, it is conceptually considered a pattern discovery problem.
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccccccccccccccccccc}
\end_layout

\begin_layout Standard

-- & -- & -- & -- & -- & -- & -- & T & G & K & G & -- & -- & -- & -- & -- & -- & -- & --
\backslash

\backslash
 
\end_layout

\begin_layout Standard

-- & -- & -- & -- & -- & -- & -- & A & G & K & G & -- & -- & -- & -- & -- & -- & -- & --
\backslash

\backslash

\end_layout

\begin_layout Standard

-- & -- & -- & -- & -- & -- & -- & A & G & K & C & -- & -- & -- & -- & -- & -- & -- & --
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{mitemize}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

An anthology of algorithms for global alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:global"

\end_inset


\end_layout

\begin_layout Standard

This section aims to be a catalogue of different approaches to solve the global pairwise alignment which was the first problem introduced in the field of sequence comparisons. Naturally, the extension to the multiple alignment of sequences has been also treated although optimal solutions were discarded because of their expensive time and space costs. Different heuristics to cope with multiple alignment are explained in detail in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:msa"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Needleman and Wunsch algorithm (1970)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "nw"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!nw@Needleman and Wunsch
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!nw@Needleman and Wunsch
\end_layout

\end_inset

 For the authors, the similarity or maximum match value between two proteins depends on the largest number of amino acids from the first protein that can be matched with those of the second one allowing possible interruptions in either sequence.
\end_layout

\begin_layout Standard

Each pair of amino acids from each sequence is the smallest unit of significance. All possible pair combinations are represented in a two-dimensional matrix 
\begin_inset Formula $M$
\end_inset

. The pathways through the cells of the matrix are representations of every possible comparison of the two sequences. If a given value is assigned to each identity and mismatch, the maximum match between two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is then the largest number that would result from the sum of the cell values of every pathway.
\end_layout

\begin_layout Standard

The original 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm is actually a description of a method to systematically count the number of identities (denoted as 1's in the simplest formulation) between both sequences. No complexity analysis was provided although a careful analysis determines the cost of the process is cubic (see next section). In addition, the authors implicitly suggested the extension of the method to allow multiple comparison of several proteins or the inclusion of a gap penalty factor as a function depending on the length of the gap.
\end_layout

\begin_layout Standard

The assessment of the significance of a given match value was also proposed: first, two sets of random sequences with the same composition of the original proteins are constructed; second, the maximum-match between pairs of these sequences is determined several times and is compared to the value obtained between real proteins; third, the match between one of the real proteins and several of the random sequences is also computed and evaluated. In all of the cases, the difference between the real match and the artificial ones should be statistically significant. Otherwise, the match between both proteins would be explained in part only by a similar composition.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 2: N-W Matrix (figure 1 paper)
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/nw
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:nw
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The maximum-match operation for necessary pathways
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The maximum-match operation for necessary pathways.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The cell 
\begin_inset Formula $(R,R,1)$
\end_inset

 corresponds to the current 
\begin_inset Formula $M(i,j)$
\end_inset

. Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "needleman:1970a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The objective of the algorithm is to compute the pathway in the matrix 
\begin_inset Formula $M$
\end_inset

 that according to a certain scoring schema is assigned the maximum value. The procedure to efficiently compute this value consists of two stages (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:nw"

\end_inset

): 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Each cell of the matrix 
\begin_inset Formula $M(i,j)$
\end_inset

 is assigned the corresponding value whether there is a match or a mismatch in this position (e.g. 
\begin_inset Formula $1$
\end_inset

 for identities, void or 
\begin_inset Formula $0$
\end_inset

 for mismatches). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Beginning at the terminals of the sequences and proceeding toward the origins in the matrix, the value of the maximum-match starting at each cell 
\begin_inset Formula $M(i,j)$
\end_inset

 can be obtained by adding to its value, the maximum value from among all the cells which lie on a pathway to it. The pathways are negatively weighted with the value 
\begin_inset Formula $g$
\end_inset

 according to the number of gaps they contain. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

M(i,j) = M(i,j) +
\end_layout

\begin_layout Standard

max
\end_layout

\begin_layout Standard


\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{lr}
\end_layout

\begin_layout Standard

M(i+1,j+1) &
\backslash

\backslash

\end_layout

\begin_layout Standard

M(i',j+1) + g 
\backslash
times (i' -i + 1),& i+2 
\backslash
leq i' 
\backslash
leq |A| 
\backslash

\backslash

\end_layout

\begin_layout Standard

M(i+1,j') + g 
\backslash
times (j' -j + 1),& j+2 
\backslash
leq j' 
\backslash
leq |B|. 
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

If 
\begin_inset Formula $|A| = |B| = n$
\end_inset

, then the cost of visiting each cell of the matrix is 
\begin_inset Formula $O(n^2)$
\end_inset

. Additionally, for each cell the best pathway among all of the possible ones in the previous row, in the previous column and in the diagonal is searched. The cost of accessing the values of the pathways in a given column or row is 
\begin_inset Formula $O(n)$
\end_inset

, while accessing the diagonal is constant 
\begin_inset Formula $O(1)$
\end_inset

. Therefore, the final cost of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm is 
\begin_inset Formula $O(n^3)$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The implementation of the algorithm is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:nwalg"

\end_inset

. The matrix is processed following a systematic order. Both processing steps described above are integrated in a single one. For each pair of amino acids from both sequences represented by a cell 
\begin_inset Formula $M(i,j)$
\end_inset

 in the matrix , the optimal pathway starting there is constructed selecting the best pathway in the diagonal, and in the 
\begin_inset Formula $i+1$
\end_inset

 row and the 
\begin_inset Formula $j+1$
\end_inset

 column (here weighting according to the number of gaps) that have been previously computed.
\end_layout

\begin_layout Standard

The matrix 
\begin_inset Formula $P$
\end_inset

 is used to record the cell from which the maximum pathway was selected. The retrievement of the solution, not shown here, consists on (1) searching the maximum value (cell 
\begin_inset Formula $x,y$
\end_inset

) both in the first row and in the first column and (2) using recursively the coordinates in 
\begin_inset Formula $P(x,y)$
\end_inset

, to construct the arrangement of both sequences until a cell at the last column or row is reached.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Sellers algorithm (1974)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sellers"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!sellers@Sellers
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!selal@Sellers
\end_layout

\end_inset

 In the 1970s, most techniques used in taxonomic tree construction depended on the introduction of a measure of distance between sequences 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "fitch:1967a"

\end_inset

. The work on distances or metrics on protein sequences was essentially based on discovering what genetic mutations were required to change one sequence into another.
\end_layout

\begin_layout Standard


\begin_inset Newpage clearpage
\end_inset

A metric space is a function 
\begin_inset Formula $\rho: S \times S \rightarrow \mathcal{Z^+}$
\end_inset

 on a generic set 
\begin_inset Formula $S$
\end_inset

, with the following properties:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ll}
\end_layout

\begin_layout Standard


\backslash
emph{Non-negative} & $
\backslash
forall a,b 
\backslash
in S: 
\backslash
rho(a,b) 
\backslash
geq 0$
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
emph{Identity} & $
\backslash
forall a,b 
\backslash
in S: 
\backslash
rho(a,b) = 0 
\backslash
Leftrightarrow a = b$
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
emph{Reflexivity} & $
\backslash
forall a,b 
\backslash
in S: 
\backslash
rho(a,b) = 
\backslash
rho(b,a)$
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
emph{Transitivity} & $
\backslash
forall a,b,c 
\backslash
in S: 
\backslash
rho(a,b) 
\backslash
leq 
\backslash
rho(a,c) + 
\backslash
rho(c,b)$.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "sellers:1974a"

\end_inset

 described the construction of an evolutionary tree, which assumes that evolutionary distance is a metric. The minimum distance 
\begin_inset Formula $D(A,B)$
\end_inset

 between two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is defined as the smallest possible weighted sum of insertions, deletions, and substitutions which transforms one sequence into the other.
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 showed that if a scoring function 
\begin_inset Formula $d(a,b)$
\end_inset


\begin_inset Foot
status collapsed


\begin_layout Standard

Also known as a weighting scheme.
\end_layout

\end_inset

 forms a metric space over the underlying alphabet of symbols then the minimum distance function 
\begin_inset Formula $D(A,B)$
\end_inset

 forms a metric space over the set of finite sequences constructed with such an alphabet. In addition, he proportioned the dynamic programming recurrence to efficiently compute the minimum distance 
\begin_inset Formula $D$
\end_inset

 between two sequences using several scoring functions. In fact, many comparison algorithms that use distance functions with a given weighting scheme provide an optimal alignment only if such a scheme is a metric 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "tyler:1991a"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 3: N-W algorithm
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences; id,mis,gap $
\backslash
in 
\backslash
mathcal{Z}$
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Begin the series of sums from last row and column}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=|A|$ to $1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=|B|$ to $1$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Setting the identity or mismatch value for the cell}
\end_layout

\begin_layout Standard


\backslash
IF{$a_i = b_j$}
\end_layout

\begin_layout Standard


\backslash
STATE $M(i,j) 
\backslash
leftarrow$ id;
\end_layout

\begin_layout Standard


\backslash
ELSE
\end_layout

\begin_layout Standard


\backslash
STATE $M(i,j) 
\backslash
leftarrow$ mis;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
IF{$i 
\backslash
neq |A|$ and $j 
\backslash
neq |B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Search the maximum-match pathway beginning here}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. The maximum from diagonal}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow M(i+1,j+1)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i+1,j+1)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. The maximum value from previous column}
\end_layout

\begin_layout Standard


\backslash
STATE ngaps $
\backslash
leftarrow 1$;
\end_layout

\begin_layout Standard


\backslash
FOR{$i'= i + 2$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow M(i',j+1) + 
\backslash
mbox{gap * ngaps}$; 
\end_layout

\begin_layout Standard


\backslash
IF{value $> 
\backslash
mbox{max}$}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i',j+1)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE ngaps $
\backslash
leftarrow$ ngaps + 1;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. The maximum value from previous row}
\end_layout

\begin_layout Standard


\backslash
STATE ngaps $
\backslash
leftarrow 1$;
\end_layout

\begin_layout Standard


\backslash
FOR{$j'= j + 2$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow M(i+1,j') + 
\backslash
mbox{gap * ngaps}$;
\end_layout

\begin_layout Standard


\backslash
IF{value $> 
\backslash
mbox{max}$}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow $ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i+1,j')$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE ngaps $
\backslash
leftarrow$ ngaps + 1;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{The maximum-match pathway is formed}
\end_layout

\begin_layout Standard


\backslash
STATE $M(i,j) 
\backslash
leftarrow M(i,j) + 
\backslash
mbox{max}$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:nwalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 generalized the algorithm to allow for various weighting schemes. Let 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 be two symbols. The simplest scheme 
\begin_inset Formula $d$
\end_inset

 to score this match is defined as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

d(a,b) = 
\end_layout

\begin_layout Standard


\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{lr}
\end_layout

\begin_layout Standard

0 & 
\backslash
mbox{if}~~a = b
\backslash

\backslash

\end_layout

\begin_layout Standard

1 & 
\backslash
mbox{if}~~a 
\backslash
neq b.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Using this scoring function 
\begin_inset Formula $d$
\end_inset

, the following recurrence calculates the optimal distance between two sequences 
\begin_inset Formula $A = (a_1, a_2, \ldots a_m)$
\end_inset

 and 
\begin_inset Formula $B = (b_1, b_2, \ldots b_n)$
\end_inset

, and provides the initial values as well:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i,j) = &
\end_layout

\begin_layout Standard

min 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i-1,j-1) + d(a_i,b_j) & 
\backslash
mbox{
\backslash
emph{Match}}
\backslash

\backslash

\end_layout

\begin_layout Standard

D(i-1,j) + d(a_i,-) & 
\backslash
mbox{
\backslash
emph{Gap in $B$}}
\backslash

\backslash

\end_layout

\begin_layout Standard

D(i,j-1) + d(-,b_j) & 
\backslash
mbox{
\backslash
emph{Gap in $A$}}
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. ,
\backslash

\backslash
[0.75cm]
\end_layout

\begin_layout Standard


\end_layout

\begin_layout Standard

D(i,0) = & 
\backslash
sum_{k=0}^{i}{d(a_k,-)},
\backslash

\backslash

\end_layout

\begin_layout Standard

D(0,j) = & 
\backslash
sum_{k=0}^{j}{d(-,b_k)}.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
label{eq:sellers}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

To avoid the exponential number of combinations to construct an alignment between two sequences, this dynamic programming recurrence decompose the problem in smaller alignments of prefixes of the original sequences. Thus, starting from the one-letter prefixes , the minimum distance of the alignment ending at the prefixes 
\begin_inset Formula $A_{1,i}$
\end_inset

 and 
\begin_inset Formula $B_{1,j}$
\end_inset

 can be calculated from the three different forms of finishing such an alignment:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

%
\backslash
scalebox{0.7}{
\end_layout

\begin_layout Standard

%
\backslash
begin{minipage}[][][c]{1.25
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccc}
\end_layout

\begin_layout Standard


\backslash
fbox{
\backslash
begin{tabular}{lllll}
\end_layout

\begin_layout Standard

$
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $a_i$
\backslash

\backslash

\end_layout

\begin_layout Standard

$
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $b_j$
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}}
\end_layout

\begin_layout Standard

&
\end_layout

\begin_layout Standard


\backslash
fbox{
\backslash
begin{tabular}{lllll}
\end_layout

\begin_layout Standard

$
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $a_i$
\backslash

\backslash

\end_layout

\begin_layout Standard

$
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & --
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}}
\end_layout

\begin_layout Standard

&
\end_layout

\begin_layout Standard


\backslash
fbox{
\backslash
begin{tabular}{lllll}
\end_layout

\begin_layout Standard

$
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & --
\backslash

\backslash

\end_layout

\begin_layout Standard

$
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $
\backslash
bullet$ & $b_j$
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}}
\backslash

\backslash

\end_layout

\begin_layout Standard

Match & Ins in $A$, Del in $B$ & Del in $A$, Ins in $B$.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard

%
\backslash
end{minipage}}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 4: DProgramming Matrix
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.6
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/dp
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:dp
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The dynamic programming matrix
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The dynamic programming matrix.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

In yellow, the part of the alignment matrix that has been computed. In blue, the part that must be still calculated. The cell 
\begin_inset Formula $D(i,j)$
\end_inset

 is the match currently in process.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

If both sequences have the same length 
\begin_inset Formula $n$
\end_inset

, the cost of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm is 
\begin_inset Formula $O(n^2)$
\end_inset

 which is the time to visit all of the cells of the dynamic programming matrix (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dp"

\end_inset

). For each cell, only three neighbours are consulted: in the diagonal, in the horizontal and in the vertical.
\end_layout

\begin_layout Standard

The procedure to trace-back the distance matrix, reconstructing the alignment was adapted from 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 by 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

. A second matrix of pointers is needed for recording from which direction was taken the value to update a given cell matrix.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm requires to fit the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 
\begin_inset Formula $m \times n$
\end_inset

 matrix in an artificial 0-column and 0-row to increase the initial distance when starting the alignment with gaps
\begin_inset Foot
status collapsed


\begin_layout Standard

There is an easy modification of the algorithm to permit not to punish this kind of gaps.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard

Then, the algorithm starts at 
\begin_inset Formula $D(1,1)$
\end_inset

 and the matrix is filled by rows (from top to bottom) and within a row by columns (from left to right). Thus, when a cell 
\begin_inset Formula $D(i,j)$
\end_inset

 is reached, its neigbours 
\begin_inset Formula $D(i-1,j-1)$
\end_inset

, 
\begin_inset Formula $D(i-1,j)$
\end_inset

 and 
\begin_inset Formula $D(i,j-1)$
\end_inset

 have been already calculated.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 5: Sellers algorithm
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $d$: metric on $
\backslash
Sigma$
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Initialize the 0-column and the 0-row}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,0) 
\backslash
leftarrow i 
\backslash
times d(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(0,j) 
\backslash
leftarrow j 
\backslash
times d(b_j,-)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Filling the matrix}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=1$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Match}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow D(i-1,j-1) + d(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j-1)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Gap in sequence $B$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(i-1,j) + d(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Gap in sequence $A$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(i,j-1) + d(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i,j-1)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:sellersalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Contrarily to the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm (in which the maximum match was searched in the last column and the last row), the minimum distance between both sequences will be saved at the end into the cell 
\begin_inset Formula $D(m,n)$
\end_inset

 because of the different initialization.
\end_layout

\begin_layout Standard

As in the case of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

, there is an auxiliary matrix 
\begin_inset Formula $P$
\end_inset

 that saves the source of each calculation in a given cell to recursively reconstruct the alignment with such a distance.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

A linear space algorithm: Hirschberg (1975)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "linearspace"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!hirs@Hirschberg
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!hirsal@Hirschberg
\end_layout

\end_inset

 In some occasions when aligning two sequences, the limiting factor is not the time but the space (memory). Any algorithm that solves the alignment of two sequences can not decrease the quadratic time cost unless any assumption is made over the length of the inputs. However, the quadratic cost in terms of space can be reduced to a linear cost.
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "hirschberg:1975a"

\end_inset

 designed a divide and conquer algorithm to solve the LCS problem in linear space without increasing the asymptotic time cost. Later, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1988a"

\end_inset

 demonstrated how this technique could optimally deal with general sequence alignment problems.
\end_layout

\begin_layout Standard

The key point of the algorithm is based on the fact that in the alignment between the sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, any element of 
\begin_inset Formula $A$
\end_inset

 will be aligned either to a gap or another element in 
\begin_inset Formula $B$
\end_inset

. Thus, the problem of aligning both sequences can be expressed in terms of making this decision for a current element 
\begin_inset Formula $a_i$
\end_inset

, assuming the optimal alignments between the subsequences from 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 around this element are already computed.
\end_layout

\begin_layout Standard

Another important fact is the ability to compute the distance between two sequences in linear space. If the dynamic programming matrix is filled in from top to bottom (row by row), and fixing a row, from left to right (column by column), then the values in a row 
\begin_inset Formula $i$
\end_inset

 depend only on the values stored at the previous row 
\begin_inset Formula $i-1$
\end_inset

 and on the values in the same row 
\begin_inset Formula $i$
\end_inset

. The other previous rows are therefore not necessary to obtain the final value 
\begin_inset Formula $D(m,n)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "myers:1991a,meidanis:1997a"

\end_inset

.
\end_layout

\begin_layout Standard

Furthermore, instead of using two arrays to represent the rows 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $i+1$
\end_inset

, the computation can be performed in a single array 
\begin_inset Formula $D$
\end_inset

 (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:twoarray"

\end_inset

 (A)), overwriting the old values on the left of the current column 
\begin_inset Formula $j$
\end_inset

. The equivalence between each cell 
\begin_inset Formula $D(i,j)$
\end_inset

 in the original dynamic programming matrix and the content of this unidimensional array 
\begin_inset Formula $D$
\end_inset

 when the row 
\begin_inset Formula $i$
\end_inset

 is being processed is:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

D(k) 
\backslash
approx D(i,k) ~~
\backslash
mbox{when}~~ k < j ~~
\backslash
mbox{(current row, $i$)}
\backslash

\backslash

\end_layout

\begin_layout Standard

D(k) 
\backslash
approx D(i-1,k) ~~
\backslash
mbox{when}~~ k 
\backslash
geq j ~~
\backslash
mbox{(previous row, $i-1$)}.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 6: Using an array to compute D(i,j)
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
hline
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
hline
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=4cm,height=4cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/hir1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=4cm,height=4cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/hir2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=4cm,height=4cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/hir3
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
hline
\end_layout

\begin_layout Standard


\end_layout

\end_inset

A 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

B 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

C 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:twoarray
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 linear space approach
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 linear space approach.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(A) Using a single array to compute 
\begin_inset Formula $D(i,j)$
\end_inset

. (B) The divide and conquer strategy applied over the dynamic programming approach. (C) The backward propagation of values.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In the optimal alignment between two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, a given element 
\begin_inset Formula $a_i$
\end_inset

 from 
\begin_inset Formula $A$
\end_inset

 will be either matched to another element 
\begin_inset Formula $b_j$
\end_inset

 from 
\begin_inset Formula $B$
\end_inset

 or aligned to a gap between a certain 
\begin_inset Formula $b_j$
\end_inset

 and 
\begin_inset Formula $b_{j+1}$
\end_inset

. Then, this optimal alignment can be decomposed in three parts:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The optimal alignment between the elements from both sequences on the left (prefixes). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The match between 
\begin_inset Formula $a_i$
\end_inset

 with a certain 
\begin_inset Formula $b_j$
\end_inset

 or a gap. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The optimal alignment between the elements from both sequences on the right (suffixes). 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

For a given 
\begin_inset Formula $i$
\end_inset

, the optimal point 
\begin_inset Formula $j$
\end_inset

 can be unveiled with the application of the algorithm to compute only the distance between two sequences in linear space time. Such a solution provides the point in which the optimal alignment path will cross the 
\begin_inset Formula $i$
\end_inset

-row in the the dynamic programming matrix. As it is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:twoarray"

\end_inset

 (B), once the points 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 are established, the general problem is divided into two subproblems and recursively the same procedure is applied until reaching the base case (empty sequences).
\end_layout

\begin_layout Standard

The algorithm that computes only the distance between two sequences in linear space is in fact a method to provide the minimum distance between the first sequence and any of the prefixes of the second sequence. As the right parts are also aligned in the main procedure, a modification of such an algorithm is necessary to obtain the minimum distance between the first sequence and any of the suffixes of the second one.
\end_layout

\begin_layout Standard

In fact, the dynamic programming scheme is not restricted to construct the final alignment from alignments between prefixes of the input sequences. The same recurrence is appropriate for building it from alignments between suffixes of them. The procedure now begins in the position 
\begin_inset Formula $D(|A|,|B|)$
\end_inset

, and propagates the values from bottom to top, and from right to left (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:twoarray"

\end_inset

 (C)). The Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sellers"

\end_inset

 must be slightly modified to accommodate this backward propagation:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i,j) = &
\end_layout

\begin_layout Standard

min 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i+1,j+1) + d(a_i,b_j) & 
\backslash
mbox{
\backslash
emph{Match}}
\backslash

\backslash

\end_layout

\begin_layout Standard

D(i+1,j) + d(a_i,-) & 
\backslash
mbox{
\backslash
emph{Gap in $B$}}
\backslash

\backslash

\end_layout

\begin_layout Standard

D(i,j+1) + d(-,b_j) & 
\backslash
mbox{
\backslash
emph{Gap in $A$}}
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. ,
\backslash

\backslash
[0.75cm]
\end_layout

\begin_layout Standard


\end_layout

\begin_layout Standard

D(i,|B|+1) = & 
\backslash
sum_{k=0}^{i}{d(a_k,-)},
\backslash

\backslash

\end_layout

\begin_layout Standard

D(|A|+1,j) = & 
\backslash
sum_{k=0}^{j}{d(-,b_k)}.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The cost of obtaining just the value 
\begin_inset Formula $D(i,j)$
\end_inset

 following the forward or the backward manner is again quadratic in terms of time. However, the cost in terms of space of this function is linear as only a single array is used in both cases.
\end_layout

\begin_layout Standard

To compute the cost of a recursive divide and conquer function, a different cost scheme must be applied. Let us consider 
\begin_inset Formula $n$
\end_inset

 the length of both input sequences that are aligned. At the beginning, the routine performs some computations and then, there is an approximate 
\begin_inset Formula $\frac{n}{2}$
\end_inset

 reduction in the size of the input data for the subsequent two recursive calls. The cost 
\begin_inset Formula $T(n)$
\end_inset

 of computing such a recursive function can be expressed in terms of its children as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

T(n) = 
\end_layout

\begin_layout Standard


\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{lll}
\end_layout

\begin_layout Standard

g(n) & 0 
\backslash
leq n < c & 
\backslash
mbox{
\backslash
emph{Base case}}
\backslash

\backslash

\end_layout

\begin_layout Standard

a T(
\backslash
frac{n}{c}) + b n^k & n 
\backslash
geq c & 
\backslash
mbox{
\backslash
emph{Recursive case}}
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right.,
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula $a$
\end_inset

 is the number of recursive calls, 
\begin_inset Formula $c$
\end_inset

 is the size of the fragmentation and 
\begin_inset Formula $b n^k$
\end_inset

 is the cost of the non-recurrent operations performed on each call. From the relationship between 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $c^k$
\end_inset

, the corresponding cost function is inferred following the Master Theorem of recurrent equations (see 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "cormen:2001a"

\end_inset

, Sections 4.3 and 4.4). In the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 recurrence is easy to notice 
\begin_inset Formula $g(n) \in O(n)$
\end_inset

, 
\begin_inset Formula $a = 2$
\end_inset

, 
\begin_inset Formula $b = 2$
\end_inset

, 
\begin_inset Formula $c = 2$
\end_inset

 and 
\begin_inset Formula $k = 2$
\end_inset

. Therefore as 
\begin_inset Formula $a<c^k$
\end_inset

 or 
\begin_inset Formula $2<2^2$
\end_inset

, according to the Master Theorem 
\begin_inset Formula $T(n) \in \Theta(n^k)$
\end_inset

, that is 
\begin_inset Formula $T(n) \in \Theta(n^2)$
\end_inset

.
\end_layout

\begin_layout Standard

Nevertheless, the spatial cost of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 algorithm is linear. All of the computations on the theoretical dynamic programming matrix are performed over single rows implemented with unidimensional arrays.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 7: Computing D(m,n) in O(n) space: FWD and RVS
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.7}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{c|c}
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.6
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
textbf{Procedure} ComputeOnlyDistanceForward
\backslash

\backslash
[0ex]
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $d$: metric on $
\backslash
Sigma$
\end_layout

\begin_layout Standard


\backslash
ENSURE $D$: array (|B|+1);
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Simulating the initialization of the 0-row}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=0$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(j) 
\backslash
leftarrow j 
\backslash
times d(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$i=1$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{diag} $
\backslash
leftarrow D(0)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Simulating the initialization of the i-row}
\end_layout

\begin_layout Standard


\backslash
STATE $D(0) 
\backslash
leftarrow i 
\backslash
times d(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{This cell will be the next diagonal}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{temp} $
\backslash
leftarrow D(j)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Match ($
\backslash
nwarrow$)}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ 
\backslash
emph{diag} $+ d(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Gap in sequence $A$ ($
\backslash
uparrow$)}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(j) + d(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Gap in sequence $B$ ($
\backslash
leftarrow$)}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(j-1) + d(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $D(j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Update diagonal}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{diag} $
\backslash
leftarrow$ 
\backslash
emph{temp}
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}
\end_layout

\begin_layout Standard

& % second column
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.6
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
textbf{Procedure} ComputeOnlyDistanceBackward
\backslash

\backslash
[0ex]
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $d$: metric on $
\backslash
Sigma$
\end_layout

\begin_layout Standard


\backslash
ENSURE $D$: array (|B|+1);
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Simulating the initialization of the last row}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=|B|$ to $1$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(j) 
\backslash
leftarrow j 
\backslash
times d(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$i=|A|-1$ to $1$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{diag} $
\backslash
leftarrow D(|B|+1)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Simulating the initialization of the i-row}
\end_layout

\begin_layout Standard


\backslash
STATE $D(|B|+1) 
\backslash
leftarrow i 
\backslash
times d(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
FOR{$j=|B|$ to $1$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{This cell will be the next diagonal}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{temp} $
\backslash
leftarrow D(j)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Match ($
\backslash
nwarrow$)}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ 
\backslash
emph{diag} $+ d(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Gap in sequence $A$ ($
\backslash
downarrow$)}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(j) + d(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Gap in sequence $B$ ($
\backslash
rightarrow$)}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(j+1) + d(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $D(j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Update diagonal}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{diag} $
\backslash
leftarrow$ 
\backslash
emph{temp}
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}
\end_layout

\begin_layout Standard


\backslash
end{tabular}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:cdistance
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An algorithm to compute 
\begin_inset Formula $D(i,j)$
\end_inset

 in 
\begin_inset Formula $O(n)$
\end_inset

 space cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An algorithm to compute 
\begin_inset Formula $D(i,j)$
\end_inset

 in 
\begin_inset Formula $O(n)$
\end_inset

 space cost.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(Left) The computation is done from 
\begin_inset Formula $D(0,0)$
\end_inset

 to 
\begin_inset Formula $D(|A|,|B|)$
\end_inset

. (Right) The computation is done from 
\begin_inset Formula $D(|A|+1,|B|+1)$
\end_inset

 to 
\begin_inset Formula $D(1,1)$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Computing the value 
\begin_inset Formula $D(i,j)$
\end_inset

 in linear space
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

To implement the fusion of the previous row and the current one in a single array in a forward manner, the temporary variables 
\emph on
diag
\emph default
 and 
\emph on
temp
\emph default
 are necessary to save the values 
\begin_inset Formula $D(i-1,j-1)$
\end_inset

 --diagonal-- and 
\begin_inset Formula $D(i-1,j)$
\end_inset

 --gap in 
\begin_inset Formula $A$
\end_inset

--, respectively. At the end of the forward computation, the array 
\begin_inset Formula $D$
\end_inset

 will contain the same values as the last row of the bidimensional classic dynamic programming matrix, that is, the distance between the sequence 
\begin_inset Formula $A$
\end_inset

 and any of the prefixes of the sequence 
\begin_inset Formula $B$
\end_inset

. In particular, the array position 
\begin_inset Formula $D(|B|)$
\end_inset

 will contain the distance between the sequences 
\begin_inset Formula $|A|$
\end_inset

 and 
\begin_inset Formula $|B|$
\end_inset


\end_layout

\begin_layout Standard

The backward computation is symmetrical to the forward processing. The propagation of values starts now in the position 
\begin_inset Formula $D(|B|+1)$
\end_inset

, moving the values from right to left, and from bottom to top. At the end of the backward computation, the array 
\begin_inset Formula $D$
\end_inset

 will contain the same values as the last row of the bidimensional reverse dynamic programming matrix, that is the distance between the sequence 
\begin_inset Formula $A$
\end_inset

 and any of the suffixes of the sequence 
\begin_inset Formula $B$
\end_inset

. In particular, the array position 
\begin_inset Formula $D(1)$
\end_inset

 will contain the distance between the sequences 
\begin_inset Formula $|A|$
\end_inset

 and 
\begin_inset Formula $|B|$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 8: The alignment of two sequences in linear space
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{0.8}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
textbf{Procedure} Alignment
\backslash

\backslash
[0ex]
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $d$: metric on $
\backslash
Sigma$; $i_1,i_2,j_1,j_2,al_1,al_2 in ~
\backslash
mathcal{Z}$
\end_layout

\begin_layout Standard


\backslash
ENSURE 
\backslash
emph{alA}: array ($al_1 .. al_2$), 
\backslash
emph{alB}: array ($al_1 .. al_2$);
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
IF{$A_{i_1,i_2} = 
\backslash
emptyset$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Base case 1}
\end_layout

\begin_layout Standard


\backslash
FOR{$k=j_1 to j_2$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{alA}$(al_1+k) 
\backslash
leftarrow -$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{alB}$(al_1+k) 
\backslash
leftarrow B(j_1+k)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE $al_2 
\backslash
leftarrow al_1 + k$;
\end_layout

\begin_layout Standard


\backslash
ELSIF{$B_{j_1,j_2} = 
\backslash
emptyset$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Base case 2}
\end_layout

\begin_layout Standard


\backslash
FOR{$k=i_1$ to $i_2$}
\end_layout

\begin_layout Standard


\backslash
STATE $alA(al_1+k) 
\backslash
leftarrow A(i_1+k)$;
\end_layout

\begin_layout Standard


\backslash
STATE $alA(al_1+k) 
\backslash
leftarrow -$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE $al_2 
\backslash
leftarrow al_1 + k$;
\end_layout

\begin_layout Standard


\backslash
ELSE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{General case}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Select the point $i$}
\end_layout

\begin_layout Standard


\backslash
STATE $i 
\backslash
leftarrow 
\backslash
lfloor 
\backslash
frac{i_1+i_2}{2} 
\backslash
rfloor$
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Compute the distance to the prefixes/suffixes of $B$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{prefDist} $
\backslash
leftarrow$ ComputeOnlyDistanceForward($A_{i_1,i},B_{j_1,j_2},d$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{suffDist} $
\backslash
leftarrow$ ComputeOnlyDistanceBackward($A_{i+1,i_2},B_{j_1,j_2},d$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{The column 0}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{posmin} $
\backslash
leftarrow j_1 -1$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{typemin} $
\backslash
leftarrow$ SPACE;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{vmin} $
\backslash
leftarrow$ 
\backslash
emph{prefDist}$(j_1-1) + d(a_i,-) +$ 
\backslash
emph{suffDist}$(j_1-1)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A sweep along the row $i$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j = j_1$ to $j_2$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Match}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{value} $
\backslash
leftarrow$ 
\backslash
emph{prefDist}$(j-1) + d(a_i,b_j) +$ 
\backslash
emph{suffDist}$(j+1)$;
\end_layout

\begin_layout Standard


\backslash
IF{
\backslash
emph{value} $<$ 
\backslash
emph{vmin}}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{vmin} $
\backslash
leftarrow$ 
\backslash
emph{value};
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{posmin} $
\backslash
leftarrow$ $j$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{typemin} $
\backslash
leftarrow$ SYMBOL;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Gap}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{value} $
\backslash
leftarrow$ 
\backslash
emph{prefDist}$(j) + d(a_i,-) +$ 
\backslash
emph{suffDist}$(j+1)$;
\end_layout

\begin_layout Standard


\backslash
IF{
\backslash
emph{value} $<$ 
\backslash
emph{vmin}}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{vmin} $
\backslash
leftarrow$ 
\backslash
emph{value};
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{posmin} $
\backslash
leftarrow$ $j$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{typemin} $
\backslash
leftarrow$ SPACE;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Divide and conquer with these values of $i$ and $j$}
\end_layout

\begin_layout Standard


\backslash
IF{
\backslash
emph{typemin} $
\backslash
leftarrow$ SPACE}
\end_layout

\begin_layout Standard


\backslash
STATE Align($A$,$B$,$d$,$i_1$,$i-1$,$j_1$,
\backslash
emph{posmin},$al_1$,$al_{tmp}$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{alA}$(al_{tmp}) 
\backslash
leftarrow A(i)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{alB}$(al_{tmp}) 
\backslash
leftarrow -$;
\end_layout

\begin_layout Standard


\backslash
STATE Align($A$,$B$,$d$,$i+1$,$i_2$,
\backslash
emph{posmin}$+1$,$j_2$,$al_{tmp}$,$al_2$);
\end_layout

\begin_layout Standard


\backslash
ELSE
\end_layout

\begin_layout Standard


\backslash
STATE Align($A$,$B$,$d$,$i_1$,$i-1$,$j_1$,
\backslash
emph{posmin}$-1$,$al_1$,$al_{tmp}$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{alA}$(al_{tmp}) 
\backslash
leftarrow -$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
emph{alB}$(al_{tmp}) 
\backslash
leftarrow B(
\backslash
mbox{
\backslash
emph{posmin}})$;
\end_layout

\begin_layout Standard


\backslash
STATE Align($A$,$B$,$d$,$i+1$,$i_2$,
\backslash
emph{posmin}$+1$,$j_2$,$al_{tmp}+1$,$al_2$);
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:linearspace
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 linear space algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 linear space algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

The divide and conquer algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 linear space algorithm is a function 
\emph on
Alignment
\emph default
 that computes the position of a given symbol 
\begin_inset Formula $a_i$
\end_inset

 from 
\begin_inset Formula $A$
\end_inset

 in the optimal alignment (aligned to a gap or to a certain 
\begin_inset Formula $b_j$
\end_inset

 from 
\begin_inset Formula $B$
\end_inset

) and then splits the general problem into two smaller subproblems (left and right halves of the corresponding sequences).
\end_layout

\begin_layout Standard

The initial call is 
\emph on
Alignment
\emph default

\begin_inset Formula $(A,B,d,1,|A|,1,|B|,0,0)$
\end_inset

 where 
\begin_inset Formula $(0,0)$
\end_inset

 are the boundaries (al
\begin_inset Formula $_1$
\end_inset

,al
\begin_inset Formula $_2$
\end_inset

) of the optimal alignment that is in construction. Additionally, a pair of arrays 
\emph on
alA, alB
\emph default
 will save the correspondence between the symbols from both sequences.
\end_layout

\begin_layout Standard

As we divide the problem into two minor parts, the base cases are the empty sequences (alignment of the rest of the symbols in one sequence with gaps in the other one). The general case selects a middle point or symbol 
\begin_inset Formula $a_i$
\end_inset

 from 
\begin_inset Formula $A$
\end_inset

. Then, the distance between the prefix 
\begin_inset Formula $A_{1,i-1}$
\end_inset

 to all of the prefixes of the sequence 
\begin_inset Formula $B$
\end_inset

 is computed by the routine 
\emph on
ComputeOnlyDistanceForward
\emph default
. The routine 
\emph on
ComputeOnlyDistanceBackward
\emph default
 likewise calculates the same value between the suffix 
\begin_inset Formula $A_{i+1,|A|}$
\end_inset

 and all of the suffixes of the sequence 
\begin_inset Formula $B$
\end_inset

.
\end_layout

\begin_layout Standard

Now, a sweep shifting 
\begin_inset Formula $j$
\end_inset

 along the whole row is perform to detect the point 
\begin_inset Formula $j$
\end_inset

 in which the alignment constituted by the prefix of 
\begin_inset Formula $A$
\end_inset

 and a given prefix of 
\begin_inset Formula $B$
\end_inset

, the symbol 
\begin_inset Formula $a_i$
\end_inset

 and a gap or a symbol 
\begin_inset Formula $b_j$
\end_inset

, and the suffix of 
\begin_inset Formula $A$
\end_inset

 and a given suffix of 
\begin_inset Formula $B$
\end_inset

 is optimal. This operation is easily implemented by accessing with the proper indexes the arrays 
\emph on
prefDist
\emph default
 and 
\emph on
suffDist
\emph default
 that were filled in by the corresponding 
\emph on
ComputeOnlyDistance
\emph default
 functions.
\end_layout

\begin_layout Standard

Once the optimal 
\begin_inset Formula $j$
\end_inset

 for the current 
\begin_inset Formula $a_i$
\end_inset

 has been found, a recursive call to discover the part of the optimal alignment on the left of this symbol is launched. Then, the conquer step assigns the correct position to 
\begin_inset Formula $a_i$
\end_inset

 aligned to a gap or a certain 
\begin_inset Formula $b_j$
\end_inset

 in the alignment (arrays 
\emph on
alA,alB
\emph default
). Finally, a second recursive call is performed to place correctly the right part of the optimal alignment.
\end_layout

\begin_layout Standard

The variables 
\emph on
posmin,vmin, typemin
\emph default
 save at each moment the minimum distance value in the loop along 
\begin_inset Formula $j$
\end_inset

 and the position and the symbol to be aligned to 
\begin_inset Formula $a_i$
\end_inset

. The type of symbol is important to correctly split the sequence 
\begin_inset Formula $B$
\end_inset

 at the divide step.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Needleman and Wunsch algorithm revisited by Smith 
\emph on
et al.
\emph default
 (1981)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "nwrevisited"

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!nwr@Needleman and Wunsch revisited
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!nwr@Needleman and Wunsch revisited
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Although the denomination of 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm and 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm have survived throughout the years, the standard formulation in terms of distance and similarity methods that is widely known today was provided by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

. In their work, they adapted the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 method to a dynamic programming recurrence complementary to that introduced by 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 and presented an analysis of equivalence between both measures (see next section).
\end_layout

\begin_layout Standard

The similarity measure did not conserve the mathematical properties of the distance metrics. Nonetheless, this revisited version of the algorithm became very popular because it was easily extended to cope with the local alignment problem (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:local"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 9: NW revisited
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $s$: substitution matrix
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Initialize the 0-column and the 0-row}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,0) 
\backslash
leftarrow i 
\backslash
times s(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(0,j) 
\backslash
leftarrow j 
\backslash
times s(b_j,-)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Filling the matrix}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=1$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Match}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow S(i-1,j-1) + s(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j-1)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Gap in sequence $B$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow S(i-1,j) + s(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $>$ max}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Gap in sequence $A$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow S(i,j-1) + s(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $>$ max}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i,j-1)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,j) 
\backslash
leftarrow$ max;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:nwrevisitedalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm revisited
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm revisited.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

If matches are positively rewarded and gaps are punished negatively, the recurrence for computing the maximum similarity between two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(i,j) = &
\end_layout

\begin_layout Standard

max 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(i-1,j-1) + s(a_i,b_j) & 
\backslash
mbox{
\backslash
emph{Match}}
\backslash

\backslash

\end_layout

\begin_layout Standard

S(i-1,j) + s(a_i,-) & 
\backslash
mbox{
\backslash
emph{Gap in $B$}}
\backslash

\backslash

\end_layout

\begin_layout Standard

S(i,j-1) + s(-,b_j) & 
\backslash
mbox{
\backslash
emph{Gap in $A$}}
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. ,
\backslash

\backslash
[0.75cm]
\end_layout

\begin_layout Standard

S(i,0) = & 
\backslash
sum_{k=0}^{i}{s(a_k,-)},
\backslash

\backslash

\end_layout

\begin_layout Standard

S(0,j) = & 
\backslash
sum_{k=0}^{j}{s(-,b_k)}.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
label{eq:sim}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where the function 
\begin_inset Formula $s(a_i,b_j)$
\end_inset

 provides a positive or a negative value for a given match (mismatch) according to the aligned elements. If this is an alignment of proteins, the function 
\begin_inset Formula $s$
\end_inset

 can be a popular amino acid substitution matrix with an additional penalty for aligning a symbol to a gap.
\end_layout

\begin_layout Standard

The cost of this revisited 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm is 
\begin_inset Formula $O(n^2)$
\end_inset

, being correct the same analysis explained in the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 approach.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

This implementation is a symmetric translation from the implementation of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm. The same procedures to fill the matrix in and to retrieve the optimal alignment are performed.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Equivalence between distance and similarity: Smith 
\emph on
et al.
\emph default
 (1981)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "simdist"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

similarity!wd@similarity and distance
\end_layout

\end_inset


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

distance!ws@distance and similarity
\end_layout

\end_inset

 From the formulation of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 similarity algorithm and the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 distance algorithm a couple of relevant questions quickly arised: (1) When are both algorithms equivalent? (2) When do they provide the same set of optimal alignments? 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981a"

\end_inset

 stated that the two algorithms are defined to be equivalent if given the scoring scheme for one algorithm, there is a choice of a scoring scheme for the second algorithm such that the set of alignments achieving the maximum similarity is equal to the set of alignments achieving the minimum distance.
\end_layout

\begin_layout Standard

Given two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, the optimal alignment 
\begin_inset Formula $\mathcal{A}$
\end_inset

 that maximizes 
\begin_inset Formula $S(A,B)$
\end_inset

 or minimizes 
\begin_inset Formula $D(A,B)$
\end_inset

 can be decomposed into two sections: the matched elements (
\begin_inset Formula $\lambda_i$
\end_inset

) and the elements in one sequence that are aligned with gaps in the other one (
\begin_inset Formula $\Delta_k$
\end_inset

):
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{c|c}
\end_layout

\begin_layout Standard

$s(a_i,b_j) = 
\backslash
alpha_k$ & $d(a_i,b_j) = 
\backslash
beta_k$
\backslash

\backslash

\end_layout

\begin_layout Standard

$g(k) 
\backslash
geq 0$ & $g'(k) 
\backslash
geq 0$
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard


\backslash
multicolumn{2}{c}{
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ll}
\end_layout

\begin_layout Standard

$
\backslash
lambda_i$ & $
\backslash
rightarrow$ 
\backslash
# of aligned symbols of type $i$
\backslash

\backslash

\end_layout

\begin_layout Standard

$
\backslash
Delta_k$ & $
\backslash
rightarrow$ 
\backslash
# of gaps of length $k$
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard


\backslash
end{tabular}}
\backslash

\backslash

\end_layout

\begin_layout Standard

$S(A,B) = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
sum_i{
\backslash
alpha_i 
\backslash
lambda_i} - 
\backslash
sum_k{g(k) 
\backslash
Delta_k}
\backslash
}$ & 
\end_layout

\begin_layout Standard

$D(A,B) = min_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} + 
\backslash
sum_k{g'(k) 
\backslash
Delta_k}
\backslash
}.$
\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
label{eq:simdist}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The following consideration that relates the length of the input sequences to the number of aligned symbols and gaps is essential for the next equations:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

|A| + |B| = 2 
\backslash
sum_i{
\backslash
lambda_i} + 
\backslash
sum_k{
\backslash
Delta_k}.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

For instance, this equation applied on the alignment
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{lcccccc}
\end_layout

\begin_layout Standard

$A:$ & A & A & T & T & C & A
\backslash

\backslash

\end_layout

\begin_layout Standard

& | & & & | & | &  
\backslash

\backslash

\end_layout

\begin_layout Standard

$B:$ & T & -- & -- & T & C & --
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

with 
\begin_inset Formula $|A|=6$
\end_inset

 and 
\begin_inset Formula $B=|3|$
\end_inset

 with three matches, one gap of two positions and one gap of one position, produces:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

$6 + 3 = 2 
\backslash
times 3 + 1 
\backslash
times 2 + 1 
\backslash
times 1$.
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

 showed that with a certain scoring model for both algorithms, the optimal alignments are equivalent. Let 
\begin_inset Formula $\alpha_M$
\end_inset

 be 
\begin_inset Formula $\alpha_M = max_i \alpha_i$
\end_inset

 (the maximum value of similarity). Then, the other scoring model must be defined as 
\begin_inset Formula $\beta_i = \alpha_M - \alpha_i$
\end_inset

. Intuitively, the higher the similarity, the lower the distance. Thus, maximum similarity (
\begin_inset Formula $\alpha_M$
\end_inset

) equals to minimum distance (
\begin_inset Formula $0$
\end_inset

). The development of the Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:simdist"

\end_inset

 produces:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(A,B) & = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
sum_i{
\backslash
alpha_i 
\backslash
lambda_i} - 
\backslash
sum_k{g(k) 
\backslash
Delta_k}
\backslash
} 
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & 
\backslash
star 
\backslash
beta_i = 
\backslash
alpha_M - 
\backslash
alpha_i 
\backslash
star
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
sum_i{(
\backslash
alpha_M - 
\backslash
beta_i) 
\backslash
lambda_i} - 
\backslash
sum_k{g(k) 
\backslash
Delta_k}
\backslash
} 
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
alpha_M 
\backslash
sum_i {
\backslash
lambda_i} - 
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} - 
\backslash
sum_k{g(k) 
\backslash
Delta_k}
\backslash
}
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & 
\backslash
star |A| + |B| = 2 
\backslash
sum_i{
\backslash
lambda_i} + 
\backslash
sum_k{
\backslash
Delta_k} 
\backslash
star
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
alpha_M (
\backslash
frac{|A|+|B|}{2} - 
\backslash
sum_k{
\backslash
frac{k}{2} 
\backslash
Delta_k}) - 
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} - 
\backslash
sum_k{g(k) 
\backslash
Delta_k}
\backslash
}
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
alpha_M (
\backslash
frac{|A|+|B|}{2}) - 
\backslash
sum_k{
\backslash
frac{
\backslash
alpha_M k}{2} 
\backslash
Delta_k} - 
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} - 
\backslash
sum_k{g(k) 
\backslash
Delta_k}
\backslash
}
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

       & = max_{
\backslash
mathcal{A}} 
\backslash
{ 
\backslash
alpha_M (
\backslash
frac{|A|+|B|}{2}) - 
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} - 
\backslash
sum_k{(
\backslash
frac{
\backslash
alpha_M k}{2} + g(k)) 
\backslash
Delta_k}
\backslash
}
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

& = 
\backslash
alpha_M (
\backslash
frac{|A|+|B|}{2}) + max_{
\backslash
mathcal{A}} 
\backslash
{- 
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} - 
\backslash
sum_k{(
\backslash
frac{
\backslash
alpha_M k}{2} + g(k)) 
\backslash
Delta_k}
\backslash
}
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

& = 
\backslash
alpha_M (
\backslash
frac{|A|+|B|}{2}) - min_{
\backslash
mathcal{A}} 
\backslash
{
\backslash
sum_i{
\backslash
beta_i 
\backslash
lambda_i} + 
\backslash
sum_k{(
\backslash
frac{
\backslash
alpha_M k}{2} + g(k)) 
\backslash
Delta_k}
\backslash
}
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard

& = 
\backslash
alpha_M (
\backslash
frac{|A|+|B|}{2}) - D(A,B).
\backslash

\backslash
[1.5ex]
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

To sum up, the minimum distance 
\begin_inset Formula $D(A,B)$
\end_inset

 is equivalent to the maximum similarity 
\begin_inset Formula $S(A,B)$
\end_inset

 when the following scoring model for the distance scheme is employed:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard


\backslash
beta_i = 
\backslash
alpha_M - 
\backslash
alpha_i
\backslash

\backslash

\end_layout

\begin_layout Standard

g'(k)= 
\backslash
frac{
\backslash
alpha_M k}{2} + g(k).
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Given the similarity scoring model 
\begin_inset Formula $(s,g(k))$
\end_inset

, the following distance scheme is therefore compatible:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{c|c}
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.45
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

s(a,b) = 
\end_layout

\begin_layout Standard


\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{lr}
\end_layout

\begin_layout Standard

0 & 
\backslash
mbox{if}~~a 
\backslash
neq b
\backslash

\backslash

\end_layout

\begin_layout Standard

1 & 
\backslash
mbox{if}~~a = b
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}
\end_layout

\begin_layout Standard

&
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.45
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

d(a,b) = 
\end_layout

\begin_layout Standard


\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{lr}
\end_layout

\begin_layout Standard

0 & 
\backslash
mbox{if}~~a = b
\backslash

\backslash

\end_layout

\begin_layout Standard

1 & 
\backslash
mbox{if}~~a 
\backslash
neq b
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}
\end_layout

\begin_layout Standard


\backslash
end{tabular}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula $\alpha_M = 1$
\end_inset

, 
\begin_inset Formula $\beta_i=1-\alpha_i$
\end_inset

, 
\begin_inset Formula $d(a,b)= 1 - s(a,b)$
\end_inset

 and 
\begin_inset Formula $g'(k)=\frac{k}{2}+g(k)$
\end_inset

.
\end_layout

\begin_layout Standard

Obviously, not all the possible 
\begin_inset Formula $s$
\end_inset

 functions will have a compatible 
\begin_inset Formula $d$
\end_inset

 counterpart (see local alignment, Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:local"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Sellers algorithm generalized by Waterman 
\emph on
et al.
\emph default
 (1976)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sellersgen"

\end_inset


\end_layout

\begin_layout Standard

From an evolutionary point of view, a single mutation event involving a gap with 
\begin_inset Formula $k$
\end_inset

 positions is more probable than the same number of distinct mutations of 
\begin_inset Formula $k$
\end_inset

 isolated spaces. In the previous algorithms, gaps have been treated as another symbol producing simple mismatches. However, longer indels should not be weighted as the sum of single indels.
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $g(k)$
\end_inset

 an arbitrary function that determines the penalty for a gap of length 
\begin_inset Formula $k$
\end_inset

, in which the existence of any relationship between the penalty of a gap having 
\begin_inset Formula $k$
\end_inset

 characters and a gap of 
\begin_inset Formula $k+1$
\end_inset

 is not assumed (general gap scoring model):
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

gap model!gen@general
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{c|c}
\end_layout

\begin_layout Standard

In 
\backslash
citeauthor{needleman:1970a} / 
\backslash
citeauthor{sellers:1974a} & A more realistic weighting scheme
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
hline
\end_layout

\begin_layout Standard

$g(k) = k g(1)$ & $g(k) 
\backslash
leq k g(1)$
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citeauthor*
after ""
before ""
key "waterman:1976a"

\end_inset

 introduced a new metric. Let 
\begin_inset Formula $\tau = \{T|T: S \rightarrow S\}$
\end_inset

 be a set of transformations (including identity) applied over an input sequence. Every transformation has an associated weight 
\begin_inset Formula $w$
\end_inset

. Given two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, a sum of weights 
\begin_inset Formula $\sum_{i=1}^{k}{w(T_i)}$
\end_inset

 can be computed for each sequence of transformations 
\begin_inset Formula $T_1,T_2, \ldots T_k$
\end_inset

 from 
\begin_inset Formula $\tau$
\end_inset

 such that 
\begin_inset Formula $T_1 \circ T_2 \circ \ldots \circ T_k (A) = (B)$
\end_inset

. The minimum sum of weights of such sequences of transformations can be viewed as the distance from 
\begin_inset Formula $A$
\end_inset

 to 
\begin_inset Formula $B$
\end_inset

 and a metric space is obtained 
\begin_inset Foot
status collapsed


\begin_layout Standard

The weights associated to every class of transformation must be non-negative.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset Formula $\tau$
\end_inset

 can be employed with different sets of transformations and weights 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1976a"

\end_inset

. Specifically, the authors defined a 
\begin_inset Formula $\tau$
\end_inset

-metric which included longer deletions and insertions, and generalize the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm for computing the new distance.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm, the optimal alignment between the prefixes 
\begin_inset Formula $A_{1,i}$
\end_inset

 and 
\begin_inset Formula $B_{1,j}$
\end_inset

 could contain a match between 
\begin_inset Formula $a_i$
\end_inset

 and 
\begin_inset Formula $b_j$
\end_inset

 or an alignment of one of them to a gap in the other sequence. In this new generalized gap model, an alignment of one of them to a gap of length 
\begin_inset Formula $k$
\end_inset

 in the other sequence is also possible.
\end_layout

\begin_layout Standard

To deal with gaps that have different scores according to their lengths, given a cell 
\begin_inset Formula $D(i,j)$
\end_inset

 in the dynamic programming matrix, all of the possible gaps of 
\begin_inset Formula $1..(i-1)$
\end_inset

 symbols (scanning a column, fixing 
\begin_inset Formula $j$
\end_inset

) and all of the possible gaps of 
\begin_inset Formula $1..(j-1)$
\end_inset

 symbols (scanning a row, fixing 
\begin_inset Formula $i$
\end_inset

) must be evaluated (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dpg"

\end_inset

).
\end_layout

\begin_layout Standard

This modification also receives the name of block indel variation because there are now three classes of implicit blocks to establish the optimal alignment between two symbols: either a match between both or an alignment between a substring of symbols in one of the sequences to a block of gaps in the other.
\end_layout

\begin_layout Standard


\begin_inset Newpage clearpage
\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.6
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/dp3
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:dpg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The generalized dynamic programming matrix
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The generalized dynamic programming matrix.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

In yellow, the part of the alignment matrix that has been computed. In blue, the part that must be still calculated. The cell 
\begin_inset Formula $D(i,j)$
\end_inset

 is the match currently in process.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The following recurrence represents the generalization of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm by 
\begin_inset CommandInset citation
LatexCommand citeauthor*
after ""
before ""
key "waterman:1976a"

\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i,j) = &
\end_layout

\begin_layout Standard

min 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i-1,j-1) + d(a_i,b_j)  & 
\backslash
mbox{
\backslash
emph{Match}}
\backslash

\backslash

\end_layout

\begin_layout Standard

min 
\backslash
{ D(i-k,j) + g(k)
\backslash
} & 
\backslash
mbox{
\backslash
emph{Gap of length $k$ in $B$}}
\backslash

\backslash
[-1.5ex]
\end_layout

\begin_layout Standard


\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq i$} & 
\backslash

\backslash

\end_layout

\begin_layout Standard

min 
\backslash
{ D(i,j-k) + g(k)
\backslash
} & 
\backslash
mbox{
\backslash
emph{Gap of length $k$ in $A$}}
\backslash

\backslash
[-1.5ex]
\end_layout

\begin_layout Standard


\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq j$} & 
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. ,
\backslash

\backslash
[0.75cm]
\end_layout

\begin_layout Standard


\end_layout

\begin_layout Standard

D(k,0) = & g(k),
\backslash

\backslash

\end_layout

\begin_layout Standard

D(0,k) = & g(k).
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The algorithm must evaluate for each cell 
\begin_inset Formula $D(i,j)$
\end_inset

, all of the previously computed cells in that row and column. If the length of the sequences is 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 respectively, the cost of performing such an alignment with a general gap scoring model is therefore 
\begin_inset Formula $O(mn (m+n))$
\end_inset

, that is, 
\begin_inset Formula $O(m^2n + mn^2)$
\end_inset

 or 
\begin_inset Formula $O(n^3)$
\end_inset

 if both sequences have the same length.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

This algorithm requires the existence of an artificial 0-column and 0-row to compute the distance when starting the alignment with gaps. Then, the algorithm starts at 
\begin_inset Formula $D(1,1)$
\end_inset

 and the matrix is filled by rows (from top to bottom) and within a row by columns (from left to right). For a given a cell 
\begin_inset Formula $D(i,j)$
\end_inset

 in the matrix, its neighbour in the diagonal 
\begin_inset Formula $D(i-1,j-1)$
\end_inset

 is evaluated (match) and additionally, all of the previous cells at that row and column must be separately visited to measure the contribution of 
\begin_inset Formula $g(k)$
\end_inset

 to their final value.
\end_layout

\begin_layout Standard

The minimum distance between both sequences will be saved at the end into the cell 
\begin_inset Formula $D(m,n)$
\end_inset

. The optimal alignment with such a distance value can be recursively retrieved from the auxiliary matrix 
\begin_inset Formula $P$
\end_inset

 that saved the direction of the alignment for each cell.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 11: Sellers algorithm generalized by WSB
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $d$: metric on $
\backslash
Sigma$; $g(k)$: gap scoring function
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Initialize the 0-column and the 0-row}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,0) 
\backslash
leftarrow g(i)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(0,j) 
\backslash
leftarrow g(j)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Filling the matrix}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=1$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Match}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow D(i-1,j-1) + d(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j-1)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Gap of length $k$ in sequence $B$}
\end_layout

\begin_layout Standard


\backslash
FOR{$k=1$ to $i-1$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(i-k,j) + g(k)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-k,j)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Gap of length $k$ in sequence $A$}
\end_layout

\begin_layout Standard


\backslash
FOR{$k=1$ to $j-1$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow D(i,j-k) + g(k)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i,j-k)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:sellersgenalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm generalized
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm generalized.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Waterman 
\emph on
et al.
\emph default
 algorithm revisited by Gotoh (1982)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "gotoh"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!goto@Gotoh
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!gotoaln@Gotoh
\end_layout

\end_inset

 Despite its cubic cost, the 
\begin_inset CommandInset citation
LatexCommand citeauthor*
after ""
before ""
key "waterman:1976a"

\end_inset

 algorithm provided a more realistic gap treatment model from the biological standpoint. Several posterior proposals were presented to reduce that cost by simplifying the gap model. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "gotoh:1982a"

\end_inset

 proposed a less general model called the affine gap scoring model in which the gap scoring function presents a linear schema based on a different penalty for opening a gap and for extending an existing one.
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $g(k)$
\end_inset

, the affine gap model to score a gap of 
\begin_inset Formula $k$
\end_inset

 positions, then 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

gap model!aff@affine
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

g(k) = 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

a, & 
\backslash
mbox{if}~ k = 1
\backslash

\backslash

\end_layout

\begin_layout Standard

a + bk, & 
\backslash
mbox{if}~k >1
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. 
\backslash
mbox{where}~ a,b 
\backslash
geq 0
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard

g(k+1) = a + b(k+1) = a +bk + b = g(k) + b.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
label{eq:gotohA}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

With such a function, if 
\begin_inset Formula $a > b$
\end_inset

 then the first space in a gap of length 
\begin_inset Formula $k$
\end_inset

 is more expensive than the rest of 
\begin_inset Formula $k-1$
\end_inset

 spaces that extend the gap. As the value 
\begin_inset Formula $g(k+1)$
\end_inset

 can be computed only using the previous value 
\begin_inset Formula $g(k)$
\end_inset

, there is no need to perform an exhaustive scanning of a given row and column for each pair 
\begin_inset Formula $i,j$
\end_inset

 in the dynamic programming matrix.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "gotoh:1982a"

\end_inset

 rewrote the general recurrence by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1976a"

\end_inset

, introducing two additional functions 
\begin_inset Formula $E$
\end_inset

 and 
\begin_inset Formula $F$
\end_inset

 that substituted the two loops along the column and the row of a given cell 
\begin_inset Formula $D(i,j)$
\end_inset

 to evaluate the gaps of length 
\begin_inset Formula $k$
\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

D(i,j) = &  min 
\backslash
{ D(i-1,j-1) + d(a_i,b_j), E(i,j), F(i,j) 
\backslash
}
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard

E(i,j) = &  min 
\backslash
{ D(i-k,j) + g(k) 
\backslash
}
\backslash

\backslash
[-1ex]
\end_layout

\begin_layout Standard

         &  
\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq i$}
\backslash

\backslash

\end_layout

\begin_layout Standard

F(i,j) = &  min 
\backslash
{ D(i,j-k) + g(k) 
\backslash
}
\backslash

\backslash
[-1ex]
\end_layout

\begin_layout Standard

         &  
\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq j$}
\backslash

\backslash

\end_layout

\begin_layout Standard

D(k,0) = & g(k),
\backslash

\backslash

\end_layout

\begin_layout Standard

D(0,k) = & g(k).
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
label{eq:gotohB}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Unfolding the value of 
\begin_inset Formula $E(i,j)$
\end_inset

 in the 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $k+1$
\end_inset

 iterations, the combination between Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:gotohA"

\end_inset

 and Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:gotohB"

\end_inset

 produced the following result 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "gotoh:1982a"

\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{lll}
\end_layout

\begin_layout Standard

E(i,j)  & = min 
\backslash
{ D(i-k,j) + g(k) 
\backslash
} & 
\backslash

\backslash
[-1ex]
\end_layout

\begin_layout Standard

        & ~~~~ 
\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq i$} & 
\backslash

\backslash

\end_layout

\begin_layout Standard

        & = min 
\backslash
{ D(i-1,j) + g(1), & min 
\backslash
{ D(i-k,j) + g(k) 
\backslash
} 
\backslash
} 
\backslash

\backslash
[-1ex]
\end_layout

\begin_layout Standard

        &                           & 
\backslash
mbox{
\backslash
tiny $2 
\backslash
leq k 
\backslash
leq i$}
\backslash

\backslash

\end_layout

\begin_layout Standard

        & = min 
\backslash
{ D(i-1,j) + a, & min 
\backslash
{ D(i-(k+1),j) + g(k+1) 
\backslash
} 
\backslash
} 
\backslash

\backslash
[-1ex]
\end_layout

\begin_layout Standard

        &                           & 
\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq i-1$}
\backslash

\backslash

\end_layout

\begin_layout Standard

        & = min 
\backslash
{ D(i-1,j) + a, & min 
\backslash
{ D(i-1-k),j) + g(k) 
\backslash
}+ b 
\backslash
} 
\backslash

\backslash
[-1ex]
\end_layout

\begin_layout Standard

        &                           & 
\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq i-1$}
\backslash

\backslash

\end_layout

\begin_layout Standard

        & = min 
\backslash
{ D(i-1,j) + a, & E(i-1,j) + b 
\backslash
} . 
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The same recursion is applied to the function 
\begin_inset Formula $F$
\end_inset

 producing
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

F(i,j)  = min 
\backslash
{ D(i,j-1) + a, F(i,j-1) + b 
\backslash
}.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Now, there are only three operations that must be performed to compute each 
\begin_inset Formula $D(i,j)$
\end_inset

: the match between both symbols, and the alignment of one of them to a gap (of any length) in the other sequence. The cost of using the affine gap scoring model is therefore 
\begin_inset Formula $O(n^2)$
\end_inset

, notably smaller than the cubic cost of the original general solution.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 12: Gotoh algorithm 
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $d$: metric on $
\backslash
Sigma$; $g(k)= a + bk$;
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Initialize the 0-column and the 0-row}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,0) 
\backslash
leftarrow g(i)$;
\end_layout

\begin_layout Standard


\backslash
STATE $E(i,0) 
\backslash
leftarrow g(i)$;
\end_layout

\begin_layout Standard


\backslash
STATE $F(i,0) 
\backslash
leftarrow g(i)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(0,j) 
\backslash
leftarrow g(j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $E(0,j) 
\backslash
leftarrow g(j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $F(0,j) 
\backslash
leftarrow g(j)$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Filling the matrix}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=1$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Update the E matrix}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow D(i-1,j) + a$;
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow E(i-1,j) + b$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $E(i,j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Update the F matrix}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow D(i,j-1) + a$;
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow F(i,j-1) + b$;
\end_layout

\begin_layout Standard


\backslash
IF{value $<$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $F(i,j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Minimum between Match, E and F}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow D(i-1,j-1) + d(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow D(i-1,j-1)$;
\end_layout

\begin_layout Standard


\backslash
IF{$ E(i,j) <$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow E(i,j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow E(i,j)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
IF{$ F(i,j) <$ min}
\end_layout

\begin_layout Standard


\backslash
STATE min $
\backslash
leftarrow F(i,j)$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow F(i,j)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,j) 
\backslash
leftarrow$ min;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:gotohalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "gotoh:1982a"

\end_inset

 algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "gotoh:1982a"

\end_inset

 algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

To implement the functions 
\begin_inset Formula $E$
\end_inset

 and 
\begin_inset Formula $F$
\end_inset

, two additional matrices are necessary. Then, the value 
\begin_inset Formula $D(i,j)$
\end_inset

 is selected (minimum) among the value of 
\begin_inset Formula $D(i-1,j-1)$
\end_inset

 (a match) and the values of 
\begin_inset Formula $E(i,j)$
\end_inset

 (a gap in the second sequence) and 
\begin_inset Formula $F(i,j)$
\end_inset

 (a gap in the first sequence).
\end_layout

\begin_layout Standard

The matrix 
\begin_inset Formula $P$
\end_inset

 is used again to maintain the pathway associated to the optimal distance between any prefix of the input sequences.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Concave gap penalty functions: Waterman (1984)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:concave"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

gap model!conc@concave
\end_layout

\end_inset

 In the affine gap penalty model, the same penalty is associated to the second space and to all of the next spaces in a gap. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "fitch:1983a"

\end_inset

 studied the behaviour of the multiple indels scoring models in the coding region of the chicken 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 hemoglobin genes. They determined that a specific range of gap penalties was necessary to obtain correct alignments. Later, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984b"

\end_inset

 formally introduced the concave gap functions.
\end_layout

\begin_layout Standard

In this scoring scheme, the gaps after the first one are not punished proportionally as in the case of the affine model. Once there is a gap, it must be biologically easier to incorporate more gaps. Let 
\begin_inset Formula $g(k)$
\end_inset

 the function that provides the penalty for a gap of length 
\begin_inset Formula $k$
\end_inset

, then:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

g(k + 1) - g(k) 
\backslash
leq g(k) - g(k-1).
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The affine model arises directly when the equality is required. Strict inequality corresponds to those increasing functions with decreasing differences between consecutive gaps, also referred to as concave downward or simply concave. For instance, the function
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

g(k) = a + b log(k) ~
\backslash
mbox{where}~ a,b 
\backslash
geq 0.
\backslash

\backslash
[2ex]
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $f(k) = a + bk$
\end_inset

 the affine gap penalty function, for a given length 
\begin_inset Formula $k$
\end_inset

 the difference with the behavior of 
\begin_inset Formula $g$
\end_inset

 is clear. For instance, if 
\begin_inset Formula $k = 16$
\end_inset

 then 
\begin_inset Formula $f(16) = a + 16b$
\end_inset

 whereas 
\begin_inset Formula $g(16) = a + b log_2(16) = a+ 4b$
\end_inset

, being less penalized this large gap in comparison to smaller gaps.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Lying between the general gap model, with a 
\begin_inset Formula $O(n^3)$
\end_inset

 cost, and the affine gap model, with a 
\begin_inset Formula $O(n^2)$
\end_inset

 cost, the concave gap problem has been proved to have an algorithm with a cost 
\begin_inset Formula $O(n^2logn)$
\end_inset

. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984b"

\end_inset

 introduced the concept and conjectured such a cost. Posteriorly, two independent groups arrived at different solutions with such a cost 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "eppstein:1988a,miller:1988a"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

A short overview on local sequence alignment
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:local"

\end_inset


\end_layout

\begin_layout Standard

Local alignments are usually more meaningful than global alignments because they only detect the patterns that are conserved in the sequences. The statistical significance of these patterns is usually evaluated. Uncommon degree of conservation of these segments in long sequences could be explained in terms of conservation of biological function.
\end_layout

\begin_layout Standard

Two alternative lines using dynamic programming approaches were proposed to rigorously detect such fragments: algorithms based on similarity and algorithms based on distance metrics. Traditionally, similarity schemes have shown to be easier to be implemented whereas distance measures are more complex to be adapted to this problem. Additional works about pattern discovery and multiple local alignments are provided in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Smith and Waterman algorithm (1981)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "localsim"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!smith@Smith and Waterman
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!smithaln@Smith and Waterman
\end_layout

\end_inset

 In a short communication, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981c"

\end_inset

 published a slight modification of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 algorithm revisited by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

 to deal with local alignments. The main objective was to find the pair of segments, one from each of two long sequences, such that there is no other pair of segments with greater similarity (homology).
\end_layout

\begin_layout Standard

The key point is to stop the traceback that starts from the cell having the maximum similarity whenever a negative similarity zone is detected. The score function 
\begin_inset Formula $s$
\end_inset

 must therefore include negative values for mismatches to provide optimal alignments with this strategy.
\end_layout

\begin_layout Standard

Posterior refinements by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1987a"

\end_inset

 allow to report the second best path disjoint from the first one, the third best and so on. Essentially, the positions of the visited previous maximum paths are marked up and a new recomputation of some parts of the matrix is done to repeat the traceback.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In this formulation, a cell 
\begin_inset Formula $S(i,j)$
\end_inset

 of the dynamic programming matrix whose value after evaluating its neighbours is negative must be automatically set to 
\begin_inset Formula $0$
\end_inset

 (the value for representing the lack of similarity of any local alignment ending at this cell). In fact, all of the positions in the matrix with a 
\begin_inset Formula $0$
\end_inset

 are candidates to become the left boundary of the optimal local alignment between two sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

.
\end_layout

\begin_layout Standard

The Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sim"

\end_inset

 is just slightly modified to accommodate this concept:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(i,j) = &
\end_layout

\begin_layout Standard

max
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(i-1,j-1) + s(a_i,b_j) & 
\backslash
mbox{
\backslash
emph{Match}}
\backslash

\backslash

\end_layout

\begin_layout Standard

S(i-1,j) + s(a_i,-) & 
\backslash
mbox{
\backslash
emph{Gap in $B$}}
\backslash

\backslash

\end_layout

\begin_layout Standard

S(i,j-1) + s(-,b_j) & 
\backslash
mbox{
\backslash
emph{Gap in $A$}}
\backslash

\backslash

\end_layout

\begin_layout Standard

0 & 
\backslash
mbox{
\backslash
emph{Segment termination}}
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. ,
\backslash

\backslash
[0.75cm]
\end_layout

\begin_layout Standard


\end_layout

\begin_layout Standard

S(i,0) = & 0,
\backslash

\backslash

\end_layout

\begin_layout Standard

S(0,j) = & 0.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

As long as the scoring function 
\begin_inset Formula $s(a,b)$
\end_inset

 with 
\begin_inset Formula $a \neq b$
\end_inset

 (mismatch) returns negative values, the similarity of every path in the matrix will increase and decrease according to the associated alignment. Once the matrix has been completed, the cell having the highest value will be the right boundary of the optimal local alignment. From this point, the rest of the maximum similarity segment must be retrieved going back until a 
\begin_inset Formula $0$
\end_inset

 is reached.
\end_layout

\begin_layout Standard

The natural generalization to support multiple insertions/deletions (
\begin_inset Formula $g(k)$
\end_inset

) is naturally derived:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(i,j) = &
\end_layout

\begin_layout Standard

max 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(i-1,j-1) + s(a_i,b_j) & 
\backslash
mbox{
\backslash
emph{Match}}
\backslash

\backslash

\end_layout

\begin_layout Standard

max 
\backslash
{ S(i-k,j) + g(k)
\backslash
} & 
\backslash
mbox{
\backslash
emph{Gap of length $k$ in $B$}}
\backslash

\backslash
[-1.5ex]
\end_layout

\begin_layout Standard


\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq i$} & 
\backslash

\backslash

\end_layout

\begin_layout Standard

max 
\backslash
{ S(i,j-k) + g(k)
\backslash
} & 
\backslash
mbox{
\backslash
emph{Gap of length $k$ in $A$}}
\backslash

\backslash
[-1.5ex]
\end_layout

\begin_layout Standard


\backslash
mbox{
\backslash
tiny $1 
\backslash
leq k 
\backslash
leq j$}  & 
\backslash

\backslash

\end_layout

\begin_layout Standard

0 & 
\backslash
mbox{
\backslash
emph{Segment termination}}
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\backslash
right. ,
\backslash

\backslash
[0.75cm]
\end_layout

\begin_layout Standard


\end_layout

\begin_layout Standard

S(i,0) = & 0,
\backslash

\backslash

\end_layout

\begin_layout Standard

S(0,j) = & 0.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Reduction to 
\begin_inset Formula $O(n^2)$
\end_inset

 can be achieved applying the 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "gotoh:1982a"

\end_inset

 results as in the global alignment case. The time cost function of the versions above is the same as in their global counterparts as no additional operations are needed.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In contrast to the global alignment algorithm, the initialization procedure reset to 
\begin_inset Formula $0$
\end_inset

 the 0-row and the 0-column. In this implementation 
\begin_inset Formula $0$
\end_inset

 means termination of current segment at the traceback process. The matrix 
\begin_inset Formula $P$
\end_inset

 is used again to save the optimal pathway of the segment maximizing similarity ending at each position of the matrix 
\begin_inset Formula $S$
\end_inset

.
\end_layout

\begin_layout Standard

To retrieve such a segment, the position 
\begin_inset Formula $S(i,j)$
\end_inset

 which contains the maximum value in the matrix is found. Then, an ordinary traceback in 
\begin_inset Formula $P$
\end_inset

 must be performed, reconstructing this local alignment until a cell whose value is 
\begin_inset Formula $0$
\end_inset

 is reached, terminating then.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 13: Smith and Waterman 
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: sequences;  $s$: substitution matrix
\end_layout

\begin_layout Standard


\backslash
STATE
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Initialize the 0-column and the 0-row}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,0) 
\backslash
leftarrow 0$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE $S(0,j) 
\backslash
leftarrow 0$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Filling the matrix}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=1$ to $|A|$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=1$ to $|B|$}
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{A. Segment termination}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow 0$;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (0,0)$;
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{B. Match}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow S(i-1,j-1) + s(a_i,b_j)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $>$ max}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j-1)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{C. Gap in sequence $B$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow S(i-1,j) + s(a_i,-)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $>$ max}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i-1,j)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{D. Gap in sequence $A$}
\end_layout

\begin_layout Standard


\backslash
STATE value $
\backslash
leftarrow S(i,j-1) + s(-,b_j)$;
\end_layout

\begin_layout Standard


\backslash
IF{value $>$ max}
\end_layout

\begin_layout Standard


\backslash
STATE max $
\backslash
leftarrow$ value;
\end_layout

\begin_layout Standard


\backslash
STATE $P(i,j) 
\backslash
leftarrow (i,j-1)$;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
STATE $S(i,j) 
\backslash
leftarrow$ max;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:swlocalalg
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "smith:1981c"

\end_inset

 algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "smith:1981c"

\end_inset

 algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Distance-based scoring schemes
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "localdist"

\end_inset


\end_layout

\begin_layout Standard

As it has been shown in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "simdist"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "smith:1981b"

\end_inset

 determined the following relationship between a metric distance 
\begin_inset Formula $D(A,B)$
\end_inset

 and a homology function 
\begin_inset Formula $S(A,B)$
\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard

S(A,B) + D(A,B) = 
\backslash
alpha_{M}
\backslash
frac{(m+n)}{2},
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

where 
\begin_inset Formula $\alpha_M$
\end_inset

 is the maximum score for a match, and 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 are the lengths of the respective sequences 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

. From this, it might seem that the problem of finding segments of maximum similarity can be simply reformulated into a problem of finding segments of minimum distance. However, several differences between both measures prevent the establishment of such an equivalence:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{mitemize}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The maximum similarity is a positive number that depends on the aligned segments. On the contrary, the minimum distance is always 
\begin_inset Formula $0$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The similarity scoring scheme typically has a negative reward for mismatches and gaps and a positive reward for matches. However, the distance metric has no positive reward for matches: the extension of an alignment with a minimum distance 
\begin_inset Formula $d$
\end_inset

 can only receive a score equal or worse than the original one (continuously growing function). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

In the similarity model, during the traceback a local alignment starting at the cell having the maximum value 
\begin_inset Formula $S(i,j)$
\end_inset

 is extended. Then, 
\begin_inset Formula $0$
\end_inset

 is employed as a limit of such an extension. In the distance model, there is not a simple minimum value 
\begin_inset Formula $D(i,j)$
\end_inset

 in the matrix to start the traceback because smaller segments would be better by definition. Furthermore, there is not here an equivalent of the 
\begin_inset Formula $0$
\end_inset

 in the similarity model during the traceback procedure. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{mitemize}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

To overcome some of these limitations, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "goad:1982a"

\end_inset

 considered to include the length of the segments in the scoring scheme as a way to favor longer alignments against shorter alignments with distance 
\begin_inset Formula $0$
\end_inset

. The mismatch density 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!almd@mismatch density
\end_layout

\end_inset

 of an alignment 
\begin_inset Formula $\mathcal{A}$
\end_inset

 between two segments is defined as the ratio of the minimum distance 
\begin_inset Formula $D$
\end_inset

 between both sequences and the length 
\begin_inset Formula $L$
\end_inset

 of the alignment. In addition, only those alignments with a mismatch density below a certain positive threshold 
\begin_inset Formula $R$
\end_inset

 must be reported:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard


\backslash
frac{D(
\backslash
mathcal{A})}{L(
\backslash
mathcal{A})} 
\backslash
leq R.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Essentially, the segment maximizing the similarity should be equivalent to a segment starting at 
\begin_inset Formula $D(i_0,j_0)$
\end_inset

 and ending at 
\begin_inset Formula $D(i,j)$
\end_inset

 with 
\begin_inset Formula $i_0 < i$
\end_inset

 and 
\begin_inset Formula $j_0 < j$
\end_inset

 such that the difference 
\begin_inset Formula $\Delta D = D(i,j) - D(i_0,j_0)$
\end_inset

 is the minimum taking into account the length of such an alignment.
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "goad:1982a"

\end_inset

 also transformed this distance scheme into a similarity scheme that must be maximized, with the following manipulations:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{l}
\end_layout

\begin_layout Standard


\backslash
frac{D(
\backslash
mathcal{A})}{L(
\backslash
mathcal{A})} 
\backslash
leq $R$ ~ 
\backslash
equiv
\end_layout

\begin_layout Standard

D(
\backslash
mathcal{A}) 
\backslash
leq R L(
\backslash
mathcal{A})  
\backslash
equiv
\end_layout

\begin_layout Standard

R L(
\backslash
mathcal{A}) - D(
\backslash
mathcal{A}) 
\backslash
geq 0.
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

First approaches
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Previously to 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "goad:1982a"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "sellers:1980a"

\end_inset

 approached the problem with an algorithm to determine the segments 
\begin_inset Formula $S$
\end_inset

 and 
\begin_inset Formula $T$
\end_inset

 such that for any aligned pair 
\begin_inset Formula $(S',T')$
\end_inset

 in a small neigbourhood, 
\begin_inset Formula $D(S,T) \leq D(S',T')$
\end_inset

. Obviously, 
\begin_inset Formula $D(S,T)$
\end_inset

 was guaranteed to be only a relative minimum in such a set of alignments. Therefore, the procedure provided many alignments like this that needed further screening.
\end_layout

\begin_layout Standard

Later, 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "goad:1982a"

\end_inset

 used the mismatch density concept to propose an algorithm in two steps. The solution is better understood if alignments are represented by paths in a lattice of points:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Use the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 global alignment algorithm to fill in the matrix 
\begin_inset Formula $D_F$
\end_inset

 (minimize distance). This formulation computes the values from left to right and from top to bottom. This form corresponds to obtain the optimal alignment using the increasing prefixes of the sequences (forward graph). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The same algorithm can be formulated in terms of suffixes of the input sequences (see the explanation about the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "hirschberg:1975a"

\end_inset

 algorithm). Then, use such an algorithm over the same sequences to fill in the matrix 
\begin_inset Formula $D_B$
\end_inset

 (backward graph). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Report those paths that were common in 
\begin_inset Formula $D_F$
\end_inset

 and 
\begin_inset Formula $D_B$
\end_inset

. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

This solution limited the number of paths but there is not a clear procedure to show that these are optimal. The cost of the algorithm is clearly 
\begin_inset Formula $O(n^2)$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Multi-sweep algorithm by Sellers (1984)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "sellers:1984a"

\end_inset

 described a more rigorous extension of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "goad:1982a"

\end_inset

 algorithm in which several iterations over a single matrix are necessary to remove the edges of the paths that are not supported in the forward o backward computations.
\end_layout

\begin_layout Standard

Given a positive constant 
\begin_inset Formula $R$
\end_inset

, the algorithm produces all paths 
\begin_inset Formula $P$
\end_inset

 such that: 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

All prefixes of 
\begin_inset Formula $P$
\end_inset

 have mismatch density less than 
\begin_inset Formula $R$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

All suffixes of 
\begin_inset Formula $P$
\end_inset

 have mismatch density less than 
\begin_inset Formula $R$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The path 
\begin_inset Formula $P$
\end_inset

 is locally maximal. The paths meeting the two previous conditions that intersect with 
\begin_inset Formula $P$
\end_inset

 have a lowest score. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The algorithm starts with a matrix 
\begin_inset Formula $G_0$
\end_inset

 in which every possible alignment of the two given sequences is represented. First, the forward procedure removes all edges of the paths not being part of any alignment
\begin_inset Foot
status collapsed


\begin_layout Standard

In the dynamic programming recurrence, each edge corresponds to a decision in the optimization step.
\end_layout

\end_inset

, creating the matrix 
\begin_inset Formula $G_1$
\end_inset

. Second, in a backward computation, all edges from 
\begin_inset Formula $G_1$
\end_inset

 not meeting the alignments of the suffixes are also erased to form the matrix 
\begin_inset Formula $G_2$
\end_inset

. Then, alternating forward and backward computations are performed over 
\begin_inset Formula $G_i$
\end_inset

, removing edges of the paths at each stage until no variation is observed. At the end, all of the disjoints paths present in the matrix are reported as local alignments or segments minimizing the mismatch density criterion.
\end_layout

\begin_layout Standard

No more than 
\begin_inset Formula $O(n)$
\end_inset

 sweeps are ever required to converge 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "myers:1991a"

\end_inset

. As every forward or backward operation takes 
\begin_inset Formula $O(n^2)$
\end_inset

 time, the final cost of the approach by 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1984a"

\end_inset

 is 
\begin_inset Formula $O(n^3)$
\end_inset

, notably higher than the 
\begin_inset Formula $O(n^2)$
\end_inset

 cost of the simple 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "smith:1981c"

\end_inset

 design.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Databases searches
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!alndb@databases searches
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

databases searches
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The information available at the sequence databases is useful to infer the function of similar sequences. Anonymous sequences can be aligned to other sequences whose function, structure or biochemical activity is known. As explained in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genomics"

\end_inset

, the size of such databases grows exponentially since the very first days of computational sequence analysis.
\end_layout

\begin_layout Standard

It is important to mention that from now on the term database simply refers to a large collection of sequences. It does not imply any extra capabilities of fast access, data sharing, and so on, commonly found in standard database management systems.
\end_layout

\begin_layout Standard

Ordinary alignment algorithms based on dynamic programming are very inefficient to search large collections of sequence because of their quadratic time cost. Novel methods based on heuristics have been employed to reduce in several orders of magnitude the time to align two sequences, providing near optimal results. The search on a database for sequences that are similar to a query sequence usually performs hundreds of thousands of such alignments.
\end_layout

\begin_layout Standard

This search typically provides a list of sequences with which the query sequence can be aligned better, using certain quality score function. These results can be expanded using each sequence found before to find more distant relatives of the initial sequences.
\end_layout

\begin_layout Standard

To speed the search, the sequences of the database are usually preprocessed to store computations about their content (usually word distribution) that will be used during the future searching operations.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

FASTA
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!fasta@FASTA
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!fastaaln@FASTA
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

FASTA
\end_layout

\end_inset

 The FAST family of algorithms is a group of heuristic methods for string comparison, specially to compare a query sequence with each sequence on a database. 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "lipman:1985a,pearson:1988a"

\end_inset

. The FASTA program that is included on such a package is entirely based on the following assumption: good local alignments are likely to contain exact matching subsequences. The FASTA strategy is therefore to locate firstly the segments of both sequences richer in exact matches and secondly, try to reconstruct the final alignment using these specific regions.
\end_layout

\begin_layout Standard

The FASTA processing is divided into four main steps (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:fasta"

\end_inset

) that are repeated to compare the query sequence to each sequence in the database:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Detection of regions of identity. Determine the words of length 
\begin_inset Formula $k$
\end_inset

 (
\emph on
k-tuples
\emph default
) that are common to both sequences. The offset of an exact word match between a substring 
\begin_inset Formula $s$
\end_inset

 starting at position 
\begin_inset Formula $x$
\end_inset

 and a substring 
\begin_inset Formula $t$
\end_inset

 starting at position 
\begin_inset Formula $y$
\end_inset

 is defined as the difference 
\begin_inset Formula $x - y$
\end_inset

. Matches that are located in the same diagonal of the dotplot comparison have the same offset value (see (A) in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:fasta"

\end_inset

). An array addressed by the offsets is used to locate those diagonals with more exact matches.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 15: FASTA matrices (diagonals)
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/fasta
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:fasta
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Identification of sequence similarities by FASTA
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Identification of sequence similarities by FASTA.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "pearson:1988a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

During the preprocessing of each sequence in the database, a hash table is used to store where each word of length 
\begin_inset Formula $k$
\end_inset

 is appearing along such a sequence 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "dumas:1982a"

\end_inset

. Then, the query sequence is scanned and each 
\emph on
k-tuple
\emph default
 in it is looked up in the hash table. For all common occurrences, the entry of the corresponding offset is incremented.
\end_layout

\begin_layout Standard

Next, each offset is analyzed to merge those exact matches in the same diagonal that are in close proximity (without introducing gaps, including intervening sequence). These merged regions do not contain any insertions or deletions because they are derived from a single diagonal. The score of these diagonal regions is the sum of the exact matches scores combined with a penalty that increases with the distance among them. According to this scoring scheme, the 10 best diagonal regions are selected to constitute the future local alignment (see (B) in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:fasta"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Re-scoring. The 10 best diagonals are evaluated again using an amino acid (or nucleotide) substitution matrix to allow conservative replacements and exact matches shorter than 
\begin_inset Formula $k$
\end_inset

 to contribute to the similarity score. The diagonal region with maximal score is identified (highest scoring initial region). Those regions whose score is below a given threshold are discarded (see (C) in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:fasta"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Optimal alignment of diagonal regions. The regions from compatible diagonals are combined following certain rules. The segments that are close to each other (not in the same diagonal) can be part of an alignment whose score is a function of a joining penalty (moving from one diagonal to other involves gap introduction), their scores and their location. The optimal alignment initial region is a combination of compatible regions with maximal score. This score is a reference to rank the library of sequences according to their similarity to the query (see (D) in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:fasta"

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The highest scoring library sequences are finally aligned with a modification of the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "needleman:1970a"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "smith:1981c"

\end_inset

 algorithms. Using dynamic programming, all possible alignments of the query and each sequence in the database that fall within a band centered around the highest scoring initial region are considered. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 16: BLAST
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/blast
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:blast
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

BLAST processing
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

BLAST processing.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "pertsemlidis:2001a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

BLAST
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!blast@BLAST
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!blastaln@BLAST
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

BLAST
\end_layout

\end_inset

 As FASTA, the BLAST family programs 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "altschul:1990a,altschul:1997a"

\end_inset

 are able to achieve a substantial gain in terms of speed by searching first for common words or 
\begin_inset Formula $k$
\end_inset

-tuples in the query and in each database sequence. However, FASTA searches for all possible words of the same length whereas BLAST limits the search to those that are the most significant by integrating a substitution matrix in this step.
\end_layout

\begin_layout Standard

The central concept of the BLAST strategy is the neighbourhood of a sequence. The 
\begin_inset Formula $T$
\end_inset

-neighbourhood of a word 
\begin_inset Formula $w$
\end_inset

 is the set of all sequences of the same length that align to 
\begin_inset Formula $w$
\end_inset

 with score better than 
\begin_inset Formula $T$
\end_inset

. Such an alignment is gapless and the similarity score is the sum of the similarity values for each pair of aligned residues. Thus, searching a match between a given word in the query and other word in a sequence of the database is equivalent to searching a match between a neighbour of the original word in the query with a score greater than 
\begin_inset Formula $T$
\end_inset

 and the same word in the other sequence. BLAST will only seek in the database for those significant words that would form with 
\begin_inset Formula $w$
\end_inset

 a pair with a score of at least 
\begin_inset Formula $T$
\end_inset

, if any.
\end_layout

\begin_layout Standard

As a substitution matrix is used to score this alignment, the words where conservative substitutions have been introduced can also obtain a high score because the matches with them also may be biologically informative. In addition, different amino acid identities are not scored in the same manner: for instance, the alignment between a query word composed by very common amino acids and itself might not achieve a score better than 
\begin_inset Formula $T$
\end_inset

, and therefore it would not be included in the search process 
\begin_inset Foot
status collapsed


\begin_layout Standard

BLAST allows the user to force the inclusion of the original words in the following steps.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard

Whenever one of these significant words is found in one entry of the database, the respective word 
\begin_inset Formula $w$
\end_inset

 in the query and the detected neighbour are aligned and form the seed of a segment pair that will be enlarged later. If the extended segment pair is assigned a score better than 
\begin_inset Formula $S$
\end_inset

, such a sequence is reported to be similar to the query.
\end_layout

\begin_layout Standard

The BLAST pipeline is constituted by these steps (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:blast"

\end_inset

) that are repeated to compare the query sequence to each sequence in the database:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The query sequence is filtered to remove low-complexity regions (repeats) that can distort the word search (optional) to produce significant alignments. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Generate the 
\begin_inset Formula $T$
\end_inset

-neighbourhood of every word of length 
\begin_inset Formula $k$
\end_inset

 in the query sequence. Given a word 
\begin_inset Formula $w$
\end_inset

, the matches between any other combination of 
\begin_inset Formula $k$
\end_inset

 amino acids and 
\begin_inset Formula $w$
\end_inset

 are evaluated with a substitution matrix. For instance, if 
\begin_inset Formula $k=3$
\end_inset

, there are 
\begin_inset Formula $8000$
\end_inset

 possible words to align with 
\begin_inset Formula $w$
\end_inset

. The neighbours are ranked according to the score of this alignment. A deterministic finite automaton is constructed to recognize the language of the high-scoring neighbours (the most significant ones). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

See if any sequence in the database contains one of these strings with the automaton constructed before (a match). 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Every match is used as a seed to find a locally maximal segment pair containing that hit, also called a maximal segment pair (MSP). The alignment between both words in their respective sequences is extended in each direction along the respective sequences, continuing the extension as long as the score does not fall more than a drop-off threshold. Such a score is a cumulative value resulting from evaluating with a substitution matrix the matches, mismatches and gaps of the alignment. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

BLAST reports the database sequences with MSPs above a certain threshold 
\begin_inset Formula $S$
\end_inset

 (the high-scoring segment pairs or HSPs). Such significant value is computed for each database according to the size of the query and the database, being unlikely to find a random sequence that achieves a score better than 
\begin_inset Formula $S$
\end_inset

 when compared with the query 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "karlin:1990a"

\end_inset

. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The procedure is heuristic: only word pairs with a score above the threshold 
\begin_inset Formula $T$
\end_inset

 can be the core of local similarity regions. Therefore, a segment pair of score better than 
\begin_inset Formula $S$
\end_inset

 that does not contain any subsequence of length 
\begin_inset Formula $k$
\end_inset

 with a score greater than 
\begin_inset Formula $T$
\end_inset

 will not be detected. In addition, the selection of the parameters is not trivial: this method is feasible in practice only when the values of 
\begin_inset Formula $k$
\end_inset

, 
\begin_inset Formula $T$
\end_inset

 and 
\begin_inset Formula $S$
\end_inset

 are carefully chosen 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "altschul:1990a,myers:1991a"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%% MSA
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

A short overview on multiple sequence alignment
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:msa"

\end_inset


\end_layout

\begin_layout Standard

From a simplistic point of view, a multiple sequence alignment (MSA) is a rectangular 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!mul@multiple
\end_layout

\end_inset

 array of sequences optimally arranged to obtain the greatest number of similar characters on each column of the alignment. From a evolutionary perspective, however, the alignment of multiple sequences is intimately related to the study of molecular evolution. For example, the number and the class of changes in the residues of a MSA may be used to develop a preliminar phylogenetic analysis. Each column in the alignment of a set of sequences may predict the mutations that occurred at one site during the evolution of such a sequence family, revealing which positions in the sequences were conserved and which diverged from a common ancestor sequence.
\end_layout

\begin_layout Standard

The natural extension of the pairwise dynamic programming recurrence produces a multidimensional representation of the similarity matrix, being not possible to be implemented in practice (see the example for three sequences in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hyper"

\end_inset

 (A)). Because of its 
\begin_inset Formula $O(n^k)$
\end_inset

 cost, where 
\begin_inset Formula $k$
\end_inset

 is the number of sequences and 
\begin_inset Formula $n$
\end_inset

 is the length of them 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1976a"

\end_inset

), several approaches have tried to circumvent such a problem by introducing some heuristic functions.
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "carrillo:1988a"

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!carr@Carrillo and Lipman
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!carraln@Carrillo and Lipman
\end_layout

\end_inset

 developed a method assuming that the optimal MSA can be constructed from the best pairwise alignments between each pair of sequences (the projections). Thus, each optimal pairwise alignment defines a set of spatial positions within which the optimal MSA is supposed to be when projected on such a plane (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hyper"

\end_inset

 (B) and (C)).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure Xtra1: 
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

A 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

B 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

C
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=4cm,height=4cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/3dcube
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=5cm,height=4cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/lipman0
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=4cm,height=4cm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/lipman1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:hyper
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Generalized MSA dynamic programming matrix
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Generalized MSA dynamic programming matrix.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(A) The 
\begin_inset Formula $O(n^2)$
\end_inset

 matrix is generalized into a 
\begin_inset Formula $O(n^k)$
\end_inset

 matrix in a multiple sequence alignment. (B) The projection of the optimal MSA into one of the pairwise alignments 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "carrillo:1988a"

\end_inset

. (C) The optimal MSA alignment projected into all of the pairwise alignments 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "carrillo:1988a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The generalization to multiple alignment also induced a problem in the dimension of the substitution matrices and in the form of scoring an alignment in general. Let 
\begin_inset Formula $k$
\end_inset

 be the number of aligned characters in a column of a MSA. In principle, 
\begin_inset Formula $2^k-1$
\end_inset

 combinations with such elements are possible, but a substitution matrix of such dimensions would be absolutely unfeasible. The ordinary approach when scoring a MSA is usually the sum of pairs (the SP-score) that weights the 
\begin_inset Formula $n^2$
\end_inset

 combinations between two elements in the same column with a normal substitution matrix to provide a final score.
\end_layout

\begin_layout Standard

The hierarchical or clustering method called progressive alignment rapidly 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!progaln@progressive
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

progressive alignment
\end_layout

\end_inset

 became popular because of its simplicity and biological feasibility 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "feng:1987a"

\end_inset

. This strategy initially selects the best pairwise alignment and progressively incorporates the rest of sequences to this alignment. However, this dependence on the first alignment produces somehow a loss of flexibility in the rest of the subsequent alignments as most of the conserved positions in such an alignment are preserved throughout the process. The order of sequence selection relies on the creation of a phylogenetic tree that guides the process to create the MSA. There are several well-known techniques to infer the best tree for a set of sequences. Distance based methods are based on minimizing the number of global changes between each pair of input sequences. The neighbour-joining algorithm 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "saitou:1987a"

\end_inset

 is a distance based method that first joins the clusters of sequences that are close to each other and apart from the rest, minimizing the sum of the branch lengths in the final tree.
\end_layout

\begin_layout Standard

The program CLUSTALW 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "thompson:1994a"

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

CLUSTALW
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!clustalw@CLUSTALW
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

alignment!clustalwaln@CLUSTALW
\end_layout

\end_inset

 incorporates a number of improvements to the progressive alignment implementation. In an initial round, all of the pairwise alignments are performed to calculate a distance matrix in 
\begin_inset Formula $O(k^2 n^2)$
\end_inset

. A guide tree is constructed from this matrix using the neighbour-joining method. An initial alignment starting with the two most related sequences is then constructed. Finally, the sequences are gradually aligned according to the branching order in the guide tree (see the complete process in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:clustalw"

\end_inset

).
\end_layout

\begin_layout Standard

During the construction of the tree, CLUSTALW assigns weights to the sequences to correct unfair sampling across all evolutionary distances in the data set. Highly divergent sequences without close relatives receive high weights. For instance, the weight 0.221 for the Hbb_Human gene in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:clustalw"

\end_inset

 is calculated in this form:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard

$$
\end_layout

\begin_layout Standard

0.221 = 0.081 + 
\backslash
frac{0.226}{2} + 
\backslash
frac{0.061}{4} + 
\backslash
frac{0.015}{5} + 
\backslash
frac{0.062}{6}
\end_layout

\begin_layout Standard

$$
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

In addition, different substitution matrices are used on every stage of the alignment. Position-specific gap penalties that depend on several factors such as the existence of other gaps, the type of residues or the length of the sequences are also used during the alignment.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure Xtra2: 
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.6
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/clustalwproc
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:clustalw
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The basic CLUSTALW alignment procedure
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The basic CLUSTALW progressive alignment procedure.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "thompson:1994a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The dynamic programming recurrence must be now adapted to allow the alignment between two profiles or clusters of sequences that have been previously aligned. The score of the alignment between a column in a first alignment and a column in a second alignment is the average of all of the pairwise substitution matrix scores from the residues in the two sets of sequences multiplied by the weight of the sequences. Let 
\begin_inset Formula $C_i$
\end_inset

 and 
\begin_inset Formula $C_j$
\end_inset

 be two multiple alignments: 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

C_i = 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}
\end_layout

\begin_layout Standard

{lr}
\end_layout

\begin_layout Standard

x_1^1 
\backslash
ldots x_1^{l_i}
\backslash

\backslash

\end_layout

\begin_layout Standard

~~~ 
\backslash
vdots ~~~~ 
\backslash
vdots
\backslash

\backslash

\end_layout

\begin_layout Standard

x_{| i |}^1 
\backslash
ldots x_{| i |}^{l_i}
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
right.
\end_layout

\begin_layout Standard

~~~~~
\end_layout

\begin_layout Standard

C_j = 
\backslash
left
\backslash
{
\end_layout

\begin_layout Standard


\backslash
begin{array}
\end_layout

\begin_layout Standard

{lr}
\end_layout

\begin_layout Standard

y_1^1 
\backslash
ldots y_1^{l_j}
\backslash

\backslash

\end_layout

\begin_layout Standard

~~~ 
\backslash
vdots ~~~~ 
\backslash
vdots
\backslash

\backslash

\end_layout

\begin_layout Standard

y_{|j|}^1 
\backslash
ldots y_{|j|}^{l_j}
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
right.
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $p \in C_i, q \in C_j$
\end_inset

, two columns of the previous alignments. The score 
\begin_inset Formula $S(C_i^p,C_j^q)$
\end_inset

 of the alignment between both columns is computed as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard

S(C_i^p,C_j^q) = 
\backslash
frac{
\end_layout

\begin_layout Standard


\backslash
sum_{r=1}^{|i|} 
\backslash
sum_{s=1}^{|j|} w_r 
\backslash
cdot w_s 
\backslash
cdot M(x_r^p,y_s^q)}{|i||j|}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

All of the methods above produce a global multiple sequence alignment. Local alignment of several sequences is intimately related to motif finding techniques, all of them heuristics. In Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:genefinding"

\end_inset

, there is a brief overview about several pattern discovery methods.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%% END MSA
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
sectionorange
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:enzymes"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Restriction enzymes and genomic maps
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

restriction enzymes
\end_layout

\end_inset

 The DNA molecules in a cell can be randomly broken into small pieces by mechanical forces. However, the probability of randomly breaking a molecule to produce a fragment that contains a gene is null. Restriction nucleases, which can be purified from bacteria, are enzymes that cut the DNA double helix at specific sites defined by the local nucleotide sequence, producing DNA fragments of defined sizes 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "alberts:1994a"

\end_inset

. In fact, every nuclease recognizes a specific sequence of four to eight nucleotides (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:enzymes"

\end_inset

 for examples).
\end_layout

\begin_layout Standard

Different species of bacteria make restriction nucleases with different sequence specificities. More than 100 nucleases are now available commercially. It is relatively simple to find a restriction nuclease that create a DNA fragment including a particular gene 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "alberts:1994a"

\end_inset

.
\end_layout

\begin_layout Standard

After treatment with a combination of several restriction nucleases, a restriction map of a particular 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

restriction map
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

maps
\end_layout

\end_inset

 genetic region can be constructed showing the location of each restriction site in relation to the neighbour sites (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:gmap"

\end_inset

 for an example of map comparison). The sites thus act as genetic markers and the map reflects their arrangement in the region. This arrangement allow the comparison of the same region of DNA in different species without having to determine the nucleotide sequence in detail 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "alberts:1994a"

\end_inset

. Indeed, mutations at a single letter of a sequence of DNA can cause the appearance or disappearance of a restriction site.
\end_layout

\begin_layout Standard


\begin_inset Newpage clearpage
\end_inset

Common problems involving restriction maps are: 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{mitemize}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Prior to genomic sequencing projects, to organize genomic DNA, one approach was to make restriction maps of relatively small pieces to utilize these maps later to determine overlap of pieces and thus construct a map that includes larger parts of the genome. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The fragment lengths from a digestion of a DNA sequence can be measured after using two enzymes separately, or by both applied together. The problem of determining the positions of the cuts from fragment length data is known as the Double Digest Problem 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "schmitt:1991a"

\end_inset

. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{mitemize}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 17: CELL figure 7.1. pg 292 
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="4">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.2
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/enzyme1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.2
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/enzyme2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.2
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/enzyme3
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.2
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/enzyme4
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:enzymes
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

DNA nucleotide sequences recognized by restriction nucleases
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The DNA nucleotide sequences recognized by four widely used restriction nucleases.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "alberts:1994a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

A more general definition can be considered. Genomic mapping 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

genomic mapping
\end_layout

\end_inset

 is the process of determining where an object of biological interest (e.g. a marker, a gene, a genomic variation, or a disease predisposition locus) lies within a defined genomic sequence. Such a map therefore describes biological attributes of each genomic position (see 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "white:2005a"

\end_inset

 for a comprehensive introduction about mapping concepts).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

Map alignments
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:maps"

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

map alignment
\end_layout

\end_inset


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

maps!maln@alignments
\end_layout

\end_inset

 Given a sequence 
\begin_inset Formula $S$
\end_inset

 of 
\begin_inset Formula $m$
\end_inset

 symbols, a site 
\begin_inset Formula $a_i=(r_i,p_i)$
\end_inset

 is an element of a certain type 
\begin_inset Formula $r_i$
\end_inset

 mapped on a certain position 
\begin_inset Formula $p_i$
\end_inset

 relative to the origin of 
\begin_inset Formula $S$
\end_inset

. A map 
\begin_inset Formula $A$
\end_inset

 is then defined as an ordered set of 
\begin_inset Formula $n$
\end_inset

 sites such that: 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard

$A = a_1 a_2 
\backslash
ldots a_n$ where $
\backslash
forall i: 1 
\backslash
leq i 
\backslash
leq n: a_i=(r_i,p_i)$, $r_i 
\backslash
in 
\backslash
Sigma_{sites}, 1 
\backslash
leq p_i 
\backslash
leq p_{i+1} 
\backslash
leq m$
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 first defined the notion of map comparison using alignments and developed an algorithm that handles the distances between the sites as well as the linear sequence of sites. If intersite distances were ignored, then the 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "sellers:1974a"

\end_inset

 algorithm could be immediately applied to align two maps 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "huang:1992a"

\end_inset

.
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $A = a_1 a_2 \ldots a_m$
\end_inset

 and 
\begin_inset Formula $B = b_1 b_2 \ldots b_n$
\end_inset

 be to maps of 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 sites respectively with 
\begin_inset Formula $a_i=(r_i,p_i)$
\end_inset

 and 
\begin_inset Formula $b_j=(s_j,q_j)$
\end_inset

. An alignment of 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is a sequence of ordered matching pairs of sites 
\begin_inset Formula $(a_{i_1},b_{j_1})(a_{i_2},b_{j_2}) \ldots (a_{i_T},b_{j_T})$
\end_inset

 such that:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset


\begin_inset Formula $(a_i,b_j) \in C$
\end_inset

 if and only if 
\begin_inset Formula $r_i = s_j$
\end_inset

 (that is, two elements are aligned if and only if they correspond to the same site).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

if 
\begin_inset Formula $(a_i,b_j) \in C$
\end_inset

 then there are no other elements 
\begin_inset Formula $b_l (l \neq j)$
\end_inset

 in 
\begin_inset Formula $B$
\end_inset

 such that 
\begin_inset Formula $(a_i,b_l) \in T$
\end_inset

, nor elements 
\begin_inset Formula $a_k (k \neq i)$
\end_inset

 in 
\begin_inset Formula $A$
\end_inset

 such that 
\begin_inset Formula $(a_k,b_j) \in T$
\end_inset

 (that is, each element in 
\begin_inset Formula $A$
\end_inset

 is aligned at most to one element in 
\begin_inset Formula $B$
\end_inset

, and vice versa)
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

if 
\begin_inset Formula $(a_i,b_j) \in C$
\end_inset

 and 
\begin_inset Formula $(a_k,b_l) \in C$
\end_inset

 and 
\begin_inset Formula $i<k$
\end_inset

 then 
\begin_inset Formula $j<l$
\end_inset

 (that is, the alignment maintains the colinearity between the sequence 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

). 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

For instance, this is an example of a map alignment between the maps 
\begin_inset Formula $A=\{(B,1)(D,15)(A,20)(E,32)(D,50)(F,95)\}$
\end_inset

 and 
\begin_inset Formula $B=\{(B,5)(D,17)(D,47)(C,78)(A,87)(F,92)\}$
\end_inset

: 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

map alignment!mexam@example
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{center}
\end_layout

\begin_layout Standard


\backslash
begin{tabular}{ccccccccc}
\end_layout

\begin_layout Standard

$A = $ & (B,1) & (D,15) & (A,20) & (E,32) & (D,50) & --     & --     & (F,95)
\backslash

\backslash

\end_layout

\begin_layout Standard

       &   |   &   |    &        &        & |      &        &        & | 
\backslash

\backslash

\end_layout

\begin_layout Standard

$B = $ & (B,5) & (D,17) & --     & --     & (D,47) & (C,78) & (A,87) & (F,92).
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{tabular}
\end_layout

\begin_layout Standard


\backslash
end{center}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $\alpha$
\end_inset

 be the reward given to each matching pair (optional), let 
\begin_inset Formula $\lambda$
\end_inset

 be the penalty associated to each unaligned site from both maps and let 
\begin_inset Formula $\mu$
\end_inset

 be the penalty associated to the discrepancy in distance between adjacent aligned pairs 
\begin_inset Formula $(a_{i_{t-1}},b_{i_{t-1}})$
\end_inset

 and 
\begin_inset Formula $(a_{i_t},b_{i_t})$
\end_inset

. Then, the score of the map alignment 
\begin_inset Formula $C$
\end_inset

 between maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 that contains 
\begin_inset Formula $T$
\end_inset

 matched pairs is defined to be:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

S(C) = & 
\backslash
alpha T
\backslash

\backslash

\end_layout

\begin_layout Standard

& - 
\backslash
lambda (m+n-2T)
\backslash

\backslash

\end_layout

\begin_layout Standard

& - 
\backslash
mu (|q_{i_1}-p_{i_1}|)
\backslash

\backslash

\end_layout

\begin_layout Standard

& - 
\backslash
mu 
\backslash
sum_{t=2}^{T}{(|(p_{i_t}-p_{i_{t-1}}) - (q_{i_t}-q_{i_{t-1}})|)}
\backslash

\backslash

\end_layout

\begin_layout Standard

& - 
\backslash
mu (|(p_{i_m}-p_{i_T}) - (q_{i_n}-q_{i_T})|).
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

That is, the score of the alignment increases with the score of the matches of the aligned elements (
\begin_inset Formula $\alpha$
\end_inset

, optional), and decreases with the number of elements not in the alignment (
\begin_inset Formula $\lambda$
\end_inset

), and with the difference in the distance between matches of consecutive aligned elements (
\begin_inset Formula $\mu$
\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Waterman 
\emph on
et al.
\emph default
 map alignment algorithm (1984)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!wmap@Waterman, Smith and Katcher
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

map alignment!wmapaln@Waterman, Smith and Katcher
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

 firstly formalized the problem of map alignment and introduced an algorithm distinct from usual sequence comparison algorithms, to investigate the relationships among restriction maps of homologous regions.
\end_layout

\begin_layout Standard

This algorithm yields a measure of distance between two maps and provides an alignment of them. Such a distance is the minimum weighted sum of genetic events required to convert one map into the other, where the genetic events are the appearance/disappearance of restriction sites and changes in the number of bases between them. Mutations from one site to other are ignored because this event was considered to be unlikely 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1984c"

\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 18: paper waterman pag. 239
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.8
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/map
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:gmap
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

A restriction map alignment
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

A restriction map alignment including the 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\delta$
\end_inset

 globin genes from the lowland Gorilla and the Owl Monkey.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984c"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $A = a_1 a_2 \ldots a_m$
\end_inset

 be a map of sites where each pair 
\begin_inset Formula $a_i=(r_i,p_i)$
\end_inset

 represents the restriction site 
\begin_inset Formula $r_i$
\end_inset

 occurring at position 
\begin_inset Formula $p_i$
\end_inset

 of a sequence of nucleotides, let 
\begin_inset Formula $B = b_1 b_2 \ldots b_n$
\end_inset

 be a second map of sites denoted as 
\begin_inset Formula $b_j=(s_j,q_j)$
\end_inset

: a map alignment between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is a correspondence 
\begin_inset Formula $(a_{i_1},b_{j_1})(a_{i_2},b_{j_2}) \ldots (a_{i_T},b_{j_T})$
\end_inset

 in which two sites 
\begin_inset Formula $a_{i_t}$
\end_inset

 and 
\begin_inset Formula $b_{j_t}$
\end_inset

 constitute a match if they correspond to the same type of restriction site (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:gmap"

\end_inset

 for an example).
\end_layout

\begin_layout Standard

To measure the distance between two maps, two events must be taken into account: 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Each site from 
\begin_inset Formula $A$
\end_inset

 and from 
\begin_inset Formula $B$
\end_inset

 that is not aligned receives a weight 
\begin_inset Formula $\lambda$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The number of bases between every pair of aligned sites in 
\begin_inset Formula $A$
\end_inset

 that changes by 
\begin_inset Formula $x$
\end_inset

 bases in 
\begin_inset Formula $B$
\end_inset

 receives the weight 
\begin_inset Formula $\mu(x)$
\end_inset

. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $D(i,j)$
\end_inset

 the minimum sum of weights of events required to convert the map 
\begin_inset Formula $A$
\end_inset

 into the map 
\begin_inset Formula $B$
\end_inset

 where the site 
\begin_inset Formula $a_i$
\end_inset

 is equal to the site 
\begin_inset Formula $b_j$
\end_inset

 (otherwise 
\begin_inset Formula $D(i,j) = \infty$
\end_inset

). Then, 
\begin_inset Formula $D(i,j)$
\end_inset

 is calculated as
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
noindent
\backslash
negr{if ($f_i$ = $g_j$) then}
\backslash

\backslash
[1ex]
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset Formula \begin{equation}
\fcolorbox{white}{verylightgreen}{
\begin{minipage}[][][c]{0.95\linewidth}
\end{minipage}\begin{array}{ccc}
D(i,j) = & min_{i',j'} & \{D(i',j') + \lambda (i - i' - 1 + j - j'- 1) + \mu
(p_i - p_{i'} - q_j + q_{j'})\}.\\[-1ex]
& \scalebox{0.7}{\mbox{$0 < i' < i$}} & \\[-1ex]
& \scalebox{0.7}{\mbox{$0 < j' < j$}} & \\
\end{array}}
\label{eq:map}
\end{equation}
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

center
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
noindent 
\backslash
negr{otherwise}
\backslash

\backslash

\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%~~~~~~~~S_{ij} = -
\backslash
infty.
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard

Thus, the optimal alignment ending at a given pair 
\begin_inset Formula $(a_i,b_j)$
\end_inset

, where 
\begin_inset Formula $r_i$
\end_inset

 is equal to 
\begin_inset Formula $s_j$
\end_inset

, is optimally computed by:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Searching among the alignments ending at previous matches 
\begin_inset Formula $(a_{i'},b_{j'})$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

Evaluating the value 
\begin_inset Formula $D(i,j)$
\end_inset

 if the pair 
\begin_inset Formula $(a_{i'},b_{j'})$
\end_inset

 was placed immediately before the current pair 
\begin_inset Formula $(a_i,b_j)$
\end_inset

 in the optimal alignment in construction. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Note that to compute the optimal score at 
\begin_inset Formula $D(i,j)$
\end_inset

 with this algorithm, all the cells 
\begin_inset Formula $D(k,l)$
\end_inset

 with 
\begin_inset Formula $k<i$
\end_inset

 and 
\begin_inset Formula $l<j$
\end_inset

 need to be explored. Therefore, if the length of the two maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 respectively, the cost of computing 
\begin_inset Formula $D(A,B)=D(a_m,b_n)$
\end_inset

 is 
\begin_inset Formula $O(mn \cdot mn) = O(m^2n^2)$
\end_inset

. Under the assumption that 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 are similar, the final cost function is 
\begin_inset Formula $O(n^4)$
\end_inset

. However, as there are hundreds of distinct types of sites, the dynamic programming matrix is actually very sparse (there is a smaller number of matches), being less prohibitive such a cost.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 20: Waterman et al. Map alignment
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $A,B$: maps;  $
\backslash
lambda,
\backslash
mu 
\backslash
in 
\backslash
mathcal{Z^+}$
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Calculating the element $i,j$ in $D$}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|A|-1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=0$ to $|B|-1$}
\end_layout

\begin_layout Standard


\backslash
IF{site$(a_i)$ = site$(b_j)$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,j) 
\backslash
leftarrow$ ComputeInitialDistance();
\end_layout

\begin_layout Standard

%
\backslash
STATE $x 
\backslash
leftarrow 
\backslash
alpha$ (score$(a_i)$ + score$(b_j)$);
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Searching the best previous element in $D$}
\end_layout

\begin_layout Standard


\backslash
FOR{$i'=0$ to $i-1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j'=0$ to $j-1$}
\end_layout

\begin_layout Standard


\backslash
STATE $y 
\backslash
leftarrow 
\backslash
lambda ((i-i'-1) + (j-j'-1))$;
\end_layout

\begin_layout Standard


\backslash
STATE $z 
\backslash
leftarrow 
\backslash
mu (|($pos$(a_i)$ - pos$(a_{i'}))$ - (pos$(b_j)$ - pos$(b_{j'}))|)$;
\end_layout

\begin_layout Standard


\backslash
STATE currentDist $
\backslash
leftarrow D(i',j') + y + z$;
\end_layout

\begin_layout Standard


\backslash
IF{currentDist $< D(i,j)$}
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,j) 
\backslash
leftarrow$ currentDist;
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:watmap
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "waterman:1984c"

\end_inset

 map alignment algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "waterman:1984c"

\end_inset

 map alignment algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

A direct implementation of the recursion above involves the recursive filling of the cells 
\begin_inset Formula $D(i,j)$
\end_inset

 in the matrix 
\begin_inset Formula $D$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after ""
before ""
key "waterman:1984a"

\end_inset

. In the pseudocode below, the elements of the maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are represented as structures 
\begin_inset Formula $a_i$
\end_inset

 and 
\begin_inset Formula $b_j$
\end_inset

, with the functions 
\emph on
site
\emph default
 and 
\emph on
pos
\emph default
 returning the values of the corresponding fields. The variable 
\emph on
currentDist
\emph default
 stores the minimum distance so far computed.
\end_layout

\begin_layout Standard

The resulting map alignment can be easily retrieved using a supplementary structure 
\emph on
path(i,j)
\emph default
 which points to the previous cell in the optimal path leading to cell 
\begin_inset Formula $D(i,j)$
\end_inset

 In addition, for each cell 
\begin_inset Formula $D(i,j)$
\end_inset

, the function 
\emph on
ComputeInitialDistance
\emph default
 calculates the initial score of a hypothetical alignment that includes only 
\begin_inset Formula $a_i$
\end_inset

 and 
\begin_inset Formula $b_j$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsectionblue{
\end_layout

\end_inset

The Myers and Huang map alignment algorithm (1992)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

algorithms!mmap@Myers and Huang
\end_layout

\end_inset

 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout

map alignment!mmapaln@Myers and Huang
\end_layout

\end_inset

 The formulation of the problem by 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "waterman:1984a"

\end_inset

 for aligning two maps 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 of 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 sites respectively, leads directly to a 
\begin_inset Formula $O(m^2n^2)$
\end_inset

 algorithm. 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

 presented an algorithm for comparing restriction maps based on some works related to sequence comparison algorithms in the cases where gap costs are concave (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:concave"

\end_inset

). Because of the distance between two maps relies not only on the number of gaps in the lists of sites but also on the physical distances between sites, multiple indels or gaps can be treated as a unit.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 21: de la matriz normal a la de posiciones
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
fbox{
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.7
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/dp4
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:huangproc
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Mapping the 
\begin_inset Formula $D$
\end_inset

 matrix over a grid
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Mapping the 
\begin_inset Formula $D$
\end_inset

 matrix over the rectangle 
\begin_inset Formula $[0,m_M] \times [0,p_P]$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Basically, the 
\begin_inset Formula $O(n^4)$
\end_inset

 cost of the original algorithm can be decomposed into two 
\begin_inset Formula $O(n^2)$
\end_inset

 components:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{menumerate}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The worst-case number of possible matches between 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

. 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
item 
\end_layout

\end_inset

The cost of retrieving the best previous match that minimizes the distance of the alignment ending at the current match. 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{menumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

While the cost of the first component is unavoidable, the second contribution can be reduced in many ways, specially in the cases in which the dynamic programming matrix is very sparse. In 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

, such a cost is dramatically reduced to a logarithmic function through the application of several analytical methods. First of all, the formulation of the score (distance) of a map alignment is rewritten again: the elements that do not depend of the current match 
\begin_inset Formula $(a_i,b_j)$
\end_inset

 are now isolated to be computed only once. Second, the dynamic programming matrix that is addressed with the sites in 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 is substituted by a grid of points that correspond to the physical positions of the elements from both maps. Finally, a list of candidates (previous matches) that induces a partition in the set of sites from the second map is updated when the matrix is filled in, at the same time the sites in the first map are being processed.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Formulation and cost
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $M = \{M_1,M_2,\ldots M_M\} = \{(a_1,m_1),(a_2,m_2)\ldots(a_M,m_M)\}$
\end_inset

 be a map of sites where each pair 
\begin_inset Formula $(a_i,m_i)$
\end_inset

 represents the restriction site 
\begin_inset Formula $a_i$
\end_inset

 occurring at position 
\begin_inset Formula $m_i$
\end_inset

 of a sequence of nucleotides, and let 
\begin_inset Formula $P = \{P_1,P_2,\ldots P_P\} = \{(b_1,p_1),(b_2,p_2)\ldots(b_P,p_P)\}$
\end_inset

 be a shorter map of sites (a probe) where each pair 
\begin_inset Formula $(b_j,p_j)$
\end_inset

 represents the restriction site 
\begin_inset Formula $b_j$
\end_inset

 occurring at position 
\begin_inset Formula $p_j$
\end_inset

 of a sequence of nucleotides. Then, the score of an alignment 
\begin_inset Formula $C=(M_{i_1},P_{j_1})(M_{i_2},P_{j_2})\ldots(M_{i_L},P_{j_L})$
\end_inset

 between the map 
\begin_inset Formula $M$
\end_inset

 and the probe 
\begin_inset Formula $P$
\end_inset

 is defined to be:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{c}
\end_layout

\begin_layout Standard

Score(C) = 
\backslash
lambda (P-L) + 
\backslash
mu 
\backslash
sum_{k=2}^{L}{(|(m_{i_k}-m_{i_{k-1}}) - (p_{j_k}-p_{j_{k-1}})|)}.
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
label{eq:myscore}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

That is, the distance between the map and the probe according to such an alignment increases with the number of elements of 
\begin_inset Formula $P$
\end_inset

 not in the alignment (
\begin_inset Formula $\lambda$
\end_inset

), and with the difference in the distance between matches of consecutive aligned elements (
\begin_inset Formula $\mu$
\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 22: mI,pJ contra mi,x
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/iprofile
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/mI
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

A 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

B
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:iprofile
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An illustration of a 
\begin_inset Formula $f$
\end_inset

-curve
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Analytical methods in 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

(A) An illustration of 
\begin_inset Formula $f_{I,J}^i(x)$
\end_inset

 and 
\begin_inset Formula $f_{I,J}^{i+1}(x)$
\end_inset

. (B) The contribution of a 
\begin_inset Formula $(I,J)$
\end_inset

 to each match point 
\begin_inset Formula $(m_i,x)$
\end_inset

 in the interval 
\begin_inset Formula $(p_J,p_P]$
\end_inset

 of 
\begin_inset Formula $P$
\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

Let Matchpoints be the matches between the map and the probe 
\begin_inset Formula $\{(i,j)|a_i = b_j\}$
\end_inset

. Then, to compute the minimum distance between a map and a probe, the Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:map"

\end_inset

 is rewritten by 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "myers:1992a"

\end_inset

 in terms of the contribution of a previous match to the current one:
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
noindent
\backslash
negr{if ($f_i$ = $g_j$) then}
\backslash

\backslash
[1ex]
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
vspace{-0.75cm}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{lll}
\end_layout

\begin_layout Standard

D(i,j) = & min (
\backslash
lambda (P-1), & min_{I,J} 
\backslash
mbox{contrib}_{I,J}(i,j)).
\backslash

\backslash

\end_layout

\begin_layout Standard

& & 
\backslash
scalebox{0.7}{
\backslash
mbox{$(I,J) 
\backslash
in$ Matchpoints}} 
\backslash

\backslash

\end_layout

\begin_layout Standard

& & 
\backslash
scalebox{0.7}{
\backslash
mbox{$I < i, J < j$}} 
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
noindent 
\backslash
negr{otherwise}
\backslash

\backslash

\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%~~~~~~~~S_{ij} = -
\backslash
infty.
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard

Such a contribution of a previous match 
\begin_inset Formula $(I,J)$
\end_inset

 to the current one 
\begin_inset Formula $(i,j)$
\end_inset

 is defined as:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{c}
\end_layout

\begin_layout Standard


\backslash
mbox{contrib}_{I,J} (i,j) = D(I,J) + 
\backslash
lambda(i-I-2) + 
\backslash
mu (|(m_i - m_I) - (p_j - p_J)|).
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

Instead of dealing with the classical dynamic programming matrix that is usually accessed using the sites in the maps, 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

 proposed to map the original problem into a matrix representing the domain of physical positions. Thus, the procedure that completes the original matrix column by column is exported to this new grid whose dimensions are the position of the last site in both maps respectively (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:huangproc"

\end_inset

).
\end_layout

\begin_layout Standard

This algorithm computes each column of the matrix 
\begin_inset Formula $D$
\end_inset

 in increasing order of 
\begin_inset Formula $i$
\end_inset

 (
\begin_inset Formula $M$
\end_inset

), simultaneously updating a list of match points called candidates. Each one of these previous matches 
\begin_inset Formula $(I,J)$
\end_inset

 are actually associated to a given partition of the probe 
\begin_inset Formula $P$
\end_inset

, constituting the best previous match for the current point 
\begin_inset Formula $D(m_i,p_j)$
\end_inset

 in this column 
\begin_inset Formula $m_i$
\end_inset

 and row 
\begin_inset Formula $p_j$
\end_inset

. The step of scanning back the matrix to retrieve the best previous match is then substituted with a list that returns the best element in a logarithmic time. Several additional definitions must be provided to manage the candidate list. These concepts are all of them based on an analytical description of the computation of the matrix 
\begin_inset Formula $D$
\end_inset

.
\end_layout

\begin_layout Standard

The contribution 
\begin_inset Formula $f$
\end_inset

 of a match point 
\begin_inset Formula $(m_I,p_J)$
\end_inset

 to future points in a given column 
\begin_inset Formula $m_i$
\end_inset

 (
\begin_inset Formula $I<i$
\end_inset

) on the interval 
\begin_inset Formula $x \in (p_J,p_P]$
\end_inset

 can be divided into the components associated to 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

. At the same time, each one can be split into the values that depend on the current 
\begin_inset Formula $m_i$
\end_inset

 and those that were already computed when the match point 
\begin_inset Formula $(m_I,p_J)$
\end_inset

 was reached:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

f_{I,J}^i (x) = 
\backslash
mu |C_{I,J}^i (x)| + B_{I,J}^i & 
\backslash
mbox{where}
\backslash

\backslash

\end_layout

\begin_layout Standard

C_{I,J}^i = m_i + 
\backslash
Delta_{I,J}, & 
\backslash
Delta_{I,J} = p_J - m_i
\backslash

\backslash

\end_layout

\begin_layout Standard

B_{I,J}^i = 
\backslash
lambda i + E_{I,J}, & E_{I,J} = D(I,J) - 
\backslash
lambda (I+2).
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

It is direct to see that 
\begin_inset Formula $\mbox{contrib}_{I,J} (i,j) = f_{I,J}^i(p_j)$
\end_inset

, as the terms in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:myscore"

\end_inset

 have been simply rearranged. For the 
\begin_inset Formula $\mu$
\end_inset

 factor, 
\begin_inset Formula $(m_i - m_I) - (p_j - p_J) = m_i + (p_J - m_I) - x = m_i + \Delta_{I,J} - x$
\end_inset

. For the 
\begin_inset Formula $\lambda$
\end_inset

 factor, 
\begin_inset Formula $D(I,J) + \lambda(i-I-2) = D(I,J) - \lambda(I+2) + \lambda i = \lambda i + E_{I,J}$
\end_inset

. In this case, the values 
\begin_inset Formula $\Delta_{I,J}$
\end_inset

 and 
\begin_inset Formula $E_{I,J}$
\end_inset

 do not depend on 
\begin_inset Formula $i$
\end_inset

, being already precomputed.
\end_layout

\begin_layout Standard

The new contribution of a match point 
\begin_inset Formula $(m_I,p_J)$
\end_inset

 to the next position (column 
\begin_inset Formula $m_{i+1}$
\end_inset

) is easily computed from its contribution to the previous one:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{c}
\end_layout

\begin_layout Standard

f_{I,J}^{i+1} (x) = f_{I,J}^i (x - 
\backslash
Delta m_i) + 
\backslash
lambda
\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

The updating consists of two changes: (1) a unit of 
\begin_inset Formula $\lambda$
\end_inset

 is increased because a new site has not been included in the alignment (
\begin_inset Formula $m_i$
\end_inset

); (2) the physical position of the match point 
\begin_inset Formula $(m_{i+1},x)$
\end_inset

 must be updated in the computation of the 
\begin_inset Formula $\mu$
\end_inset

 factor by decreasing 
\begin_inset Formula $x$
\end_inset

 with 
\begin_inset Formula $\Delta m_i$
\end_inset

 to recover the new value of the 
\begin_inset Formula $\mu$
\end_inset

 penalty.
\end_layout

\begin_layout Standard

As shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:iprofile"

\end_inset

 (A), a given function 
\begin_inset Formula $f_{I,J}^i$
\end_inset

 can be represented graphically. The minimum value that can be reached is 
\begin_inset Formula $B_{I,J}^i$
\end_inset

 corresponding to the point 
\begin_inset Formula $x = C_{I,J}^i$
\end_inset

. For the rest of 
\begin_inset Formula $x$
\end_inset

 values, the 
\begin_inset Formula $\lambda$
\end_inset

 penalty and 
\begin_inset Formula $D(I,J)$
\end_inset

 are the same so that changes depend directly from the 
\begin_inset Formula $\mu$
\end_inset

 penalty. This value will decrease as long as 
\begin_inset Formula $x$
\end_inset

 approaches the 
\begin_inset Formula $m_I - m_i$
\end_inset

 vertical until 
\begin_inset Formula $C_{I,J}^i$
\end_inset

. From that point, it will increase again due to the progressive movement away such point (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:iprofile"

\end_inset

 (B)). The contribution in the next column can also be represented as a similar function with the corresponding new values of 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $f(x)$
\end_inset

.
\end_layout

\begin_layout Standard

Let 
\begin_inset Formula $m_i$
\end_inset

 be the current column: each previous match point 
\begin_inset Formula $(m_I,p_J)$
\end_inset

 has a different contribution to each one of the new match points 
\begin_inset Formula $(m_i,x)$
\end_inset

 found in this column. For a given 
\begin_inset Formula $x$
\end_inset

, the best contribution of the previous match points in the alignment ending at such point is the minimum value among the 
\begin_inset Formula $f_{I,J}^i(x)$
\end_inset

 functions. In addition, the optimal value 
\begin_inset Formula $D(i,j)$
\end_inset

 is either the distance of an alignment containing only this match point or the alignment with the previous match point that showed the highest contribution for 
\begin_inset Formula $(m_i,x)$
\end_inset

:
\end_layout

\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{equation}
\end_layout

\begin_layout Standard


\backslash
begin{array}{ll}
\end_layout

\begin_layout Standard

P^i (x) =& min_{I,J} f_{I,J}^i (x)
\backslash

\backslash

\end_layout

\begin_layout Standard

& 
\backslash
scalebox{0.7}{
\backslash
mbox{$(I,J) 
\backslash
in$ Matchpoints}} 
\backslash

\backslash

\end_layout

\begin_layout Standard

& 
\backslash
scalebox{0.7}{
\backslash
mbox{$I < i, J < j$}} 
\backslash

\backslash
[1ex]
\end_layout

\begin_layout Standard

D(i,j) =& min (
\backslash
lambda(P-1),P^i(p_j)). 
\backslash

\backslash

\end_layout

\begin_layout Standard


\backslash
end{array}
\end_layout

\begin_layout Standard


\backslash
end{equation}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard

An 
\begin_inset Formula $i$
\end_inset

-profile is then defined to be the intersection between the contributions of all of the available match points computed before. For each interval between two consecutive points in 
\begin_inset Formula $P$
\end_inset

, the 
\begin_inset Formula $f$
\end_inset

 function with the lowest value over there is claimed to be the owner of such interval. The calculation of the value 
\begin_inset Formula $P^i(x)$
\end_inset

 consists on locating the representative of an interval to know its contribution. In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:iprofiletwo"

\end_inset

, the 
\begin_inset Formula $i$
\end_inset

-profile represented as the minimum envelope of the 
\begin_inset Formula $f$
\end_inset

-curves of all match points left to the column 
\begin_inset Formula $m_i$
\end_inset

 is graphically shown.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 23: mI,pJ contra mi,x
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.6
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/iprofiletwo
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:iprofiletwo
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An illustration of an 
\begin_inset Formula $i$
\end_inset

-profile
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An illustration of an 
\begin_inset Formula $i$
\end_inset

-profile.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

For simplicity, the list of candidates that form an 
\begin_inset Formula $i$
\end_inset

-profile is decomposed into two different lists 
\begin_inset Formula $L$
\end_inset

 and 
\begin_inset Formula $R$
\end_inset

 which correspond to the parts of the 
\begin_inset Formula $f$
\end_inset

-curves that are before and after the point 
\begin_inset Formula $C_{I,J}^i$
\end_inset

. For each one, insertions and updates to the list of candidates must be performed in a slightly different form (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:LR"

\end_inset

).
\end_layout

\begin_layout Standard

In the case of the 
\begin_inset Formula $R$
\end_inset

-list, their members are always increasing straight lines. For that reason, whenever one of the candidates has another candidate below, this first element is said to be dominated by the second one. When this candidate is dominated in all of the intervals over 
\begin_inset Formula $P$
\end_inset

, it becomes dead and it is removed from the list. In the case of the 
\begin_inset Formula $L$
\end_inset

-list, the processing must take into account the stationarity of the left ends of the curves when shifting horizontally.
\end_layout

\begin_layout Standard

For both lists the management is similar: each match point that has just been computed must be inserted into the 
\begin_inset Formula $L$
\end_inset

-list and the 
\begin_inset Formula $R$
\end_inset

-list. This insertion can cause the removal of the match points that become dominated by this new element. Similarly, once a column 
\begin_inset Formula $m_i$
\end_inset

 has been processed, the elements of the lists must be processed to be ready for the next column 
\begin_inset Formula $m_{i+1}$
\end_inset

, involving the recomputation of their values using 
\begin_inset Formula $\Delta m_i$
\end_inset

. Again, this operation can force some match points to be removed from the list because they can not contribute positively to any of the future ones.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 24: L and R lists
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
setlength{
\backslash
fboxsep}{0pt}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fbox{
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="1" columns="2">
<features tabularvalignment="middle" tabularwidth="0pt">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/Llist
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
incgraph{
\end_layout

\end_inset

width=0.4
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
linewidth
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset

ps/Rlist
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:LR
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An illustration of a 
\begin_inset Formula $R$
\end_inset

-profile and a 
\begin_inset Formula $L$
\end_inset

-profile
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

An illustration of a 
\begin_inset Formula $R$
\end_inset

-profile and a 
\begin_inset Formula $L$
\end_inset

-profile.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset

Adapted from 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

These type of sorted lists that must provide a direct access to a given element (e.g. the owner of an interval) can be implemented using balanced trees. These trees support logarithmic insertion, deletion and search primitives. Let 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $P$
\end_inset

 the length of the map and the probe respectively, there are 
\begin_inset Formula $R=MP$
\end_inset

 potential match points. For each one, the owner of its interval can be retrieved in a logarithmic time 
\begin_inset Formula $O(\log(P))$
\end_inset

. The insertion in the list and the shifting operation are also performed with a logarithmic cost taking into account some particular considerations. Thus, the final cost of this algorithm is 
\begin_inset Formula $O(R\log(P))$
\end_inset

 (for further details see 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

).
\end_layout

\begin_layout Standard

Such an algorithm was designed primarily for comparisons between a map and a probe. However, 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "myers:1992a"

\end_inset

 also presented some changes to convert the problem in a comparison between two maps of length 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

 respectively in 
\begin_inset Formula $O(MN(logM+logN))$
\end_inset

 time.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
subsubsectionblue{
\end_layout

\end_inset

Implementation
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The main algorithm of the 
\begin_inset CommandInset citation
LatexCommand citet
after ""
before ""
key "myers:1992a"

\end_inset

 strategy consists of a loop that visits column by column the 
\begin_inset Formula $m_M \times p_P$
\end_inset

 matrix. For each site in 
\begin_inset Formula $m$
\end_inset

, there is a function Match
\begin_inset Formula $($
\end_inset

site
\begin_inset Formula $(a_i))$
\end_inset

, precomputed only once at the beginning, which returns the sites 
\begin_inset Formula $x$
\end_inset

 in 
\begin_inset Formula $P$
\end_inset

 that share the same restriction enzyme.
\end_layout

\begin_layout Standard

Then, the optimal alignment ending at every new match point 
\begin_inset Formula $(m_i,x)$
\end_inset

 is constructed between either an alignment only constituted by this match or the contribution of the owner of its interval, which is directly identified with the function Find_min by accessing the list of candidates implemented as two balanced trees (the 
\begin_inset Formula $L$
\end_inset

-list and 
\begin_inset Formula $R$
\end_inset

-list).
\end_layout

\begin_layout Standard

The new match points that have been processed in the current column are then inserted in the corresponding lists with the function Insert, removing from the lists those candidates that are categorized as dead.
\end_layout

\begin_layout Standard

Once the current column has been completely processed, both lists of candidates must be updated with the function Update to be prepared for the next element 
\begin_inset Formula $m_{i+1}$
\end_inset

, taking into account the value of 
\begin_inset Formula $\Delta m_i$
\end_inset

.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% Figure 25: Myers-Huang map alignment
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset Float figure
placement t!
wide false
sideways false
status open


\begin_layout Standard
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
scalebox{1}{
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
fcolorbox{white}{verylightgreen}{
\end_layout

\begin_layout Standard


\backslash
begin{minipage}[][][c]{0.95
\backslash
linewidth}
\end_layout

\begin_layout Standard


\backslash
begin{algorithmic}[5]
\end_layout

\begin_layout Standard


\backslash
REQUIRE $M,P$: maps;  $
\backslash
lambda,
\backslash
mu 
\backslash
in 
\backslash
mathcal{Z^+}$
\end_layout

\begin_layout Standard


\backslash
STATE Initialize
\backslash
_candidate
\backslash
_list();
\end_layout

\begin_layout Standard


\backslash
STATE 
\backslash
COMMENT{Current column $m_i$}
\end_layout

\begin_layout Standard


\backslash
FOR{$i=0$ to $|M_m|-1$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j=0 
\backslash
in$ Match(site$(m_i)$)}
\end_layout

\begin_layout Standard


\backslash
STATE $D(i,j) 
\backslash
leftarrow min(
\backslash
lambda(P-1),
\backslash
mbox{Find
\backslash
_min($i,j$)})$;
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
IF{$i<M$}
\end_layout

\begin_layout Standard


\backslash
FOR{$j 
\backslash
in$ Match(site$(a_i)$) and $j<P$}
\end_layout

\begin_layout Standard


\backslash
STATE Insert($i,j$);
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
STATE Update($i$);
\end_layout

\begin_layout Standard


\backslash
ENDIF
\end_layout

\begin_layout Standard


\backslash
ENDFOR
\end_layout

\begin_layout Standard


\backslash
end{algorithmic}
\end_layout

\begin_layout Standard


\backslash
end{minipage}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
mycaption{
\end_layout

\end_inset

fig:myersmap
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% label
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "myers:1992a"

\end_inset

 map alignment algorithm
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% lof
\end_layout

\begin_layout Standard


\end_layout

\end_inset

The 
\begin_inset CommandInset citation
LatexCommand citeauthor
after ""
before ""
key "myers:1992a"

\end_inset

 map alignment algorithm.
\begin_inset ERT
status collapsed

\begin_layout Standard

}{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

% caption header
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% References for this chapter
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%%% ENCERRAR ENTRE LLAVES PARA EVITAR PROBLEMAS
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
bibliographystyle{plainnat}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "sections/bibliography"

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
